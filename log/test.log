** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mComponentGallery Columns (1.4ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Assigning #<File:test/resources/images/rails.png> to photo
[paperclip] Writing attributes for photo
[paperclip] Post-processing photo
  [4;35;1mComponentGallery Create (0.4ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:31:48', NULL, NULL, NULL, '2011-04-22 17:31:48', 1, 0, NULL, 1, 'ComponentGallery', NULL, 1, NULL, 1, NULL, 2, 1)[0m
  [4;36;1mPicture Create (0.3ms)[0m   [0;1mINSERT INTO `pictures` (`created_at`, `photo_file_size`, `title`, `updated_at`, `photo_file_name`, `photo_content_type`, `description`, `component_id`, `component_type`) VALUES('2011-04-22 17:31:48', 6646, NULL, '2011-04-22 17:31:48', 'rails.png', 'image/png', NULL, 10, 'Component')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/3/big/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/3/thumb/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/3/original/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/3/normal/rails.png
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mCompanyZ Columns (4.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
  [4;35;1mComponentPicture Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `components`[0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mComponentText Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mLayout Update (0.5ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:31:48', `font_colors` = '0x00000a;0x333333' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:31:48', `description` = ' bruno sqiueira COLOR=\"#000000\" oiasjdosadijoasidjasoij COLOR=\"#333333\" COLOR=\"#00000a\" ' WHERE `id` = 5[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mComponentPicture Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:31:48', `title` = 'ola' WHERE `id` = 7[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mFeedItem Load (0.3ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for picture
[paperclip] Deleting files for picture
[paperclip] Writing files for picture
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mContract Load Including Associations (0.8ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:31:48' and end_date>='2011-04-22 14:31:48') [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUserAdministrator Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompanyS Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:31:48) [POST]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "contract"=>{"parcel"=>12, "initial_date"=>"2008-02-12", "value"=>50.0, "status"=>"Aberto", "end_date"=>"2009-02-12"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:31:48', '2008-02-12', '2011-04-22 17:31:48', 50.0, 4, '2009-02-12', 'Aberto')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/6
Completed in 22ms (DB: 2436) | 302 Found [http://test.host/companies/4-MyString/contracts?contract%5Bend_date%5D=2009-02-12&contract%5Binitial_date%5D=2008-02-12&contract%5Bparcel%5D=12&contract%5Bstatus%5D=Aberto&contract%5Bvalue%5D=50.0]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m


Processing ContractsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:48) [DELETE]
  Parameters: {"id"=>#<Contract id: 4, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;35;1mContract Load (0.1ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.2ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 4[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts
Completed in 12ms (DB: 4) | 302 Found [http://test.host/companies/4-MyString/contracts/4]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#edit (for 0.0.0.0 at 2011-04-22 14:31:48) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/edit
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 75ms (View: 71, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#index (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/index
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mUserCompany Columns (4.1ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (2.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 29ms (View: 19, DB: 9) | 200 OK [http://test.host/companies/4-MyString/contracts]
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#new (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 28ms (View: 26, DB: 2) | 200 OK [http://test.host/companies/4-MyString/contracts/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:31:49) [POST]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "contract"=>{}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 156ms (View: 149, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts?]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#show (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/show
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (titles.status<>'Liquidado')) [0m
Rendered titles/_title (1.0ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.5ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
  [4;35;1mTitle Load (0.6ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (`titles`.`status` = 'Liquidado')) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 30ms (View: 25, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#update (for 0.0.0.0 at 2011-04-22 14:31:49) [PUT]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "contract"=>{}}
  [4;36;1mUser Load (1.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/1
Completed in 11ms (DB: 4) | 302 Found [http://test.host/companies/4-MyString/contracts/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing DomainsController#update (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"id"=>"8", "value"=>"empresa.com.br"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.9ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:49', `domain` = 'empresa.com.br' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 331ms (View: 0, DB: 3) | 200 OK [http://test.host/domains/update/8?value=empresa.com.br]
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (5.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mFeedItem Load (0.3ms)[0m   [0mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mFeedLike Load (0.2ms)[0m   [0mSELECT `feed_likes`.id FROM `feed_likes` WHERE (`feed_likes`.`company_id` = 7 AND `feed_likes`.feed_item_id = 1) LIMIT 1[0m
  [4;36;1mFeedLike Create (0.2ms)[0m   [0;1mINSERT INTO `feed_likes` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:31:49', '2011-04-22 17:31:49', 7, 1)[0m
  [4;35;1mFeedItem Load (0.2ms)[0m   [0mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;36;1mFeedItem Update (0.4ms)[0m   [0;1mUPDATE `feed_items` SET `feed_likes_count` = COALESCE(`feed_likes_count`, 0) + 1 WHERE (`id` = 1) [0m
  [4;35;1mFeedItem Update (0.2ms)[0m   [0mUPDATE `feed_items` SET `updated_at` = '2011-04-22 17:31:49' WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;36;1mFeedItem Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.6ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:31:49' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompanyZ Load Including Associations (0.7ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:31:49' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 36ms (View: 20, DB: 13) | 200 OK [http://test.host/financial/company_no_active_contracts]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"id"=>[]}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:31:49' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.6ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:31:49' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 8, DB: 3) | 200 OK [http://test.host/financial/company_no_active_contracts/index/]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load (0.7ms)[0m   [0mSELECT distinct companies.* as companies FROM `companies` join titles as titles on titles.company_id = companies.id WHERE (titles.status <> 'Liquidado' and titles.due_date < '2011-04-22 14:31:49' and your_number is not null) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/index
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 118ms (View: 12, DB: 4) | 200 OK [http://test.host/financial/company_not_payed]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Financial::CompanyNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT `contracts`.* FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/show
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (2.2ms)
Rendered companies/_company_show (9.6ms)
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:31:23' and our_number is not null)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 26ms (View: 19, DB: 5) | 200 OK [http://test.host/financial/company_not_payed/show/7-MyString]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"month"=>"4"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mContract Load Including Associations (0.9ms)[0m   [0;1mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:31:49' and end_date>='2011-04-22 14:31:49') [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-05-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;35;1mTitle Create (0.3ms)[0m   [0mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:31:49', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:31:49', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-05-22 00:00:00', 0.2, '2011-04-22 14:31:49', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 8, DB: 4) | 200 OK [http://test.host/financial/main/generate_new_titles?month=4]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:31:49) [GET]
  Parameters: {"month"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mContract Load Including Associations (0.6ms)[0m   [0;1mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-03-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:31:49' and end_date>='2011-04-22 14:31:49') [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-04-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;35;1mTitle Create (0.4ms)[0m   [0mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:31:49', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:31:49', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-04-22 00:00:00', 0.2, '2011-04-22 14:31:49', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 7, DB: 6) | 200 OK [http://test.host/financial/main/generate_new_titles?month=3]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;35;1mSQL (2.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:31:49) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COB01.TXT>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33336' AND `titles`.`due_date` = '2009-05-13') LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33333' AND `titles`.`due_date` = '2009-05-15') LIMIT 1[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33335' AND `titles`.`due_date` = '2009-05-02') LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33310' AND `titles`.`due_date` = '2009-05-07') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33337' AND `titles`.`due_date` = '2009-05-08') LIMIT 1[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '827495320r' AND `titles`.`due_date` = '2009-03-20') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 39ms (View: 9, DB: 6) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x106511bc8%3E]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:31:50) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COBERROR.TXT>}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 10ms (View: 7, DB: 1) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x1064742b0%3E]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#new (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/financial/receive_return/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::SendShippingController#index (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.4ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`status` = 'Aberto') [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/index
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 2)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 13, DB: 3) | 200 OK [http://test.host/financial/send_shipping]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.1ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#create (for 0.0.0.0 at 2011-04-22 14:31:50) [PUT]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`processing_date` = '2011-04-22 14:31:50' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mShipping Update (0.3ms)[0m   [0mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:31:50', `processing_date` = '2011-04-22 14:31:50' WHERE `id` = 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mUserDirector Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUserDirector Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
  [4;36;1mUserWebAdministrator Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUserAdministrator Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
Sent mail to quentin@example.com, quentin@example.com

Date: Fri, 22 Apr 2011 14:31:50 -0300
From: bsiqueira@suaempreza.com.br
To: quentin@example.com,
	 quentin@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D=3A_Gera=C3=A7=C3=A3o_de_Cobran=C3=A7a?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1>Envio de Remessa</h1>
<p>
  C√≥digo da Remessa: MyString
</p>

<p>
  Quantidade de T√≠tulos: 2
</p>

<p>
  Valor da Remessa: 3,00
</p>

<p>
  Voc√™ pode realizar o download do arquivo remessa no endere√ßo:<br>
  <a href="http://localhost:3000/financial/shippings/1">http://localhost:3000/financial/shippings/1</a>
</p>
<small>
  O envio da remessa para o banco deve ser realizado ainda na data corrente.
</small>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
  [4;36;1mTitle Update (0.5ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Enviado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Enviado' WHERE `id` = 3[0m
  [4;36;1mShipping Update (0.4ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:31:50', `file_name` = 'MyString_2204111431.txt', `file_content_type` = 'text/plain', `file_data` = x'303152454d455353413031434f4252414e434120202020202020303033343330353733393639342020202020202043c3a96c756c61204950202020202020202020202020202020202020202033353642616e636f205265616c20202020203232303431313031363030425049202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030310a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030382020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030320a383130303334333035373339363934323175303030382020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030330a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030372020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030340a383130303334333035373339363934323175303030372020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030350a393030303030323030303030303030303033303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030360a' WHERE `id` = 1[0m
  [4;35;1mShipping Update (0.3ms)[0m   [0mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Enviado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 160ms (View: 9, DB: 13) | 200 OK [http://test.host/financial/send_shipping/create/1]
  [4;36;1mTitle Load (0.6ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#show (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 9, DB: 5) | 200 OK [http://test.host/financial/send_shipping/show/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mShipping Load (0.1ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.3ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:31:50', '2011-04-22 17:31:50', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.1ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.1ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:31:50', '2011-04-22 17:31:50', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mShippingTitle Load (0.1ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.`id` = 964567532) [0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.1ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mTitle Update (0.2ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Digitado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567532[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m


Processing Financial::ShippingsController#create (for 0.0.0.0 at 2011-04-22 14:31:50) [POST]
  Parameters: {"shipping"=>{}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.4ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` IS NULL) LIMIT 1[0m
  [4;35;1mShipping Create (0.4ms)[0m   [0mINSERT INTO `shippings` (`created_at`, `code`, `updated_at`, `file_content_type`, `file_data`, `file_name`, `processing_date`, `status`) VALUES('2011-04-22 17:31:50', NULL, '2011-04-22 17:31:50', NULL, NULL, NULL, NULL, 'Aberto')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/4
Completed in 10ms (DB: 13) | 302 Found [http://test.host/financial/remessas?]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (3.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mShipping Load (0.4ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:50) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.4ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE (our_number is not null) AND ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mShipping Destroy (0.3ms)[0m   [0mDELETE FROM `shippings` WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas
Completed in 14ms (DB: 9) | 302 Found [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#edit (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/edit
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
Rendered titles/_titles (9.3ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 16, DB: 6) | 200 OK [http://test.host/financial/remessas/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#index (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.1ms)[0m   [0mSELECT * FROM `shippings` [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/index
Rendered financial/shippings/_download (0.3ms)
Rendered financial/shippings/_download (0.1ms)
Rendered financial/shippings/_download (1.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 16ms (View: 14, DB: 1) | 200 OK [http://test.host/financial/remessas]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#new (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/shippings/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 10, DB: 2) | 200 OK [http://test.host/financial/remessas/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#show (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/show
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendered financial/shippings/_download (0.1ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((titles.status<>'Liquidado'))) [0m
Rendered titles/_title (0.5ms)
Rendered titles/_title (0.4ms)
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((`titles`.`status` = 'Liquidado'))) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 15, DB: 4) | 200 OK [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#update (for 0.0.0.0 at 2011-04-22 14:31:50) [PUT]
  Parameters: {"id"=>"1", "shipping"=>{}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/1
  [4;36;1mShippingTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.4ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:50', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.1ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 120ms (DB: 4) | 302 Found [http://test.host/financial/remessas/1?]
  [4;35;1mSQL (2.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:31:50) [POST]
  Parameters: {"title"=>{"your_number"=>"SZ20002", "discount_type"=>"Sem desconto", "value"=>450.0, "due_date"=>"2009-05-05", "emission_date"=>"2009-05-01", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'SZ20002') LIMIT 1[0m
  [4;36;1mTitle Create (0.4ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(NULL, '2011-04-22 17:31:50', 'SZ20002', NULL, NULL, NULL, '2011-04-22 17:31:50', 'Sem desconto', NULL, NULL, NULL, 450.0, NULL, 5, '2009-05-05', NULL, '2009-05-01', NULL, NULL, NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/13
Completed in 17ms (DB: 6) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bvalue%5D=450.0&title%5Byour_number%5D=SZ20002]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:31:50) [POST]
  Parameters: {"title"=>{"fine_percent"=>"33,33", "your_number"=>"AZ924330", "abatement_value"=>"", "interest_type"=>"0", "discount_type"=>"Sem desconto", "value"=>"323,33", "due_date"=>"2009-05-05", "interest_percent"=>"0,50", "emission_date"=>"2009-05-01", "discount_value"=>"", "additional_data"=>"cdcscscsscdssd", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'AZ924330') LIMIT 1[0m
  [4;36;1mTitle Create (0.4ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(33.33, '2011-04-22 17:31:50', 'AZ924330', NULL, NULL, 0.0, '2011-04-22 17:31:50', 'Sem desconto', '0', NULL, NULL, 323.33, NULL, 5, '2009-05-05', 0.5, '2009-05-01', 0.0, 'cdcscscsscdssd', NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/14
Completed in 15ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Babatement_value%5D=&title%5Badditional_data%5D=cdcscscsscdssd&title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdiscount_value%5D=&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bfine_percent%5D=33%2C33&title%5Binterest_percent%5D=0%2C50&title%5Binterest_type%5D=0&title%5Bvalue%5D=323%2C33&title%5Byour_number%5D=AZ924330]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 14) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#destroy (for 0.0.0.0 at 2011-04-22 14:31:50) [DELETE]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles
Completed in 7ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#edit (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/edit
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 41ms (View: 36, DB: 4) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#index (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` ORDER BY due_date desc LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 41ms (View: 37, DB: 2) | 200 OK [http://test.host/financial/companies/5-MyString/titles]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::TitlesController#index_new (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering financial/titles/index_new
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 13, DB: 4) | 200 OK [http://test.host/financial/titles/index_new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#new (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/new
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 147ms (View: 143, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles/new]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#show (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 11, DB: 4) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#update (for 0.0.0.0 at 2011-04-22 14:31:50) [PUT]
  Parameters: {"title"=>{}, "id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-02-15' AND `titles`.your_number = '21u0005' AND `titles`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/1
Completed in 9ms (DB: 3) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1?]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) ORDER BY created_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering financial/titles_not_payed/index
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 29ms (View: 19, DB: 3) | 200 OK [http://test.host/titulos-nao-pagos?company_id=5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:31:50) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
Rendering financial/titles_not_payed/show
Completed in 21ms (View: 12, DB: 3) | 200 OK [http://test.host/financial/titles_not_payed/show/1?company_id=5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.2ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:31:51', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (2.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1 AND (components.id is not null)) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 3ms (DB: 7) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
Redirected to http://test.host/empresa-inicio
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 1ms (DB: 1) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
Rendering template within layouts/main
Rendering main/index
  [4;36;1mLayout Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `layouts`.id FROM `layouts` LEFT OUTER JOIN `companies` ON `companies`.id = `layouts`.company_id WHERE (companies.type = 'CompanyZ' and companies.id in (176,173,207,213,206,47,178,28,182)) ORDER BY layouts.updated_at LIMIT 8[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (1.2ms)
Completed in 18ms (View: 13, DB: 1) | 200 OK [http://test.host/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 3ms (DB: 2) | 302 Found [http://test.host/main/natal]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
Rendering template within layouts/main
Rendering main/natal
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.8ms)
Completed in 7ms (View: 6, DB: 1) | 200 OK [http://test.host/main/natal]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.1ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.1ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m


Processing MessagesController#create (for 0.0.0.0 at 2011-04-22 14:31:51) [POST]
  Parameters: {"message"=>{"sender_email"=>"tester@gmail.com", "body"=>"Corpo da mensagem", "subject"=>"Teste - Mensagem enviada do business card", "to"=>"8"}}
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;35;1mMessage Create (0.3ms)[0m   [0mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES('tester@gmail.com', '2011-04-22 17:31:51', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:31:51', 'Teste - Mensagem enviada do business card', NULL, NULL, NULL)[0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 5) [0m
  [4;36;1mMessageCopy Create (0.2ms)[0m   [0;1mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:31:51', NULL, 8, NULL, NULL, 5)[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;4\n', '2011-04-22 17:31:51', 0, '2011-04-22 17:31:51', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:31:51', 0, '2011-04-22 17:31:51', 0, 0, 5, 'Message')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:31:51', '2011-04-22 17:31:51', 5, 2)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 30ms (View: 0, DB: 11) | 200 OK [http://test.host/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender_email%5D=tester%40gmail.com&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+business+card&message%5Bto%5D=8]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m


Processing PasswordsController#new (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
Rendering template within layouts/e-mail
Rendering passwords/new
Completed in 7ms (View: 2, DB: 2) | 200 OK [http://test.host/esqueci-a-senha]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (18.9ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load Including Associations (0.4ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (6.1ms)
Rendered companies/_company (12.2ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 60ms (View: 45, DB: 7) | 200 OK [http://test.host/people_confirm/edit/9]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"13"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (15.3ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 29ms (View: 25, DB: 3) | 200 OK [http://test.host/people_confirm/edit/13]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"7"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:51', `user_create_id` = 6, `user_web_adm_id` = 6 WHERE `id` = 7[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
Sent mail to emp@emp.com

Date: Fri, 22 Apr 2011 14:31:51 -0300
From: bsiqueira@suaempreza.com.br
To: emp@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.5ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (6.7ms)
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (7.2ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 57ms (View: 28, DB: 14) | 200 OK [http://test.host/people_confirm/create/7]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 13, DB: 5) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mUserGeneralManager Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (0.8ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 17ms (View: 9, DB: 6) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.9ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 14, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 15ms (View: 10, DB: 3) | 200 OK [http://test.host/people_confirm]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"9"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mUserSegmentManager Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (1.0ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:51', `user_confirm_id` = 4 WHERE `id` = 9[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Sent mail to empconf222@emp.com

Date: Fri, 22 Apr 2011 14:31:51 -0300
From: bsiqueira@suaempreza.com.br
To: empconf222@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa_first_confirm!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.6ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (6.2ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
Completed in 53ms (View: 23, DB: 16) | 200 OK [http://test.host/people_confirm/create/9]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (116.9ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (5.8ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 147ms (View: 136, DB: 10) | 200 OK [http://test.host/people_confirm/create/9]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#destroy (for 0.0.0.0 at 2011-04-22 14:31:51) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.3ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.2ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people_confirm
Completed in 8ms (DB: 3) | 302 Found [http://test.host/people_confirm/destroy/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#show (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"9"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (6.2ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (6.2ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 37ms (View: 25, DB: 13) | 200 OK [http://test.host/people_confirm/show/9]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.1ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 1) [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:31:51) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", enabled: true>, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString", "state"=>#<State id: 1, acronym: "AC", name: "Acre", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46">}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:51', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:31:51', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, 1, 'MyString', 'MyString', NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/19
Completed in 13ms (DB: 3) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate%5D=1&person%5Bsubsidiary_id%5D=1]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:31:51) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:51', 6, '356.726.002-20', '2008-09-09', '2011-04-22 17:31:51', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 6)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/20
Completed in 11ms (DB: 4) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleController#destroy (for 0.0.0.0 at 2011-04-22 14:31:51) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.3ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.2ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.1ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people
Completed in 7ms (DB: 5) | 302 Found [http://test.host/people/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:31:51) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/edit
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (14.7ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Person') [0m
Rendered person_phone/_phones (6.2ms)
Rendered people/_sidebar (0.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 42ms (View: 36, DB: 6) | 200 OK [http://test.host/people/1/edit]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#index (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mSELECT `people`.* FROM `people` as people left join user_people as up on people.id = up.person_id left join users as u on up.user_id = u.id and u.type <>'UserCompany' WHERE (user_confirm_id is not null ) ORDER BY people.name LIMIT 0, 30[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` IN (1,2,4)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people/index
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 11)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 2)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 185ms (View: 171, DB: 12) | 200 OK [http://test.host/people]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#new (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people/new
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.0ms)
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 34ms (View: 28, DB: 5) | 200 OK [http://test.host/people/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#show (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/show
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (5.9ms)
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 13, DB: 3) | 200 OK [http://test.host/people/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#update (for 0.0.0.0 at 2011-04-22 14:31:52) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/1
Completed in 6ms (DB: 2) | 302 Found [http://test.host/people/1?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>""}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Completed in 10ms (View: 3, DB: 2) | 200 OK [http://test.host/person_phone/create/8?phone%5Bnumber%5D=]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>12345678, "ddd"=>17}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Create (0.4ms)[0m   [0mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(12345678, '2011-04-22 17:31:52', '2011-04-22 17:31:52', 17, NULL, NULL, 8, NULL)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered person_phone/_phone (2.3ms)
Completed in 8ms (View: 5, DB: 3) | 200 OK [http://test.host/person_phone/create/8?phone%5Bddd%5D=17&phone%5Bnumber%5D=12345678]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.2ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m


Processing PersonPhoneController#destroy (for 0.0.0.0 at 2011-04-22 14:31:52) [PUT]
  Parameters: {"id"=>"298486374"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.2ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 298486374[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 3ms (View: 1, DB: 4) | 200 OK [http://test.host/person_phone/destroy/298486374]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mPicture Load (0.2ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.4ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:31:52', `title` = 'ola' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [PUT]
  Parameters: {"email"=>"quentin@example.com"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (email='quentin@example.com' and activated_at is null) LIMIT 1[0m
Redirected to http://test.host/login
Completed in 6ms (DB: 6) | 302 Found [http://test.host/resend_activation_mail/create?email=quentin%40example.com]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [PUT]
  Parameters: {"email"=>"gerente_geral@example.com"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (email='gerente_geral@example.com' and activated_at is null) LIMIT 1[0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:31:52 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 5ms (DB: 1) | 302 Found [http://test.host/resend_activation_mail/create?email=gerente_geral%40example.com]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ResendActivationMailController#new (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
Rendering template within layouts/e-mail
Rendering resend_activation_mail/new
Completed in 3ms (View: 3, DB: 0) | 200 OK [http://test.host/resend_activation_mail/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSegment Load (0.1ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 15ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:52', `remember_token_expires_at` = '2011-05-06 17:31:52', `remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 1) | 302 Found [http://test.host/logout]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:52', `remember_token_expires_at` = '2011-05-06 17:31:52', `remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:52', `remember_token_expires_at` = '2011-04-22 17:26:52' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 3) | 302 Found [http://test.host/logout]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470') LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"password"=>"bad password", "login"=>"quentin"}
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
Redirected to http://test.host/
Completed in 3ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin&password=bad+password]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"password"=>"test", "login"=>"empresa"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'empresa' or email = 'empresa') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
Redirected to http://test.host/
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa&password=test]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"password"=>"test", "login"=>"quentin"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"password"=>"test", "login"=>"empresa_valid"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'empresa_valid' or email = 'empresa_valid') LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Redirected to http://test.host/empresa-inicio
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa_valid&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:52', `remember_token_expires_at` = '2011-05-06 17:31:52', `remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#new (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:not_logged_in_required] rendered_or_redirected.
Completed in 2ms (DB: 2) | 302 Found [http://test.host/sessao/new]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"password"=>"test", "login"=>"quentin@example.com"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin@example.com' or email = 'quentin@example.com') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin%40example.com&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 4ms (DB: 1) | 302 Found [http://test.host/logout]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"remember_me"=>"0", "password"=>"test", "login"=>"quentin"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=0]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"remember_me"=>"1", "password"=>"test", "login"=>"quentin"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:52', `remember_token_expires_at` = '2011-05-06 17:31:52', `remember_token` = 'db3961a6793ec80a5399a9765c3a1bf21bca0470' WHERE `id` = 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:52', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 16ms (DB: 4) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=1]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.6ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.1ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", enabled: true>, "state"=>#<State id: 21, acronym: "RS", name: "Rio Grande do Sul", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46">}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 21) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Create (0.3ms)[0m   [0mINSERT INTO `subsidiary_states` (`created_at`, `updated_at`, `subsidiary_id`, `state_id`) VALUES('2011-04-22 17:31:52', '2011-04-22 17:31:52', 1, 21)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 32ms (View: 17, DB: 7) | 200 OK [http://test.host/subsidiaries/change_range/1?state=21]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m


Processing SubsidiariesController#create (for 0.0.0.0 at 2011-04-22 14:31:52) [POST]
  Parameters: {"subsidiary"=>{"title"=>"teste"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'teste') LIMIT 1[0m
  [4;35;1mSubsidiary Create (0.3ms)[0m   [0mINSERT INTO `subsidiaries` (`created_at`, `title`, `updated_at`, `enabled`) VALUES('2011-04-22 17:31:52', 'teste', '2011-04-22 17:31:52', 1)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/5
Completed in 5ms (DB: 3) | 302 Found [http://test.host/filiais?subsidiary%5Btitle%5D=teste]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m


Processing SubsidiariesController#destroy (for 0.0.0.0 at 2011-04-22 14:31:52) [DELETE]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` WHERE (`people`.subsidiary_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Load (0.3ms)[0m   [0mSELECT * FROM `subsidiary_states` WHERE (`subsidiary_states`.subsidiary_id = 3) [0m
  [4;36;1mSubsidiary Destroy (0.3ms)[0m   [0;1mDELETE FROM `subsidiaries` WHERE `id` = 3[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais
Completed in 5ms (DB: 4) | 302 Found [http://test.host/filiais/3]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;35;1mSQL (0.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#edit (for 0.0.0.0 at 2011-04-22 14:31:52) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit
Rendered subsidiaries/_form (2.8ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 130ms (View: 12, DB: 3) | 200 OK [http://test.host/filiais/1/editar]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#index (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/index
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 18, DB: 2) | 200 OK [http://test.host/filiais]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#new (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/new
Rendered subsidiaries/_form (2.3ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 10, DB: 1) | 200 OK [http://test.host/filiais/nova]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", enabled: true>, "state"=>#<State id: 19, acronym: "RJ", name: "Rio de Janeiro", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46">}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mState Load (0.2ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 19) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiaryState Delete all (0.2ms)[0m   [0;1mDELETE FROM `subsidiary_states` WHERE (`subsidiary_states`.`subsidiary_id` = 1 AND `subsidiary_states`.`state_id` = 19) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 14, DB: 5) | 200 OK [http://test.host/subsidiaries/change_range/1?state=19]
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#show (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/show
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 4) | 200 OK [http://test.host/filiais/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#update (for 0.0.0.0 at 2011-04-22 14:31:53) [PUT]
  Parameters: {"subsidiary"=>{"title"=>"123"}, "id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY '123' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSubsidiary Update (0.3ms)[0m   [0;1mUPDATE `subsidiaries` SET `updated_at` = '2011-04-22 17:31:53', `title` = '123' WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/1
Completed in 6ms (DB: 3) | 302 Found [http://test.host/filiais/1?subsidiary%5Btitle%5D=123]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m


Processing TemplateTextsController#create (for 0.0.0.0 at 2011-04-22 14:31:53) [POST]
  Parameters: {"template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Create (0.3ms)[0m   [0;1mINSERT INTO `template_texts` (`created_at`, `title`, `updated_at`, `content`) VALUES('2011-04-22 17:31:53', 'dadsas', '2011-04-22 17:31:53', 'fsdcsd')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190963
Completed in 9ms (DB: 3) | 302 Found [http://test.host/template_texts?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#destroy (for 0.0.0.0 at 2011-04-22 14:31:53) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTemplateText Destroy (0.3ms)[0m   [0mDELETE FROM `template_texts` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts
Completed in 4ms (DB: 3) | 302 Found [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.1ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#edit (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/edit
Rendered template_texts/_form (2.4ms)
Rendered template_texts/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 11, DB: 3) | 200 OK [http://test.host/template_texts/980190962/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#index (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` [0m
Rendering template within layouts/new_admin
Rendering template_texts/index
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 11, DB: 2) | 200 OK [http://test.host/template_texts]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#new (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering template_texts/new
Rendered template_texts/_form (2.2ms)
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/template_texts/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.1ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#show (for 0.0.0.0 at 2011-04-22 14:31:53) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/show
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 2) | 200 OK [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#update (for 0.0.0.0 at 2011-04-22 14:31:53) [PUT]
  Parameters: {"id"=>"980190962", "template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Update (0.3ms)[0m   [0;1mUPDATE `template_texts` SET `content` = 'fsdcsd', `updated_at` = '2011-04-22 17:31:53', `title` = 'dadsas' WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190962
Completed in 5ms (DB: 2) | 302 Found [http://test.host/template_texts/980190962?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 6) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:53', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 11) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1 and people.user_web_adm_id = 6) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 15) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 16) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.5ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUserCompany Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.7ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.7ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5, 7, 8, 12) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUserCompany Load IDs For Limited Eager Loading (0.6ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUserCompany Load Including Associations (0.7ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) AND `users`.id IN (6, 1) ORDER BY login[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:53', `domain` = 'empresa.com' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` WHERE (`people`.user_web_adm_id = 6 AND (not exists (select up.* from user_people as up where people.id = up.person_id))) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('1520a55dfcb168bd2ca426e197f166e376937637', '2011-04-22 17:31:53', NULL, NULL, NULL, '7d52fbf4dfd415ae0ff22f9d4caafd4132ab2655', NULL, '2011-04-22 17:31:53', NULL, 'e3237ac49cfcaef825f7e4cfaf9d2993c0c7ef31', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.1ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 14, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;14\n', '2011-04-22 17:31:53', 0, '2011-04-22 17:31:53', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('1520a55dfcb168bd2ca426e197f166e376937637', '2011-04-22 17:31:53', NULL, NULL, NULL, '7d52fbf4dfd415ae0ff22f9d4caafd4132ab2655', NULL, '2011-04-22 17:31:53', NULL, '031d9e117b383b9731e92c4f18f1410728f9bf1d', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 15, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;15\n', '2011-04-22 17:31:53', 0, '2011-04-22 17:31:53', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 15) [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;36;1mUserPerson Destroy (0.3ms)[0m   [0;1mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mVote Update (0.4ms)[0m   [0;1mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;35;1mFeedLike Load (0.2ms)[0m   [0mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;35;1mFeed Load (0.4ms)[0m   [0mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;36;1mFeed Destroy (0.3ms)[0m   [0;1mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;35;1mNews Load (0.3ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.6ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:53', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:53', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Destroy (0.4ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;36;1mShippingTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:53', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;35;1mShippingTitle Destroy (0.4ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;35;1mShippingTitle Load (0.1ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:31:23' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mComponentText Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 5[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 6[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 7[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mPicture Load (0.3ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.1ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;35;1mComponentGallery Destroy (0.1ms)[0m   [0mDELETE FROM `components` WHERE `id` = 8[0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;36;1mComponentForm Destroy (0.3ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 9[0m
  [4;35;1mComponentGallery Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.6ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;35;1mBanner Load (0.3ms)[0m   [0mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;36;1mBackgroundTop Load (0.3ms)[0m   [0;1mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;35;1mBackground Load (0.3ms)[0m   [0mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;35;1mLayout Destroy (0.2ms)[0m   [0mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mPhone Destroy (0.4ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.4ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;36;1mCompanyService Load (0.3ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Destroy (0.3ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mCompanyZ Destroy (0.4ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;36;1mMessage Load (0.4ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;36;1mMessageCopy Destroy (0.2ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;35;1mMessage Destroy (0.2ms)[0m   [0mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;36;1mFolder Destroy (0.2ms)[0m   [0;1mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:53', `login` = 'quentin2' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin2' or email = 'quentin2') LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:53', `remember_token_expires_at` = '2011-05-06 17:31:53', `remember_token` = 'f72be84b98f8f8f95976be819c5e33427221157a' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:53', `remember_token_expires_at` = '2011-04-29 17:31:53', `remember_token` = '87c8e4596546ca2ec3cdca54829e1104fa25c651' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:53', `remember_token_expires_at` = '2011-04-29 17:31:53', `remember_token` = '87c8e4596546ca2ec3cdca54829e1104fa25c651' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:53', `crypted_password` = '4b6dd603c64f03bc2f676658e287094878df9603' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:54', `remember_token_expires_at` = '2011-05-06 17:31:54', `remember_token` = '2af24680830ffa041c093df79c06f3d1ce4eba4e' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:54', `remember_token_expires_at` = '2011-05-06 17:31:54', `remember_token` = '2af24680830ffa041c093df79c06f3d1ce4eba4e' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:54', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (2.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno com espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno_sem_espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno-sem-espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno12345434543comnumeros323') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'comcaract√©resespeciais') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load Including Associations (0.5ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing UsersController#create_page_2 (for 0.0.0.0 at 2011-04-22 14:31:54) [POST]
  Parameters: {"company"=>{"person_id"=>8}, "person"=>{"user_web_adm_id"=>#<UserWebAdministrator id: 6, login: "admin_web", email: "mg@mg2.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:31:44", updated_at: "2011-04-22 17:31:46", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:31:44", password_reset_code: nil, enabled: true, type: "UserWebAdministrator", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}, "id"=>"8"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:54', `user_web_adm_id` = 6 WHERE `id` = 10[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompanyZ Update (0.4ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:31:54', `person_id` = 8 WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 23ms (DB: 128) | 302 Found [http://test.host/users/create_page_2/8?company%5Bperson_id%5D=8&person%5Buser_web_adm_id%5D=6]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:54) [POST]
  Parameters: {"person"=>{"name"=>"gerente_geral", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:31:46 UTC 2011, "updated_at"=>Fri Apr 22 17:31:46 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"898.361.554-06", "id"=>4, "user_id"=>nil, "subsidiary_id"=>"1", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '898.361.554-06') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('5b1e3341cde116d80d46baf01e789a4dc881409b', '2011-04-22 17:31:54', NULL, NULL, NULL, 'fab0bb0ac30c225a5196beb6023cf4312c8350ed', NULL, '2011-04-22 17:31:54', NULL, '601fdf4c25ba8baeaafc883d391e787915ba3a62', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.4ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 16, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;16\n', '2011-04-22 17:31:54', 0, '2011-04-22 17:31:54', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 16) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:54', '2011-04-22 17:31:54', 16, 4)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 16) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 16 AND `user_people`.id <> 956136630) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 16)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 16) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 16) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:54', `user_id` = 16 WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '601fdf4c25ba8baeaafc883d391e787915ba3a62') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:54', `activated_at` = '2011-04-22 17:31:54' WHERE `id` = 16[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;16\n', '2011-04-22 17:31:54', 0, '2011-04-22 17:31:54', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (126.0ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.3ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.2ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 206ms (View: 158, DB: 15) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=898.361.554-06&person%5Bcreated_at%5D=Fri+Apr+22+17%3A31%3A46+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=4&person%5Bname%5D=gerente_geral&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=1&person%5Bupdated_at%5D=Fri+Apr+22+17%3A31%3A46+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;35;1mSQL (1.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 10) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:54) [POST]
  Parameters: {"person"=>{"name"=>"empresa_valid", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:31:46 UTC 2011, "updated_at"=>Fri Apr 22 17:31:46 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"573.683.830-39", "id"=>10, "user_id"=>nil, "subsidiary_id"=>"2", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '573.683.830-39') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (17.2ms)
Rendered people/_person (17.9ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.8ms)
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 44ms (View: 32, DB: 7) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=573.683.830-39&person%5Bcreated_at%5D=Fri+Apr+22+17%3A31%3A46+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=10&person%5Bname%5D=empresa_valid&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=2&person%5Bupdated_at%5D=Fri+Apr+22+17%3A31%3A46+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  Parameters: {"id"=>#<UserCompany id: 8, login: "empresa_valid", email: "empconfxx@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:31:44", updated_at: "2011-04-22 17:31:46", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:31:44", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- empresa_valid\n- administrator\n', '2011-04-22 17:31:54', 0, '2011-04-22 17:31:54', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.1ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.1ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;35;1mBusiness Load (0.1ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;36;1mFeed Load (0.1ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;35;1mFeed Destroy (0.2ms)[0m   [0mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;36;1mNews Load (0.1ms)[0m   [0;1mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.2ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;35;1mTitle Update (0.2ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:54', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:54', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mShippingTitle Destroy (0.1ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;35;1mTitle Update (0.4ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:31:54', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;36;1mShippingTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;36;1mShippingTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;35;1mTitle Destroy (0.4ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;36;1mShippingTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;35;1mTitle Destroy (0.4ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;36;1mShippingTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;35;1mTitle Destroy (0.4ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:31:23' and our_number is not null)) [0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.3ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;35;1mComponentText Destroy (0.3ms)[0m   [0mDELETE FROM `components` WHERE `id` = 5[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 6[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.3ms)[0m   [0mDELETE FROM `components` WHERE `id` = 7[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;35;1mPicture Load (0.3ms)[0m   [0mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.2ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;36;1mComponentGallery Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 8[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 9[0m
  [4;35;1mComponentGallery Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.4ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;36;1mColor Load (0.2ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;35;1mBanner Load (0.3ms)[0m   [0mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;36;1mBackgroundTop Load (0.3ms)[0m   [0;1mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;35;1mBackground Load (0.3ms)[0m   [0mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;35;1mLayout Destroy (0.3ms)[0m   [0mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mPhone Destroy (0.3ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.2ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;36;1mCompanyService Load (0.1ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;36;1mCompanyZ Destroy (0.4ms)[0m   [0;1mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;35;1mMessage Load (0.4ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;35;1mMessageCopy Destroy (0.3ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;36;1mMessage Destroy (0.1ms)[0m   [0;1mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mMessageCopy Destroy (0.2ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;35;1mFolder Destroy (0.4ms)[0m   [0mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.4ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 216ms (DB: 33) | 302 Found [http://test.host/usuarios/8]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:31:44", updated_at: "2011-04-22 17:31:46", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:31:44", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Redirected to http://test.host/usuarios
Completed in 2ms (DB: 4) | 302 Found [http://test.host/usuarios/12]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- administrator\n', '2011-04-22 17:31:54', 0, '2011-04-22 17:31:54', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.1ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.3ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 14ms (DB: 5) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:31:44", updated_at: "2011-04-22 17:31:46", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:31:44", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- \"empres\\xC3\\xA3 _&valid_2\"\n- administrator\n', '2011-04-22 17:31:54', 0, '2011-04-22 17:31:54', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 956136629[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 12) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 7) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.4ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 7) [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
  [4;36;1mFeed Load (0.4ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 7) [0m
  [4;35;1mNews Load (0.4ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 7) [0m
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 2[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.5ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 3[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:31:23' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 1) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.2ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 956136629[0m
  [4;36;1mComponentText Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 1[0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 2) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.1ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 2[0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 3) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.2ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 997002036[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 3[0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 4) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.4ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 208288675[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 4[0m
  [4;35;1mComponentGallery Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 3[0m
  [4;35;1mTab Destroy (0.1ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 4[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 2) LIMIT 1[0m
  [4;35;1mColor Destroy (0.3ms)[0m   [0mDELETE FROM `colors` WHERE `id` = 980190962[0m
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
  [4;35;1mBackgroundTop Load (0.3ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 2) [0m
  [4;36;1mBackground Load (0.3ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 2) [0m
  [4;35;1mPhone Load (0.2ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.3ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 2[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.4ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 7[0m
  [4;36;1mCompanyService Load (0.4ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 7) [0m
  [4;35;1mCompanyService Destroy (0.4ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 51848956[0m
  [4;36;1mCompanyService Destroy (0.4ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 113629430[0m
  [4;35;1mCompanyService Destroy (0.4ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 281110143[0m
  [4;36;1mCompanyService Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 298486374[0m
  [4;35;1mCompanyService Destroy (0.2ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 374648174[0m
  [4;36;1mCompanyService Destroy (0.1ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 638205575[0m
  [4;35;1mCompanyService Destroy (0.1ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 980190962[0m
  [4;36;1mCompanyService Destroy (0.1ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 1018350795[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 7) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.3ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 7[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 12 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.2ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 12 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mFolder Load (0.1ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 12) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.2ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 12) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mUserCompany Destroy (0.2ms)[0m   [0;1mDELETE FROM `users` WHERE `id` = 12[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 200ms (DB: 27) | 302 Found [http://test.host/usuarios/12]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (2.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- gerente_segmento\n', '2011-04-22 17:31:54', 0, '2011-04-22 17:31:54', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.4ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 15ms (DB: 8) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.2ms)
Rendered people/_person (15.5ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.0ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 31ms (View: 27, DB: 4) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:31:54) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (135.5ms)
Rendered people/_person (135.8ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 152ms (View: 148, DB: 3) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:31:55) [GET]
  Parameters: {"type"=>"UserCompany"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (13.9ms)
Rendered people/_person (14.2ms)
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (4.7ms)
Rendered companies/_company (11.5ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 44ms (View: 39, DB: 4) | 200 OK [http://test.host/signup?type=UserCompany]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:55) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('42b25dccaf070db8706aff205ae8a67f741f052b', '2011-04-22 17:31:55', NULL, NULL, NULL, '8e8dc6446ad898a41530e153218ec32b6a10a7d7', NULL, '2011-04-22 17:31:55', NULL, '14738d774b205d16640ccb0c6d3b4ce2d262b673', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 17, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:55', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;17\n', '2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 17) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 17) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:55', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:31:55', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 17) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.2ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:55', '2011-04-22 17:31:55', 17, 21)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 17) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 17 AND `user_people`.id <> 956136631) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 17)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 17) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 17) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 21)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=21) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 21)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 21)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 21)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 21)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:55', `user_id` = 17 WHERE `id` = 21[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '14738d774b205d16640ccb0c6d3b4ce2d262b673') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:55', `activated_at` = '2011-04-22 17:31:55' WHERE `id` = 17[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:55', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;17\n', '2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (2.4ms)
Rendered users/_user (2.2ms)
Rendered users/_user (2.2ms)
Rendered users/_user (2.1ms)
Rendered users/_user (2.2ms)
Rendered users/_user (2.1ms)
Rendered users/_user (2.2ms)
Rendered users/_user (2.2ms)
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 74ms (View: 27, DB: 12) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 17) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (150.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:55) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.4ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('42b25dccaf070db8706aff205ae8a67f741f052b', '2011-04-22 17:31:55', NULL, NULL, NULL, '8e8dc6446ad898a41530e153218ec32b6a10a7d7', NULL, '2011-04-22 17:31:55', NULL, 'd4501e53388698bf84174ffdaa85c83d7a8402ca', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.4ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 18, NULL)[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:55', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;18\n', '2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 0, NULL, NULL)[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 18) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 18) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:55', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:31:55', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 18) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:55', '2011-04-22 17:31:55', 18, 22)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=22) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 18) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 18) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (12.9ms)
Rendered people/_person (13.3ms)
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (10.2ms)
Rendered companies/_company (27.5ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 222ms (View: 50, DB: 162) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:31:55) [GET]
  Parameters: {"user"=>{"login"=>""}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY '' AND `users`.id <> 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'mg@mg.com' AND `users`.id <> 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 4) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering users/edit
Rendered people/_person_edit (12.8ms)
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (126.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 174ms (View: 161, DB: 6) | 200 OK [http://test.host/users/update?user%5Blogin%5D=]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:31:55) [GET]
  Parameters: {"id"=>#<UserSegmentManager id: 4, login: "gerente_segmento", email: "mg@mg.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:31:44", updated_at: "2011-04-22 17:31:46", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:31:44", password_reset_code: nil, enabled: true, type: "UserSegmentManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
Redirected to http://test.host/usuarios
Completed in 3ms (DB: 2) | 302 Found [http://test.host/users/resend_signup_mail/4]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:55) [POST]
  Parameters: {"company"=>{"parcel"=>12, "segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "value"=>50.0, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "company_type"=>"CompanyZ", "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('42b25dccaf070db8706aff205ae8a67f741f052b', '2011-04-22 17:31:55', NULL, NULL, NULL, '8e8dc6446ad898a41530e153218ec32b6a10a7d7', NULL, '2011-04-22 17:31:55', NULL, '731647d13da2e5864777a9398c837af6657ce9fd', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 19, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:55', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;19\n', '2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ656076') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.3ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:31:55', NULL, '2011-04-22 17:31:55', '61.286.834/0001-08', NULL, NULL, 19, 'CompanyZ', 'SZ656076', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 8) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:31:55', '2011-04-22 17:31:55', '2011-04-22 17:31:55', 50.0, 8, '2012-04-22 17:31:55', 'Aberto')[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:31:55', NULL, NULL, '2011-04-22 17:31:55', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 8, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.2ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.4ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 5) LIMIT 1[0m
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 5, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:31:55', `name` = 'Empresa', `created_at` = '2011-04-22 17:31:55', `company_id` = 8 WHERE `id` = 5[0m
  [4;36;1mAddress Create (0.4ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 5, 'MyString', 'MySring', 1, NULL, 'Layout', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.4ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:31:55', 'Home', '2011-04-22 17:31:55', NULL, 5)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 5, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.3ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:31:55', `layout_id` = NULL WHERE `id` = 980190963[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 0, 1, 8, 'Company')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:31:55', '2011-04-22 17:31:55', 8, 3)[0m
  [4;35;1mAddress Create (0.3ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:55', 0, '2011-04-22 17:31:55', 8, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 19) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 19) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 19) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 19) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 19) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 19) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ656076' AND `companies`.id <> 8) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (13.2ms)
Rendered people/_person (13.6ms)
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (4.3ms)
Rendered companies/_company (8.5ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 109ms (View: 32, DB: 15) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.0&company_type=CompanyZ&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ656076' AND `companies`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 19) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 19) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 19) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 19) LIMIT 1[0m
  [4;36;1mSQL (156.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('fc63be5f3529a8b9ed558a02b0bbcfefbe5ec38f', '2011-04-22 17:31:56', NULL, NULL, NULL, 'd7b694a518c109435d1f995fbe50c6562bb8acde', NULL, '2011-04-22 17:31:56', NULL, 'f41aed4b95363c491dfa300fb6ea806b811fdd46', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 20, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;20\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 20) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 20) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 20) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 20) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 20) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 20) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (17.0ms)
Rendered people/_person (17.4ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 59ms (View: 30, DB: 167) | 200 OK [http://test.host/usuarios?&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 20) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 20) LIMIT 1[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (14.3ms)
Rendered people/_person (14.6ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 47ms (View: 31, DB: 7) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>nil, "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (135.9ms)
Rendered people/_person (136.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 175ms (View: 157, DB: 5) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>nil, "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.4ms)
Rendered people/_person (15.8ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 46ms (View: 29, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=]
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>nil, "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (13.8ms)
Rendered people/_person (14.1ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.1ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 51ms (View: 33, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:31:56) [GET]
  Parameters: {"id"=>#<UserGeneralManager id: 2, login: "gerente_geral", email: "gerente_geral@example.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-21 17:31:44", updated_at: "2011-04-22 17:31:46", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9a", activated_at: nil, password_reset_code: nil, enabled: true, type: "UserGeneralManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:31:56 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/usuarios
Completed in 5ms (DB: 2) | 302 Found [http://test.host/users/resend_signup_mail/2]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('fc63be5f3529a8b9ed558a02b0bbcfefbe5ec38f', '2011-04-22 17:31:56', NULL, NULL, NULL, 'd7b694a518c109435d1f995fbe50c6562bb8acde', NULL, '2011-04-22 17:31:56', NULL, '1b9f1fbb8188553140a52cbab0f96da7b43ca77c', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 21, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;21\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 21) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 21) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:56', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:31:56', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;35;1mUserPerson Load (0.5ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 21) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.4ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:56', '2011-04-22 17:31:56', 21, 23)[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 21) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 21 AND `user_people`.id <> 956136633) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 21)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 21) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 21) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 23)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=23) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 23)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 23)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 23)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 23)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:56', `user_id` = 21 WHERE `id` = 23[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '1b9f1fbb8188553140a52cbab0f96da7b43ca77c') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:56', `activated_at` = '2011-04-22 17:31:56' WHERE `id` = 21[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;21\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (1.8ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 183ms (View: 7, DB: 12) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 21) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (1.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('fc63be5f3529a8b9ed558a02b0bbcfefbe5ec38f', '2011-04-22 17:31:56', NULL, NULL, NULL, 'd7b694a518c109435d1f995fbe50c6562bb8acde', NULL, '2011-04-22 17:31:56', NULL, 'd4b0b2b75614edb44a89953d946a9b0590c344cd', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 22, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;22\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 22) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 22) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:56', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:31:56', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 22) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:56', '2011-04-22 17:31:56', 22, 24)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 22) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 22 AND `user_people`.id <> 956136634) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 22)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 22) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 22) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 24)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=24) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 24)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 24)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 24)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 24)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:56', `user_id` = 22 WHERE `id` = 24[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'd4b0b2b75614edb44a89953d946a9b0590c344cd') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:56', `activated_at` = '2011-04-22 17:31:56' WHERE `id` = 22[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;22\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (1.8ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 57ms (View: 7, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUserAdministrator Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 22) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:56) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('fc63be5f3529a8b9ed558a02b0bbcfefbe5ec38f', '2011-04-22 17:31:56', NULL, NULL, NULL, 'd7b694a518c109435d1f995fbe50c6562bb8acde', NULL, '2011-04-22 17:31:56', NULL, '68bcc81cd7566fab6cbd46a6625161a369e04adc', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 23, NULL)[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;23\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 23) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 23) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:56', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:31:56', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 23) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:56', '2011-04-22 17:31:56', 23, 25)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 23) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 23 AND `user_people`.id <> 956136635) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 23)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 23) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 23) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 25)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=25) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 25)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 25)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 25)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 25)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:56', `user_id` = 23 WHERE `id` = 25[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '68bcc81cd7566fab6cbd46a6625161a369e04adc') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:56', `activated_at` = '2011-04-22 17:31:56' WHERE `id` = 23[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;23\n', '2011-04-22 17:31:56', 0, '2011-04-22 17:31:56', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (2.6ms)
Rendered users/_user (2.3ms)
Rendered users/_user (3.1ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.5ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.8ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 201ms (View: 155, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 23) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:57) [POST]
  Parameters: {"company"=>{"parcel"=>12, "segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "value"=>50.1, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"034.185.221-06", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '034.185.221-06') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.4ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9005b2b249c2a341e54cde16d050a4065cc167e0', '2011-04-22 17:31:57', NULL, NULL, NULL, '3039caf6b57a61e09c9f6282eda95018193a45b2', NULL, '2011-04-22 17:31:57', NULL, 'cc4758334b03e11425798aac619b1b65beba8008', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 24, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;24\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ952285') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.3ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:31:57', NULL, '2011-04-22 17:31:57', '61.286.834/0001-08', NULL, NULL, 24, 'CompanyZ', 'SZ952285', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 9) [0m
  [4;35;1mContract Create (0.2ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:31:57', '2011-04-22 17:31:57', '2011-04-22 17:31:57', 50.1, 9, '2012-04-22 17:31:57', 'Aberto')[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 9) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:31:57', NULL, NULL, '2011-04-22 17:31:57', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 9, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.3ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 6) LIMIT 1[0m
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 6, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:31:57', `name` = 'Empresa', `created_at` = '2011-04-22 17:31:57', `company_id` = 9 WHERE `id` = 6[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 6, 'MyString', 'MySring', 1, NULL, 'Layout', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.3ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:31:57', 'Home', '2011-04-22 17:31:57', NULL, 6)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 6, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.4ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:31:57', `layout_id` = NULL WHERE `id` = 980190965[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, 1, 9, 'Company')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 9, 4)[0m
  [4;35;1mAddress Create (0.2ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 9, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 24) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 24) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:57', 4, '034.185.221-06', '2008-09-09', '2011-04-22 17:31:57', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 24) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.2ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 24, 26)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ952285' AND `companies`.id <> 9) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 24) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 24 AND `user_people`.id <> 956136636) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 24)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 24) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 24) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=26) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:57', `user_id` = 24 WHERE `id` = 26[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'cc4758334b03e11425798aac619b1b65beba8008') LIMIT 1[0m
  [4;35;1mUserCompany Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:57', `activated_at` = '2011-04-22 17:31:57' WHERE `id` = 24[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;24\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 26) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=26) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.9ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;36;1mUser Load Including Associations (0.8ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 24) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 24)) [0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (4.5ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 9 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.5ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 245ms (View: 141, DB: 27) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.1&company_type=CompanyZ&person%5Bcpf%5D=034.185.221-06&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ952285' AND `companies`.id <> 9) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=26) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 26)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 24) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 24) LIMIT 1[0m
  [4;35;1mSQL (2.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:57) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "company_type"=>"CompanyZ", "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9005b2b249c2a341e54cde16d050a4065cc167e0', '2011-04-22 17:31:57', NULL, NULL, NULL, '3039caf6b57a61e09c9f6282eda95018193a45b2', NULL, '2011-04-22 17:31:57', NULL, 'd5a7293f5fc4dad665a32ec9f51c9742afbf92ea', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 25, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;25\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ201780') LIMIT 1[0m
  [4;36;1mCompanyZ Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:31:57', NULL, '2011-04-22 17:31:57', NULL, NULL, NULL, 25, 'CompanyZ', 'SZ201780', NULL, 'Empresa', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 10) [0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 10, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 25) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 25) LIMIT 1[0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:57', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:31:57', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 25) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 25, 27)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ201780' AND `companies`.id <> 10) LIMIT 1[0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 10) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=27) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 25) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 25) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ201780' AND `companies`.id <> 10) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (12.5ms)
Rendered people/_person (12.8ms)
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.5ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (4.6ms)
Rendered companies/_company (11.0ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.5ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 87ms (View: 32, DB: 21) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company_type=CompanyZ&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ201780' AND `companies`.id <> 10) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:57) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa", "informal"=>"1"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9005b2b249c2a341e54cde16d050a4065cc167e0', '2011-04-22 17:31:57', NULL, NULL, NULL, '3039caf6b57a61e09c9f6282eda95018193a45b2', NULL, '2011-04-22 17:31:57', NULL, '2a9f4850e8638e3cf32946b34c80da5c6aa38dc5', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 26, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;26\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ742557') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:31:57', NULL, '2011-04-22 17:31:57', NULL, NULL, NULL, 26, 'CompanyS', 'SZ742557', NULL, 'Empresa', NULL, NULL, 1, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 11) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.3ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:31:57', NULL, NULL, '2011-04-22 17:31:57', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 11, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 7) LIMIT 1[0m
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 7, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:31:57', `name` = 'Empresa', `created_at` = '2011-04-22 17:31:57', `company_id` = 11 WHERE `id` = 7[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.4ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 7, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:31:57', `layout_id` = NULL WHERE `id` = 980190967[0m
  [4;36;1mFeedItem Create (0.2ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, 1, 11, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 11, 5)[0m
  [4;36;1mAddress Create (0.2ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 11, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 26) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 26) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:57', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:31:57', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 26) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 26, 28)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ742557' AND `companies`.id <> 11) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 26) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 26 AND `user_people`.id <> 956136638) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 26)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 26) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 26) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=28) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:57', `user_id` = 26 WHERE `id` = 28[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '2a9f4850e8638e3cf32946b34c80da5c6aa38dc5') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:57', `activated_at` = '2011-04-22 17:31:57' WHERE `id` = 26[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;26\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 28) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=28) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 28)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.8ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.8ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 26) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 26)) [0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (4.2ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 235ms (View: 15, DB: 24) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Binformal%5D=1&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ742557' AND `companies`.id <> 11) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:57) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9005b2b249c2a341e54cde16d050a4065cc167e0', '2011-04-22 17:31:57', NULL, NULL, NULL, '3039caf6b57a61e09c9f6282eda95018193a45b2', NULL, '2011-04-22 17:31:57', NULL, '31985ddae035f5e6e17aefce1bc19eebada3e99e', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 27, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;27\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ92308') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.4ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:31:57', NULL, '2011-04-22 17:31:57', '61.286.834/0001-08', NULL, NULL, 27, 'CompanyS', 'SZ92308', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 12) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.3ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:31:57', NULL, NULL, '2011-04-22 17:31:57', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 8) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 8, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:31:57', `name` = 'Empresa', `created_at` = '2011-04-22 17:31:57', `company_id` = 12 WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:31:45', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 8, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:31:57', `layout_id` = NULL WHERE `id` = 980190969[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, 1, 12, 'Company')[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 12, 6)[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 12, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 27) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 27) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:31:57', 4, NULL, '2008-09-09', '2011-04-22 17:31:57', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 27) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:31:57', '2011-04-22 17:31:57', 27, 29)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ92308' AND `companies`.id <> 12) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 27) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 27 AND `user_people`.id <> 956136639) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 27)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 27) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 27) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=29) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:57', `user_id` = 27 WHERE `id` = 29[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '31985ddae035f5e6e17aefce1bc19eebada3e99e') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:57', `activated_at` = '2011-04-22 17:31:57' WHERE `id` = 27[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;27\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 29) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=29) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.8ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.8ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 27) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 27)) [0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (4.0ms)
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.1ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 234ms (View: 15, DB: 26) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ92308' AND `companies`.id <> 12) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=29) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 29)) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 27) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 27) LIMIT 1[0m
  [4;36;1mSQL (2.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:57) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mUserSegmentManager Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9005b2b249c2a341e54cde16d050a4065cc167e0', '2011-04-22 17:31:57', NULL, NULL, NULL, '3039caf6b57a61e09c9f6282eda95018193a45b2', NULL, '2011-04-22 17:31:57', NULL, 'da12f07dae2317ecc1f96657f619396f81f0b05d', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 28, NULL)[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;28\n', '2011-04-22 17:31:57', 0, '2011-04-22 17:31:57', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 28) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 28) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 28) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 28) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 28) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 28) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (16.2ms)
Rendered people/_person (16.6ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 60ms (View: 31, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 28) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 28) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 28) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 28) LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:31:58) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;35;1mUserSegmentManager Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('13890af587b369f905a6d628e9097461055b016b', '2011-04-22 17:31:58', NULL, NULL, NULL, '22b11803def0173e396b33b97c0b9ba22bef7552', NULL, '2011-04-22 17:31:58', NULL, 'ba0013d176d7b5a00b553af19f0b0468106a3b18', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 29, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:31:58', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;29\n', '2011-04-22 17:31:58', 0, '2011-04-22 17:31:58', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 29) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 29) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 29) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 29) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 29) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 29) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (17.3ms)
Rendered people/_person (17.7ms)
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.8ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 190ms (View: 33, DB: 10) | 200 OK [http://test.host/usuarios?person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 29) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 29) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 29) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 29) LIMIT 1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:31:58) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:31:58', `login` = 'quentin2' WHERE `id` = 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:31:58', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/
Completed in 21ms (DB: 8) | 302 Found [http://test.host/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.1ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m


Processing VisitSchedulerController#create (for 0.0.0.0 at 2011-04-22 14:31:58) [PUT]
  Parameters: {"visit_schedule"=>{"city"=>"oidjsa", "segment_id"=>#<Segment id: 1, name: "Alimenta√ß√£o", file: "Mystring.jpg">, "address"=>"diuashdiauhdiusha", "name"=>"siuhsi", "ddd"=>"021", "time_to_visit"=>"Indiferente", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:31:46", updated_at: "2011-04-22 17:31:46", enabled: true>, "phone"=>"212121", "email"=>"bruno@diudh.com"}}
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Sent mail to bsiqueira@suaempreza.com.br

Date: Fri, 22 Apr 2011 14:31:58 -0300
From: bsiqueira@suaempreza.com.br
To: bsiqueira@suaempreza.com.br
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_siuhsi=3A_Solicita=C3=A7=C3=A3o_de_visita?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>C√©lula Z</title>
</head>
<body>
  <h1> Solicita√ß√£o de Agendamento de Visita</h1>

  <p>
    <b>Nome:</b>
    siuhsi
  </p>

  <p>
    <b>Email:</b>
    bruno@diudh.com
  </p>

  <p>
    <b>Telefone:</b>
    021 212121
  </p>

  <p>
    <b>Endere√ßo:</b>
    diuashdiauhdiusha - oidjsa
  </p>

  <p>
    <b>Filial:</b>
    Filial 1
  </p>

  <p>
    <b>Segmento:</b>
    Alimenta√ß√£o
  </p>

  <p>
    <b>Hor√°rio de Prefer√™ncia para Visita:</b>
    Indiferente
  </p>

  <p>
    <b>Observa√ß√µes:</b>
    
  </p>
</body>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 11ms (DB: 2) | 302 Found [http://test.host/visit_scheduler/create?visit_schedule%5Baddress%5D=diuashdiauhdiusha&visit_schedule%5Bcity%5D=oidjsa&visit_schedule%5Bddd%5D=021&visit_schedule%5Bemail%5D=bruno%40diudh.com&visit_schedule%5Bname%5D=siuhsi&visit_schedule%5Bphone%5D=212121&visit_schedule%5Bsegment_id%5D=1&visit_schedule%5Bsubsidiary_id%5D=1&visit_schedule%5Btime_to_visit%5D=Indiferente]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing VisitSchedulerController#new (for 0.0.0.0 at 2011-04-22 14:31:58) [GET]
Rendering template within layouts/main
Rendering visit_scheduler/new
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`enabled` = 1) ORDER BY title[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.8ms)
Completed in 12ms (View: 11, DB: 1) | 200 OK [http://test.host/agendar-visita]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:31:58) [GET]
  Parameters: {"domain"=>"www.celudoaudhisauhdiasuhlaz.com.br"}
Completed in 230ms (View: 1, DB: 1) | 200 OK [http://test.host/whois/check?domain=www.celudoaudhisauhdiasuhlaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:31:58) [GET]
  Parameters: {"domain"=>"www.sorvetefeliz.com.br"}
Completed in 56ms (View: 0, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.sorvetefeliz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:31:58) [GET]
  Parameters: {"domain"=>"www.celulaz.com.br"}
Completed in 392ms (View: 1, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.celulaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:31:58) [GET]
  Parameters: {"id"=>"empres√£ _&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;36;1mCompanyZ Load Including Associations (0.7ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `layouts`.`id` AS t1_r0, `layouts`.`company_id` AS t1_r1, `layouts`.`architecture_type` AS t1_r2, `layouts`.`name` AS t1_r3, `layouts`.`slogan` AS t1_r4, `layouts`.`website` AS t1_r5, `layouts`.`presentation_text` AS t1_r6, `layouts`.`background_file_name` AS t1_r7, `layouts`.`created_at` AS t1_r8, `layouts`.`updated_at` AS t1_r9, `layouts`.`card1_file_name` AS t1_r10, `layouts`.`card1_content_type` AS t1_r11, `layouts`.`card1_file_size` AS t1_r12, `layouts`.`card2_file_name` AS t1_r13, `layouts`.`card2_content_type` AS t1_r14, `layouts`.`card2_file_size` AS t1_r15, `layouts`.`card3_file_name` AS t1_r16, `layouts`.`card3_content_type` AS t1_r17, `layouts`.`card3_file_size` AS t1_r18, `layouts`.`component_decoration` AS t1_r19, `layouts`.`show_name` AS t1_r20, `layouts`.`show_slogan` AS t1_r21, `layouts`.`show_logo` AS t1_r22, `layouts`.`background_top` AS t1_r23, `layouts`.`send_to_friend` AS t1_r24, `layouts`.`side_image_url` AS t1_r25, `layouts`.`font_colors` AS t1_r26, `layouts`.`email` AS t1_r27, `layouts`.`facebook` AS t1_r28, `layouts`.`orkut` AS t1_r29, `layouts`.`twitter` AS t1_r30, `layouts`.`flickr` AS t1_r31, `layouts`.`repeat_background_x` AS t1_r32, `layouts`.`repeat_background_y` AS t1_r33, `layouts`.`centralize_background` AS t1_r34, `layouts`.`meta_description` AS t1_r35, `layouts`.`meta_keywords` AS t1_r36, `layouts`.`analytics` AS t1_r37, `colors`.`id` AS t2_r0, `colors`.`name` AS t2_r1, `colors`.`slogan` AS t2_r2, `colors`.`title` AS t2_r3, `colors`.`subtitle` AS t2_r4, `colors`.`checked_menu` AS t2_r5, `colors`.`unchecked_menu` AS t2_r6, `colors`.`background_menu` AS t2_r7, `colors`.`tool_botton` AS t2_r8, `colors`.`text` AS t2_r9, `colors`.`tool_body` AS t2_r10, `colors`.`background` AS t2_r11, `colors`.`body` AS t2_r12, `colors`.`created_at` AS t2_r13, `colors`.`updated_at` AS t2_r14, `colors`.`layout_id` AS t2_r15, `colors`.`menu_deselected_text` AS t2_r16, `colors`.`menu_deselected_background` AS t2_r17, `colors`.`menu_selected_text` AS t2_r18, `colors`.`menu_selected_background` AS t2_r19, `colors`.`menu_hover_text` AS t2_r20, `colors`.`menu_hover_background` AS t2_r21, `colors`.`title_text` AS t2_r22, `colors`.`title_background` AS t2_r23, `colors`.`subtitle_text` AS t2_r24, `colors`.`subtitle_background` AS t2_r25, `colors`.`text_background` AS t2_r26, `colors`.`link_text` AS t2_r27, `colors`.`link_background` AS t2_r28, `colors`.`body_sidebar` AS t2_r29, `colors`.`border` AS t2_r30, `colors`.`name_company_text` AS t2_r31, `colors`.`slogan_company_text` AS t2_r32, `colors`.`footer_background` AS t2_r33, `colors`.`footer_text` AS t2_r34, `colors`.`sidebar_text` AS t2_r35, `users`.`id` AS t3_r0, `users`.`login` AS t3_r1, `users`.`email` AS t3_r2, `users`.`crypted_password` AS t3_r3, `users`.`salt` AS t3_r4, `users`.`created_at` AS t3_r5, `users`.`updated_at` AS t3_r6, `users`.`remember_token` AS t3_r7, `users`.`remember_token_expires_at` AS t3_r8, `users`.`activation_code` AS t3_r9, `users`.`activated_at` AS t3_r10, `users`.`password_reset_code` AS t3_r11, `users`.`enabled` AS t3_r12, `users`.`type` AS t3_r13, `users`.`self_created` AS t3_r14, `users`.`avatar_file_name` AS t3_r15, `users`.`avatar_content_type` AS t3_r16, `users`.`avatar_file_size` AS t3_r17, `users`.`avatar_updated_at` AS t3_r18, `users`.`domain` AS t3_r19 FROM `companies` LEFT OUTER JOIN `layouts` ON layouts.company_id = companies.id LEFT OUTER JOIN `colors` ON colors.layout_id = layouts.id LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (7) [0m
Cache write: empres√£ _&valid_2_layout
  [4;35;1mTab Load IDs For Limited Eager Loading (0.3ms)[0m   [0mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;36;1mTab Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;35;1mTab Load Including Associations (0.4ms)[0m   [0mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) AND `tabs`.id IN (3) ORDER BY tabs.order[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (2.8ms)
  [4;36;1mTab Load Including Associations (0.7ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order[0m
Rendered z/_social (0.5ms)
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (1.1ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.3ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (3.4ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 2 AND `addresses`.owner_type = 'Layout') LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
Rendered z/_address (4.5ms)
Rendered z/_sidebar_address (0.8ms)
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
Completed in 191ms (View: 163, DB: 10) | 200 OK [http://test.host/z/empres%C3%A3%20_&valid_2]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:31:59) [GET]
  Parameters: {"id"=>"empres%C3%A3%20_&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (0.6ms)
Rendered z/_social (0.1ms)
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.4ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (0.9ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (2.3ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_address (0.7ms)
Rendered z/_sidebar_address (0.1ms)
Completed in 26ms (View: 19, DB: 5) | 200 OK [http://test.host/z/empres%25C3%25A3%2520_&valid_2]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:31:59) [GET]
  Parameters: {"id"=>"asiuhiasuhaiuhsiauhsiauhsiuhai"}
Cache read: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='asiuhiasuhaiuhsiauhsiauhsiuhai') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
Cache write: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
Redirected to http://test.host/not_found
Filter chain halted as [:find_company] rendered_or_redirected.
Completed in 10ms (DB: 1) | 302 Found [http://test.host/z/asiuhiasuhaiuhsiauhsiauhsiuhai]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompanyS Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m


Processing CompanyManagementController#change_to_z (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  Parameters: {"id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:32:05", updated_at: "2011-04-22 17:32:05", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyS Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) AND ( (`companies`.`type` = 'CompanyS' ) ) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mUserCompany Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
Rendering template within layouts/new_admin
Rendering company_management/change_to_z
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 34ms (View: 20, DB: 223) | 200 OK [http://test.host/company_management/change_to_z/4-MyString]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mCompanyZ Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `companies`[0m


Processing CompanyManagementController#change_type_to_s (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:32:05", updated_at: "2011-04-22 17:32:05", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyZ Update (0.5ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:32:05', `type` = 'CompanyS' WHERE `id` = 7[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:32:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_s\nargs: \n- LOAD;CompanyZ;7\n', '2011-04-22 17:32:05', 0, '2011-04-22 17:32:05', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (2.1ms)
Rendered companies/_company_show (10.3ms)
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (8.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 50ms (View: 30, DB: 12) | 200 OK [http://test.host/company_management/change_type_to_s/7-MyString]
  [4;35;1mSQL (32.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  Parameters: {"company"=>{"register_number"=>"TESTESTESTES"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:32:05", updated_at: "2011-04-22 17:32:05", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mSQL (1.0ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;36;1mCompanyS Update (0.4ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:32:05', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:32:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:32:05', 0, '2011-04-22 17:32:05', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.9ms)
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUserWebAdministrator Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (11.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 77ms (View: 27, DB: 46) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bregister_number%5D=TESTESTESTES]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  Parameters: {"company"=>{"parcel"=>1, "register_number"=>"TESTESTESTES", "value"=>50.0}, "person"=>{"cpf"=>"099.033.907-69"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:32:05", updated_at: "2011-04-22 17:32:05", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.4ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:32:05', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:32:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:32:05', 0, '2011-04-22 17:32:05', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(1, '2011-04-22 17:32:05', '2011-04-22 17:32:05', '2011-04-22 17:32:05', 50.0, 4, '2012-04-22 17:32:05', 'Aberto')[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:32:05', `cpf` = '099.033.907-69' WHERE `id` = 9[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (5.7ms)
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (5.3ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 149ms (View: 17, DB: 11) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bparcel%5D=1&company%5Bregister_number%5D=TESTESTESTES&company%5Bvalue%5D=50.0&person%5Bcpf%5D=099.033.907-69]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 24ms (View: 18, DB: 5) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IN (12,7,8,5)) [0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 43ms (View: 30, DB: 9) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:32:05) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mUserGeneralManager Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 21ms (View: 10, DB: 6) | 200 OK [http://test.host/company_management]
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:32:06) [GET]
  Parameters: {"id"=>"8"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = '8') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `companies` WHERE (`companies`.`id` = 5) [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/8]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:32:06) [GET]
  Parameters: {"id"=>"XXX"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 'XXX') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/company_management
Completed in 2ms (DB: 1) | 302 Found [http://test.host/company_management/loggin_as_company/XXX]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:32:06) [GET]
  Parameters: {"id"=>"5"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:32:06) [GET]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 6ms (DB: 3) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggout_as_company (for 0.0.0.0 at 2011-04-22 14:32:06) [GET]
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Redirected to http://test.host/
Completed in 1ms (DB: 1) | 302 Found [http://test.host/company_management/loggout_as_company]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#edit (for 0.0.0.0 at 2011-04-22 14:32:06) [PUT]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:32:05", updated_at: "2011-04-22 17:32:05", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering company_management/edit
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` [0m
Rendered companies/_company_edit (4.0ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 15, DB: 2) | 200 OK [http://test.host/company_management/edit/5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#update (for 0.0.0.0 at 2011-04-22 14:32:06) [PUT]
  Parameters: {"company"=>{}, "id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:32:05", updated_at: "2011-04-22 17:32:05", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.1ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management/show/5-MyString
Completed in 8ms (DB: 2) | 302 Found [http://test.host/company_management/update/5-MyString?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyZ Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `companies`[0m


Processing CompanyToFriendController#create (for 0.0.0.0 at 2011-04-22 14:32:18) [GET]
  Parameters: {"email_from"=>"bruno_sil@yahoo.com.br", "company_id"=>"5", "email_to"=>"bsiqueira@gmail.com", "name_from"=>"Bruno Siqueira"}
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:32:18', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_new_send_to_friend\nargs: \n- bsiqueira@gmail.com\n- LOAD;CompanyZ;5\n', '2011-04-22 17:32:18', 0, '2011-04-22 17:32:18', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:32:18', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 19ms (View: 0, DB: 284) | 200 OK [http://test.host/company_to_friend?company_id=5&email_from=bruno_sil%40yahoo.com.br&email_to=bsiqueira%40gmail.com&name_from=Bruno+Siqueira]
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUserCompany Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mCompanyS Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mSHOW TABLES[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ805049') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.4ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:33:00', NULL, '2011-04-22 17:33:00', '76.633.274/0001-80', NULL, NULL, NULL, 'CompanyS', 'SZ805049', NULL, 'MyString', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 13) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.4ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('MyString', NULL, NULL, '2011-04-22 17:33:00', NULL, NULL, '2011-04-22 17:33:00', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 13, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 9) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:33:00', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:33:00', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 9, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:33:00', `name` = 'MyString', `created_at` = '2011-04-22 17:33:00', `company_id` = 13 WHERE `id` = 9[0m
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving attachments.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
  [4;35;1mColorTemplate Load (0.2ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:33:00', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:33:00', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 9, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:33:00', `layout_id` = NULL WHERE `id` = 980190971[0m
  [4;36;1mFeedItem Create (0.2ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:33:00', 0, '2011-04-22 17:33:00', 0, 1, 13, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:33:00', '2011-04-22 17:33:00', 13, 7)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 13) [0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyZ Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mCompany Load (1.3ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.2ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.4ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:33:00' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompanyZ Load Including Associations (0.6ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:33:00' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:32:58' and our_number is not null)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (1.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (2.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyS Columns (1.2ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.2ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 3 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.1ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 3) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.2ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:33:13', 0, 3, '2011-04-22 17:33:13')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.5ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.4ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUserGeneralManager Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:33:17) [GET]
  Parameters: {"id"=>"8f24789ae988411ccf33ab0c30fe9106fab32e9a"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '8f24789ae988411ccf33ab0c30fe9106fab32e9a') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserGeneralManager Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:33:17', `activated_at` = '2011-04-22 17:33:17' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:33:17', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserGeneralManager;2\n', '2011-04-22 17:33:17', 0, '2011-04-22 17:33:17', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 16ms (DB: 258) | 302 Found [http://test.host/ativar/8f24789ae988411ccf33ab0c30fe9106fab32e9a]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:33:17) [GET]
  Parameters: {"id"=>""}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '') LIMIT 1[0m
Redirected to http://test.host/signup
Completed in 2ms (DB: 2) | 302 Found [http://test.host/ativar/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:33:17) [GET]
Redirected to http://test.host/signup
Completed in 0ms (DB: 0) | 302 Found [http://test.host/ativar]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mUserSegmentManager Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mCompany Load (1.6ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyS Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mPerson Load (1.0ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing CompanySellerController#create (for 0.0.0.0 at 2011-04-22 14:33:26) [GET]
  Parameters: {"company"=>{"person_id"=>1}, "id"=>"3"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mPerson Load (0.9ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:33:26', `user_web_adm_id` = NULL WHERE `id` = 7[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20004' AND `companies`.id <> 3) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.3ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:33:26', `person_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 42ms (DB: 287) | 302 Found [http://test.host/company_seller/create/3?company%5Bperson_id%5D=1]
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyZ Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mPerson Load (2.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing CompanySellerController#destroy (for 0.0.0.0 at 2011-04-22 14:33:26) [GET]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:33:25", updated_at: "2011-04-22 17:33:25", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompanyZ Update (0.3ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:33:26', `person_id` = NULL WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 8ms (DB: 7) | 302 Found [http://test.host/company_seller/destroy/5-MyString]
  [4;36;1mCompanyZ Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:33:26) [GET]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering company_seller/new
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 20ms (View: 15, DB: 4) | 200 OK [http://test.host/company_seller/new/3]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:33:26) [GET]
  Parameters: {"id"=>"XXXXX"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 0) [0m
Redirected to http://test.host/company_management
Completed in 2ms (DB: 1) | 302 Found [http://test.host/company_seller/new/XXXXX]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.7ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:38:01) [GET]
  Parameters: {"id"=>"empres√£ _&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;35;1mCompanyZ Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;35;1mCompanyZ Load Including Associations (0.8ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `layouts`.`id` AS t1_r0, `layouts`.`company_id` AS t1_r1, `layouts`.`architecture_type` AS t1_r2, `layouts`.`name` AS t1_r3, `layouts`.`slogan` AS t1_r4, `layouts`.`website` AS t1_r5, `layouts`.`presentation_text` AS t1_r6, `layouts`.`background_file_name` AS t1_r7, `layouts`.`created_at` AS t1_r8, `layouts`.`updated_at` AS t1_r9, `layouts`.`card1_file_name` AS t1_r10, `layouts`.`card1_content_type` AS t1_r11, `layouts`.`card1_file_size` AS t1_r12, `layouts`.`card2_file_name` AS t1_r13, `layouts`.`card2_content_type` AS t1_r14, `layouts`.`card2_file_size` AS t1_r15, `layouts`.`card3_file_name` AS t1_r16, `layouts`.`card3_content_type` AS t1_r17, `layouts`.`card3_file_size` AS t1_r18, `layouts`.`component_decoration` AS t1_r19, `layouts`.`show_name` AS t1_r20, `layouts`.`show_slogan` AS t1_r21, `layouts`.`show_logo` AS t1_r22, `layouts`.`background_top` AS t1_r23, `layouts`.`send_to_friend` AS t1_r24, `layouts`.`side_image_url` AS t1_r25, `layouts`.`font_colors` AS t1_r26, `layouts`.`email` AS t1_r27, `layouts`.`facebook` AS t1_r28, `layouts`.`orkut` AS t1_r29, `layouts`.`twitter` AS t1_r30, `layouts`.`flickr` AS t1_r31, `layouts`.`repeat_background_x` AS t1_r32, `layouts`.`repeat_background_y` AS t1_r33, `layouts`.`centralize_background` AS t1_r34, `layouts`.`meta_description` AS t1_r35, `layouts`.`meta_keywords` AS t1_r36, `layouts`.`analytics` AS t1_r37, `colors`.`id` AS t2_r0, `colors`.`name` AS t2_r1, `colors`.`slogan` AS t2_r2, `colors`.`title` AS t2_r3, `colors`.`subtitle` AS t2_r4, `colors`.`checked_menu` AS t2_r5, `colors`.`unchecked_menu` AS t2_r6, `colors`.`background_menu` AS t2_r7, `colors`.`tool_botton` AS t2_r8, `colors`.`text` AS t2_r9, `colors`.`tool_body` AS t2_r10, `colors`.`background` AS t2_r11, `colors`.`body` AS t2_r12, `colors`.`created_at` AS t2_r13, `colors`.`updated_at` AS t2_r14, `colors`.`layout_id` AS t2_r15, `colors`.`menu_deselected_text` AS t2_r16, `colors`.`menu_deselected_background` AS t2_r17, `colors`.`menu_selected_text` AS t2_r18, `colors`.`menu_selected_background` AS t2_r19, `colors`.`menu_hover_text` AS t2_r20, `colors`.`menu_hover_background` AS t2_r21, `colors`.`title_text` AS t2_r22, `colors`.`title_background` AS t2_r23, `colors`.`subtitle_text` AS t2_r24, `colors`.`subtitle_background` AS t2_r25, `colors`.`text_background` AS t2_r26, `colors`.`link_text` AS t2_r27, `colors`.`link_background` AS t2_r28, `colors`.`body_sidebar` AS t2_r29, `colors`.`border` AS t2_r30, `colors`.`name_company_text` AS t2_r31, `colors`.`slogan_company_text` AS t2_r32, `colors`.`footer_background` AS t2_r33, `colors`.`footer_text` AS t2_r34, `colors`.`sidebar_text` AS t2_r35, `users`.`id` AS t3_r0, `users`.`login` AS t3_r1, `users`.`email` AS t3_r2, `users`.`crypted_password` AS t3_r3, `users`.`salt` AS t3_r4, `users`.`created_at` AS t3_r5, `users`.`updated_at` AS t3_r6, `users`.`remember_token` AS t3_r7, `users`.`remember_token_expires_at` AS t3_r8, `users`.`activation_code` AS t3_r9, `users`.`activated_at` AS t3_r10, `users`.`password_reset_code` AS t3_r11, `users`.`enabled` AS t3_r12, `users`.`type` AS t3_r13, `users`.`self_created` AS t3_r14, `users`.`avatar_file_name` AS t3_r15, `users`.`avatar_content_type` AS t3_r16, `users`.`avatar_file_size` AS t3_r17, `users`.`avatar_updated_at` AS t3_r18, `users`.`domain` AS t3_r19 FROM `companies` LEFT OUTER JOIN `layouts` ON layouts.company_id = companies.id LEFT OUTER JOIN `colors` ON colors.layout_id = layouts.id LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (7) [0m
Cache write: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;35;1mTab Load IDs For Limited Eager Loading (0.4ms)[0m   [0mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;36;1mTab Load Including Associations (0.3ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) AND `tabs`.id IN (3) ORDER BY tabs.order[0m
  [4;35;1mComponentForm Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mComponentText Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mComponentPicture Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `components`[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (5.7ms)
  [4;36;1mTab Load Including Associations (0.8ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order[0m
Rendered z/_social (0.5ms)
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (1.0ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (2.0ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (5.1ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 2 AND `addresses`.owner_type = 'Layout') LIMIT 1[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
Rendered z/_address (6.5ms)
Rendered z/_sidebar_address (0.8ms)
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
Completed in 189ms (View: 144, DB: 285) | 200 OK [http://test.host/z/empres%C3%A3%20_&valid_2]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:38:01) [GET]
  Parameters: {"id"=>"empres%C3%A3%20_&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (0.5ms)
Rendered z/_social (0.1ms)
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.4ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (0.8ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (2.5ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_address (0.8ms)
Rendered z/_sidebar_address (0.1ms)
Completed in 26ms (View: 19, DB: 4) | 200 OK [http://test.host/z/empres%25C3%25A3%2520_&valid_2]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:38:01) [GET]
  Parameters: {"id"=>"asiuhiasuhaiuhsiauhsiauhsiuhai"}
Cache read: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='asiuhiasuhaiuhsiauhsiauhsiuhai') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
Cache write: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
Redirected to http://test.host/not_found
Filter chain halted as [:find_company] rendered_or_redirected.
Completed in 11ms (DB: 1) | 302 Found [http://test.host/z/asiuhiasuhaiuhsiauhsiauhsiuhai]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.8ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.5ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUserCompany Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.8ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.5ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUserCompany Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.5ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUserCompany Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUserCompany Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUserGeneralManager Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
  Parameters: {"id"=>"8f24789ae988411ccf33ab0c30fe9106fab32e9a"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '8f24789ae988411ccf33ab0c30fe9106fab32e9a') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserGeneralManager Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:30', `activated_at` = '2011-04-22 17:43:30' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:30', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserGeneralManager;2\n', '2011-04-22 17:43:30', 0, '2011-04-22 17:43:30', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 17ms (DB: 273) | 302 Found [http://test.host/ativar/8f24789ae988411ccf33ab0c30fe9106fab32e9a]
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
  Parameters: {"id"=>""}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '') LIMIT 1[0m
Redirected to http://test.host/signup
Completed in 2ms (DB: 2) | 302 Found [http://test.host/ativar/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
Redirected to http://test.host/signup
Completed in 1ms (DB: 0) | 302 Found [http://test.host/ativar]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUserCompany Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `users`[0m


Processing Company::AddressController#update (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
  Parameters: {"address"=>{}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (1.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered company/address/_address (1.7ms)
  [4;35;1mState Load (0.5ms)[0m   [0mSELECT * FROM `states` [0m
Rendered company/address/_form (7.7ms)
Rendering company/address/update
Completed in 30ms (View: 1, DB: 0) | 200 OK [http://test.host/company/address/update?]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::AddressController#update (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
  Parameters: {"address"=>{"street"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT * FROM `states` [0m
Rendered company/address/_form (5.5ms)
Rendering company/address/update
Completed in 14ms (View: 2, DB: 0) | 200 OK [http://test.host/company/address/update?address%5Bstreet%5D=]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessCardController#index (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Google geocoding. Address: MyString MyString 1111 MyString MySring RJ Rio de Janeiro Brasil. Result: <?xml version="1.0" encoding="UTF-8" ?>
<kml xmlns="http://earth.google.com/kml/2.0"><Response>
  <name>MyString MyString 1111 MyString MySring RJ Rio de Janeiro Brasil</name>
  <Status>
    <code>200</code>
    <request>geocode</request>
  </Status>
  <Placemark id="p1">
    <address>Rio de Janeiro, Brazil</address>
    <AddressDetails Accuracy="4" xmlns="urn:oasis:names:tc:ciq:xsdschema:xAL:2.0"><Country><CountryNameCode>BR</CountryNameCode><CountryName>Brasil</CountryName><AdministrativeArea><AdministrativeAreaName>RJ</AdministrativeAreaName><Locality><LocalityName>Rio de Janeiro</LocalityName></Locality></AdministrativeArea></Country></AddressDetails>
    <ExtendedData>
      <LatLonBox north="-22.5742361" south="-23.2320449" east="-42.6973493" west="-43.7218245" />
    </ExtendedData>
    <Point><coordinates>-43.2095869,-22.9035393,0</coordinates></Point>
  </Placemark>
</Response></kml>
Rendering template within layouts/company
Rendering company/business_card/index
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
Rendered company/phones/_form (4.9ms)
Rendered company/address/_address (0.3ms)
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered company/address/_form (4.9ms)
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
Rendered company/business_card/_card_image_form (85.6ms)
Rendered company/business_card/_card_image_form (1.2ms)
Rendered company/business_card/_card_image_form (1.1ms)
  [4;35;1mService Load (0.6ms)[0m   [0mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 7)) [0m
  [4;36;1mService Load (0.3ms)[0m   [0;1mSELECT * FROM `services` [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 818ms (View: 138, DB: 5) | 200 OK [http://test.host/empresa/cartao-de-visitas]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::BusinessCardController#update (for 0.0.0.0 at 2011-04-22 14:43:30) [GET]
  Parameters: {"id"=>"presentation_text", "value"=>"123"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:30', `presentation_text` = '123' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 8ms (View: 0, DB: 2) | 200 OK [http://test.host/company/business_card/update/presentation_text?value=123]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [POST]
  Parameters: {"business"=>{}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.6ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 27ms (View: 14, DB: 6) | 200 OK [http://test.host/company/businesses?]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mBusiness Load (0.1ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:43:31) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 10, DB: 7) | 200 OK [http://test.host/company/businesses]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 10, DB: 2) | 200 OK [http://test.host/company/businesses/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:43:31) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"tipo"=>"texto", "component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponentText Columns (2.1ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:31', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Create (0.4ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:43:31', 'titulo do component', NULL, NULL, '2011-04-22 17:43:31', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 29ms (View: 0, DB: 11) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"tipo"=>"texto", "component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mComponentText Create (0.3ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:43:31', 'C√≥digo', NULL, NULL, '2011-04-22 17:43:31', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 11ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m
  [4;36;1mSQL (2.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 110ms (View: 105, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mLayout Update (0.5ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:31', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:43:31', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;35;1mComponentForm Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mComponentForm Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 17:43:31', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ConstructionController#content (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering /company/construction/content.json
  [4;36;1mTab Load (0.6ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mComponentPicture Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 1)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 3) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 3)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 4) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
Completed in 31ms (View: 0, DB: 0) | 200 OK [http://test.host/company/construction/content]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::LayoutController#update_background (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"/image/temp_small"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:31', `background_file_name` = '/image/temp' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 12ms (View: 0, DB: 3) | 200 OK [http://test.host/company/layout/update_background/%2Fimage%2Ftemp_small]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::LayoutController#update_background_top (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"/image/temp_small"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:31', `background_top` = '/image/temp' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 0, DB: 4) | 200 OK [http://test.host/company/layout/update_background_top/%2Fimage%2Ftemp_small]
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::MailboxController#index (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mFolder Load (0.5ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `message_copies`.id FROM `message_copies` LEFT OUTER JOIN `messages` ON `messages`.id = `message_copies`.message_id WHERE ((`message_copies`.folder_id = 980190962) AND (deleted IS NULL OR deleted = 0)) ORDER BY messages.created_at DESC LIMIT 0, 10[0m
  [4;35;1mMessageCopy Load (0.4ms)[0m   [0mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/mailbox/index
Rendered company/shared/_message_actions (0.5ms)
  [4;36;1mCompany Load (0.8ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mCompany Count (0.5ms)[0m   [0;1mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (7.8ms)
Rendered company/shared/_message_box_label (2.1ms)
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 36ms (View: 19, DB: 7) | 200 OK [http://test.host/company/mailbox]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::MessageToFriendController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"message_to_friend"=>{"email_to"=>"teste@hotmail.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:31', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_to_friend\nargs: \n- &id001 !ruby/object:MessageToFriend \n company: !ruby/object:CompanyZ \n attributes: \n segment_id: \"1\"\n profile_logo_updated_at: \n created_at: 2011-04-22 17:43:29\n updated_at: 2011-04-22 17:43:29\n profile_logo_file_name: \n register_number: \n cnpj: 15.754.056/0001-09\n id: \"5\"\n drawee_code: SZ20002\n type: CompanyZ\n user_id: \"8\"\n person_id: \"13\"\n profile_logo_content_type: \n razao_social: MyString\n informal: \n state_id: \n profile_logo_file_size: \n payment_type: mensal\n attributes_cache: {}\n\n layout: !ruby/object:Layout \n attributes: \n flickr: \n name: Empresa 1\n created_at: 2011-04-22 17:43:29\n slogan: A primeira empresa do banco de testes\n repeat_background_x: \n font_colors: \n repeat_background_y: \n side_image_url: \n updated_at: 2011-04-22 17:43:29\n send_to_friend: \"0\"\n show_logo: \n show_slogan: \n show_name: \n centralize_background: \n id: \"1\"\n meta_keywords: \n meta_description: \n card2_file_name: \n card2_file_size: \n card2_content_type: \n card1_file_name: \n website: www.sitedaempresa1.com.br\n company_id: \"5\"\n facebook: \n background_top: \n card3_content_type: \n card1_file_size: \n architecture_type: \"6\"\n orkut: \n component_decoration: \n card3_file_name: \n background_file_name: \n presentation_text: \"texto de apresenta\\xC3\\xA7\\xC3\\xA3o da empresa 1\"\n analytics: \n twitter: \n email: \n card3_file_size: \n card1_content_type: \n attributes_cache: {}\n\n email_to: teste@hotmail.com\n errors: !ruby/object:ActiveRecord::Errors \n base: *id001\n errors: !omap []\n\n', '2011-04-22 17:43:31', 0, '2011-04-22 17:43:31', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/message_to_friend/create
Completed in 117ms (View: 1, DB: 2) | 200 OK [http://test.host/company/message_to_friend/create?message_to_friend%5Bemail_to%5D=teste%40hotmail.com]
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m


Processing Company::MessagesController#destroy (for 0.0.0.0 at 2011-04-22 14:43:31) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = '1') AND (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mMessageCopy Update (0.3ms)[0m   [0;1mUPDATE `message_copies` SET `deleted` = 1, `updated_at` = '2011-04-22 17:43:31' WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 13ms (View: 0, DB: 4) | 200 OK [http://test.host/company/mensagens/1]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m


Processing Company::MessagesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [POST]
  Parameters: {"message"=>{"body"=>"Corpo da mensagem", "sender"=>"8", "subject"=>"Teste - Mensagem enviada do sistema", "to"=>"8"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: sender
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.3ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES(NULL, '2011-04-22 17:43:31', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:43:31', 'Teste - Mensagem enviada do sistema', 8, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 6) [0m
  [4;35;1mMessageCopy Create (0.2ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:43:31', NULL, 8, NULL, NULL, 6)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:31', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;5\n', '2011-04-22 17:43:31', 0, '2011-04-22 17:43:31', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:31', 0, '2011-04-22 17:43:31', 0, 0, 6, 'Message')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:31', '2011-04-22 17:43:31', 5, 8)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 25ms (View: 0, DB: 6) | 200 OK [http://test.host/company/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender%5D=8&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+sistema&message%5Bto%5D=8]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m


Processing Company::MessagesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [POST]
  Parameters: {"message"=>{"body"=>"Corpo da mensagem de resposta", "sender"=>"8", "subject"=>"Teste - Mensagem enviada do sistema", "to"=>"8"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: sender
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;35;1mMessage Create (0.2ms)[0m   [0mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES(NULL, '2011-04-22 17:43:31', NULL, NULL, NULL, 'Corpo da mensagem de resposta', NULL, '2011-04-22 17:43:31', 'Teste - Mensagem enviada do sistema', 8, NULL, NULL)[0m
  [4;36;1mMessageCopy Load (0.1ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 7) [0m
  [4;36;1mMessageCopy Create (0.3ms)[0m   [0;1mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:43:31', NULL, 8, NULL, NULL, 7)[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:31', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;6\n', '2011-04-22 17:43:31', 0, '2011-04-22 17:43:31', 0, NULL, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:31', 0, '2011-04-22 17:43:31', 0, 0, 7, 'Message')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:31', '2011-04-22 17:43:31', 5, 9)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 21ms (View: 0, DB: 6) | 200 OK [http://test.host/company/mensagens?message%5Bbody%5D=Corpo+da+mensagem+de+resposta&message%5Bsender%5D=8&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+sistema&message%5Bto%5D=8]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m


Processing Company::MessagesController#show (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
  [4;35;1mMessageCopy Load (0.2ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = '1') AND (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mMessageCopy Update (0.4ms)[0m   [0mUPDATE `message_copies` SET `updated_at` = '2011-04-22 17:43:31', `read` = 1 WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/messages/show
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.6ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.7ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mMessage Load (0.4ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 32ms (View: 19, DB: 10) | 200 OK [http://test.host/company/mensagens/1]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing Company::PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Rendering template within layouts/company
Rendering company/people/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 34ms (View: 25, DB: 4) | 200 OK [http://test.host/company/people/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing Company::PeopleController#update (for 0.0.0.0 at 2011-04-22 14:43:31) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/people/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 36ms (View: 23, DB: 5) | 200 OK [http://test.host/company/people/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"phone"=>{"number"=>88888888, "ddd"=>21}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mPhone Create (0.3ms)[0m   [0;1mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(88888888, '2011-04-22 17:43:31', '2011-04-22 17:43:31', 21, 5, NULL, NULL, 'Company')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_phone (0.4ms)
Rendered company/phones/_form (1.4ms)
Completed in 14ms (View: 3, DB: 2) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=21&phone%5Bnumber%5D=88888888]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m


Processing Company::PhonesController#destroy (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962 AND (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.4ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/destroy
Completed in 7ms (View: 1, DB: 5) | 200 OK [http://test.host/company/phones/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"phone"=>{"number"=>"", "ddd"=>""}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.8ms)
Completed in 11ms (View: 6, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=&phone%5Bnumber%5D=]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"phone"=>{"number"=>nil, "ddd"=>nil}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.6ms)
Completed in 10ms (View: 6, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=&phone%5Bnumber%5D=]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:43:31) [GET]
  Parameters: {"phone"=>{"number"=>"dsafsa", "ddd"=>"3ewew"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.5ms)
Completed in 11ms (View: 6, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=3ewew&phone%5Bnumber%5D=dsafsa]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;36;1mPicture Load (0.1ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mComponentGallery Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::PicturesController#update (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"id"=>#<Picture id: 1, component_id: 8, title: "MyString", description: "MyText", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", photo_file_size: nil, photo_content_type: nil, photo_file_name: nil, component_type: "Component">, "component_id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "picture"=>{"description"=>"sou a nova descri√ß√£o"}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8 AND (`components`.layout_id = 1)) [0m
  [4;36;1mPicture Load (0.4ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1 AND (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.3ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:43:32', `description` = 'sou a nova descri√ß√£o' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 18ms (View: 1, DB: 5) | 200 OK [http://test.host/company/componentes/8/images/1?picture%5Bdescription%5D=sou+a+nova+descri%C3%A7%C3%A3o]
  [4;36;1mPicture Load (0.3ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ProfileController#index (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 7)) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 7)) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT distinct feed_items.* FROM `feed_items` INNER JOIN `feeds` ON feeds.feed_item_id = feed_items.id WHERE (feeds.company_id in (5,7) and (is_public = 1 or company_id = 7)) ORDER BY feed_items.updated_at desc LIMIT 0, 10[0m
Rendering template within layouts/company
Rendering company/profile/index
  [4;36;1mCompany Load (0.3ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=false) 
 WHERE (destinies.company_destiny_id=7)[0m
Rendered company/news/_news (0.9ms)
Rendered company/profile/_feeds (0.9ms)
Rendered company/message_to_friend/_form (2.9ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7) LIMIT 0, 4[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mVisit Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `visits`[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/z/empres√£ _&valid_2' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:43:32') [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/z/empres√£ _&valid_2' and created_at>'2011-03-22 17:43:32' and created_at<'2011-04-22 17:43:32') [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/company/profile/public/7-MyString' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:43:32') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/company/profile/public/7-MyString' and created_at>'2011-03-22 17:43:32' and created_at<'2011-04-22 17:43:32') [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/business_cards/7-MyString' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:43:32') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/business_cards/7-MyString' and created_at>'2011-03-22 17:43:32' and created_at<'2011-04-22 17:43:32') [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
Completed in 42ms (View: 25, DB: 10) | 200 OK [http://test.host/empresa-inicio]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Company::ProfileController#public (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.* FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering company/profile/public
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE (`companies`.`id` = 7) AND ((`company_relationships`.company_destiny_id = 7)) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 7) AND ((`company_relationships`.company_origin_id = 7)) LIMIT 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mAddress Load (0.5ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mService Load (0.5ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 7)) [0m
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7) LIMIT 20, 5[0m
  [4;36;1mCompany Count (0.6ms)[0m   [0;1mSELECT COUNT(*) FROM (
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7)) AS count_table[0m
Rendered company/profile/_feeds (0.1ms)
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mVisit Load (0.4ms)[0m   [0mSELECT `visits`.id FROM `visits` WHERE (`visits`.`request_url` = '/company/profile/public/#<CompanyZ:0x106306a40>' AND `visits`.`session` = '62821ee9005c79466a8c4e6b2a11c17a') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mVisit Create (0.3ms)[0m   [0mINSERT INTO `visits` (`created_at`, `session`, `updated_at`, `user_id`, `request_url`, `ip_address`) VALUES('2011-04-22 17:43:32', '62821ee9005c79466a8c4e6b2a11c17a', '2011-04-22 17:43:32', 12, '/company/profile/public/#<CompanyZ:0x106306a40>', '0.0.0.0')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 37ms (View: 23, DB: 9) | 200 OK [http://test.host/company/profile/public/7-MyString]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompanyS Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 4) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>"4"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 4) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 4 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.4ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 4 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.1ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 4) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.2ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:43:32', 0, 4, '2011-04-22 17:43:32')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:32', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyRelationshipMailer\nmethod: :deliver_request\nargs: \n- LOAD;CompanyRelationship;495905391\n- \n', '2011-04-22 17:43:32', 0, '2011-04-22 17:43:32', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/relationship_request/create
Completed in 20ms (View: 1, DB: 8) | 200 OK [http://test.host/company/relationship_request/create/4]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mCompanyZ Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 3) [0m
Redirected to http://test.host/company/relationship_request/update/3
Completed in 5ms (DB: 5) | 302 Found [http://test.host/company/relationship_request/create/3]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_destiny_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering company/relationship_request/create
Completed in 9ms (View: 0, DB: 5) | 200 OK [http://test.host/company/relationship_request/create/5]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing Company::RelationshipRequestController#destroy (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyRelationship Delete all (0.3ms)[0m   [0mDELETE FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3 AND `company_relationships`.`company_destiny_id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.0ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Delete all (0.1ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.`company_destiny_id` = 3) [0m
  [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/profile/public/3-empresa
Completed in 6ms (DB: 3) | 302 Found [http://test.host/company/relationship_request/destroy/3]
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5)) [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing Company::RelationshipRequestController#update (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = '3') AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyRelationship Update (0.4ms)[0m   [0;1mUPDATE `company_relationships` SET `updated_at` = '2011-04-22 17:43:32', `confirmed` = 1 WHERE `id` = 495905389[0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:32', 0, '2011-04-22 17:43:32', 0, 1, 495905389, 'CompanyRelationship')[0m
  [4;36;1mFeed Create (0.4ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:32', '2011-04-22 17:43:32', 5, 10)[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:32', '2011-04-22 17:43:32', 3, 10)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/relationship_request/update
Completed in 14ms (View: 1, DB: 5) | 200 OK [http://test.host/company/relationship_request/update/3]
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipsController#friend_requests (for 0.0.0.0 at 2011-04-22 14:43:32) [POST]
  Parameters: {"company_origin_id"=>#<CompanyS id: 3, user_id: 5, cnpj: "88.323.034/0001-68", razao_social: "empresa", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20004", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "status"=>"true"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.5ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3) AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyRelationship Update (0.2ms)[0m   [0;1mUPDATE `company_relationships` SET `updated_at` = '2011-04-22 17:43:32', `confirmed` = 1 WHERE `id` = 495905389[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:32', 0, '2011-04-22 17:43:32', 0, 1, 495905389, 'CompanyRelationship')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:32', '2011-04-22 17:43:32', 5, 11)[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:32', '2011-04-22 17:43:32', 3, 11)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 20ms (View: 0, DB: 7) | 200 OK [http://test.host/company/relationships/friend_requests?company_origin_id=3-empresa&status=true]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipsController#friend_requests (for 0.0.0.0 at 2011-04-22 14:43:32) [POST]
  Parameters: {"company_origin_id"=>#<CompanyS id: 3, user_id: 5, cnpj: "88.323.034/0001-68", razao_social: "empresa", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20004", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "status"=>"false"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3) AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Destroy (0.4ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 6ms (View: 0, DB: 5) | 200 OK [http://test.host/company/relationships/friend_requests?company_origin_id=3-empresa&status=false]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::SentController#index (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessage Load (0.5ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) ORDER BY created_at DESC LIMIT 0, 10[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/sent/index
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.8ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.6ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.6ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `message_copies` ON `users`.id = `message_copies`.recipient_id WHERE ((`message_copies`.message_id = 1)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `message_copies` ON `users`.id = `message_copies`.recipient_id WHERE ((`message_copies`.message_id = 1)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 139ms (View: 18, DB: 7) | 200 OK [http://test.host/company/sent]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m


Processing Company::SentController#show (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1 AND (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null))) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/sent/show
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.6ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.3ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 24ms (View: 15, DB: 6) | 200 OK [http://test.host/company/sent/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mService Load (0.3ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m


Processing Company::ServiceController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mService Load (0.3ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;36;1mService Load (0.3ms)[0m   [0;1mSELECT `services`.id FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE (`services`.`id` = 1) AND ((`company_services`.company_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyService Create (0.2ms)[0m   [0;1mINSERT INTO `company_services` (`created_at`, `updated_at`, `service_id`, `company_id`) VALUES('2011-04-22 17:43:32', '2011-04-22 17:43:32', 1, 5)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/service/create
Completed in 14ms (View: 1, DB: 3) | 200 OK [http://test.host/company/service/create/1]
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyZ Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mService Load (0.2ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyService Create (0.3ms)[0m   [0mINSERT INTO `company_services` (`created_at`, `updated_at`, `service_id`, `company_id`) VALUES('2011-04-22 17:43:32', '2011-04-22 17:43:32', 1, 5)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) LIMIT 1[0m


Processing Company::ServiceController#destroy (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mService Load (0.3ms)[0m   [0;1mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyService Delete all (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE (`company_services`.`service_id` = 1 AND `company_services`.`company_id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/service/destroy
Completed in 5ms (View: 1, DB: 7) | 200 OK [http://test.host/company/service/destroy/1]
  [4;36;1mCompanyZ Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `services`.id) AS count_services_id FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.1ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mTab Load (0.1ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabComponentsController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "tab_component"=>{"line"=>5, "column"=>1, "full_line"=>true, "tab_id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", order: 1.0>}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 8)) LIMIT 1[0m
  [4;36;1mTabComponent Load (0.2ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 8) [0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Create (0.3ms)[0m   [0mINSERT INTO `tab_components` (`created_at`, `line`, `updated_at`, `column`, `full_line`, `tab_id`, `component_id`) VALUES('2011-04-22 17:43:32', 5, '2011-04-22 17:43:32', 1, 1, 1, 8)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 14ms (View: 0, DB: 4) | 200 OK [http://test.host/company/tab_components/create/8?tab_component%5Bcolumn%5D=1&tab_component%5Bfull_line%5D=true&tab_component%5Bline%5D=5&tab_component%5Btab_id%5D=1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m


Processing Company::TabComponentsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;36;1mTabComponent Delete all (0.3ms)[0m   [0;1mDELETE FROM `tab_components` WHERE (`id` IN (148646006)) [0m
Completed in 6ms (View: 0, DB: 4) | 200 OK [http://test.host/company/tab_components/destroy/5]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mTab Load (0.1ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabComponentsController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "tab_component"=>{"line"=>5, "column"=>1, "full_line"=>true, "tab_id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", order: 1.0>}}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;35;1mTabComponent Delete all (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE (`id` IN (148646006)) [0m
  [4;36;1mTabComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTabComponent Create (0.3ms)[0m   [0;1mINSERT INTO `tab_components` (`created_at`, `line`, `updated_at`, `column`, `full_line`, `tab_id`, `component_id`) VALUES('2011-04-22 17:43:32', 5, '2011-04-22 17:43:32', 1, 1, 1, 5)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 9ms (View: 0, DB: 4) | 200 OK [http://test.host/company/tab_components/create/5?tab_component%5Bcolumn%5D=1&tab_component%5Bfull_line%5D=true&tab_component%5Bline%5D=5&tab_component%5Btab_id%5D=1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tab_components` [0m


Processing Company::TabComponentsController#update (for 0.0.0.0 at 2011-04-22 14:43:32) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "full_line"=>true}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Update (0.3ms)[0m   [0mUPDATE `tab_components` SET `updated_at` = '2011-04-22 17:43:32', `full_line` = 1 WHERE `id` = 148646006[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 7ms (View: 0, DB: 4) | 200 OK [http://test.host/company/tab_components/update/5?full_line=true]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponentText Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) AND ( (`components`.`type` = 'ComponentText' ) ) [0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `tabs` [0m


Processing Company::TabsController#create (for 0.0.0.0 at 2011-04-22 14:43:32) [POST]
  Parameters: {"tab"=>{"title"=>"Aba 1"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Create (0.3ms)[0m   [0;1mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:43:32', 'Aba 1', '2011-04-22 17:43:32', NULL, 1)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 11ms (View: 1, DB: 4) | 200 OK [http://test.host/company/tabs/create?tab%5Btitle%5D=Aba+1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mTab Load (0.1ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:32) [POST]
  Parameters: {"id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", order: 1.0>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTab Load (0.1ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 1) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 9ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tabs/destroy/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mTab Load (0.1ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2) [0m
  [4;35;1mTab Load (0.1ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabsController#reorder (for 0.0.0.0 at 2011-04-22 14:43:32) [POST]
  Parameters: {"tab_ids"=>[#<Tab id: 2, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", order: 2.0>, #<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", order: 1.0>]}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 2) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Update (0.3ms)[0m   [0;1mUPDATE `tabs` SET `updated_at` = '2011-04-22 17:43:32', `order` = 1.0 WHERE `id` = 2[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mTab Load (0.4ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 1) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Update (0.3ms)[0m   [0;1mUPDATE `tabs` SET `updated_at` = '2011-04-22 17:43:32', `order` = 2.0 WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 124ms (View: 0, DB: 6) | 200 OK [http://test.host/company/tabs/reorder?tab_ids%5B%5D=2&tab_ids%5B%5D=1]
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2) [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#edit (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (2.7ms)
Rendered company/accounts/_password (3.3ms)
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 27ms (View: 18, DB: 4) | 200 OK [http://test.host/company/users/edit]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"user"=>{"login"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL AND `users`.id <> 12) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx2@emp.com' AND `users`.id <> 12) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (1.3ms)
Rendered company/accounts/_password (1.6ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 25ms (View: 18, DB: 3) | 200 OK [http://test.host/company/users/update?user%5Blogin%5D=]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update_profile_logo (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"company"=>{}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20006' AND `companies`.id <> 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
Rendered company/accounts/_form (1.1ms)
Rendered company/accounts/_password (1.4ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 22ms (View: 13, DB: 4) | 200 OK [http://test.host/company/users/update_profile_logo?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update (for 0.0.0.0 at 2011-04-22 14:43:32) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 12) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx2@emp.com' AND `users`.id <> 12) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:32', `login` = 'quentin2' WHERE `id` = 12[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (1.2ms)
Rendered company/accounts/_password (1.4ms)
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 22ms (View: 13, DB: 4) | 200 OK [http://test.host/company/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.5ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUserAdministrator Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mCompany Load (0.8ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_to_z (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyS Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) AND ( (`companies`.`type` = 'CompanyS' ) ) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
Rendering template within layouts/new_admin
Rendering company_management/change_to_z
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 27ms (View: 17, DB: 10) | 200 OK [http://test.host/company_management/change_to_z/4-MyString]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing CompanyManagementController#change_type_to_s (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyZ Update (0.3ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:43:33', `type` = 'CompanyS' WHERE `id` = 7[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:33', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_s\nargs: \n- LOAD;CompanyZ;7\n', '2011-04-22 17:43:33', 0, '2011-04-22 17:43:33', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.6ms)
Rendered companies/_company_show (7.0ms)
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (120.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 152ms (View: 140, DB: 6) | 200 OK [http://test.host/company_management/change_type_to_s/7-MyString]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"company"=>{"register_number"=>"TESTESTESTES"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;36;1mCompanyS Update (0.4ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:43:33', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:33', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:43:33', 0, '2011-04-22 17:43:33', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (5.9ms)
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUserWebAdministrator Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (8.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 52ms (View: 21, DB: 13) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bregister_number%5D=TESTESTESTES]
  [4;35;1mSQL (1.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"company"=>{"parcel"=>1, "register_number"=>"TESTESTESTES", "value"=>50.0}, "person"=>{"cpf"=>"099.033.907-69"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.4ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:43:33', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:33', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:43:33', 0, '2011-04-22 17:43:33', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(1, '2011-04-22 17:43:33', '2011-04-22 17:43:29', '2011-04-22 17:43:33', 50.0, 4, '2012-04-22 17:43:29', 'Aberto')[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:33', `cpf` = '099.033.907-69' WHERE `id` = 9[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.5ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (6.5ms)
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (6.2ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 49ms (View: 18, DB: 13) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bparcel%5D=1&company%5Bregister_number%5D=TESTESTESTES&company%5Bvalue%5D=50.0&person%5Bcpf%5D=099.033.907-69]
  [4;35;1mSQL (1.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 23ms (View: 17, DB: 5) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IN (12,7,8,5)) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5) [0m
  [4;36;1mContract Load (0.6ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 39ms (View: 26, DB: 10) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 16ms (View: 9, DB: 4) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>"8"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '8') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` WHERE (`companies`.`id` = 5) [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/8]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>"XXX"}
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 'XXX') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/company_management
Completed in 3ms (DB: 1) | 302 Found [http://test.host/company_management/loggin_as_company/XXX]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 5ms (DB: 3) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>"5"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 6ms (DB: 3) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggout_as_company (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Redirected to http://test.host/
Completed in 1ms (DB: 1) | 302 Found [http://test.host/company_management/loggout_as_company]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#edit (for 0.0.0.0 at 2011-04-22 14:43:33) [PUT]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering company_management/edit
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered companies/_company_edit (3.9ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 14, DB: 2) | 200 OK [http://test.host/company_management/edit/5-MyString]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#update (for 0.0.0.0 at 2011-04-22 14:43:33) [PUT]
  Parameters: {"company"=>{}, "id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management/show/5-MyString
Completed in 8ms (DB: 2) | 302 Found [http://test.host/company_management/update/5-MyString?]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.2ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 3 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 3) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.2ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:43:33', 0, 3, '2011-04-22 17:43:33')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (177.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing CompanySellerController#create (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"company"=>{"person_id"=>1}, "id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:33', `user_web_adm_id` = NULL WHERE `id` = 7[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20004' AND `companies`.id <> 3) LIMIT 1[0m
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.4ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:43:33', `person_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 26ms (DB: 191) | 302 Found [http://test.host/company_seller/create/3?company%5Bperson_id%5D=1]
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing CompanySellerController#destroy (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompanyZ Update (0.3ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:43:33', `person_id` = NULL WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 8ms (DB: 4) | 302 Found [http://test.host/company_seller/destroy/5-MyString]
  [4;35;1mCompanyZ Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mUserSegmentManager Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering company_seller/new
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 19ms (View: 11, DB: 6) | 200 OK [http://test.host/company_seller/new/3]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:43:33) [GET]
  Parameters: {"id"=>"XXXXX"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 0) [0m
Redirected to http://test.host/company_management
Completed in 2ms (DB: 1) | 302 Found [http://test.host/company_seller/new/XXXXX]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ773932') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:43:33', NULL, '2011-04-22 17:43:33', '76.633.274/0001-80', NULL, NULL, NULL, 'CompanyS', 'SZ773932', NULL, 'MyString', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 14) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.4ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('MyString', NULL, NULL, '2011-04-22 17:43:33', NULL, NULL, '2011-04-22 17:43:33', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 14, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.4ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 10) LIMIT 1[0m
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 10, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:33', `name` = 'MyString', `created_at` = '2011-04-22 17:43:33', `company_id` = 14 WHERE `id` = 10[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 10, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.4ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:43:33', `layout_id` = NULL WHERE `id` = 980190973[0m
  [4;36;1mFeedItem Create (0.2ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:33', 0, '2011-04-22 17:43:33', 0, 1, 14, 'Company')[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:33', '2011-04-22 17:43:33', 14, 12)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 14) [0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:43:33' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.5ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:43:33' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:43:27' and our_number is not null)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyToFriendController#create (for 0.0.0.0 at 2011-04-22 14:43:34) [GET]
  Parameters: {"email_from"=>"bruno_sil@yahoo.com.br", "company_id"=>"5", "name_from"=>"Bruno Siqueira", "email_to"=>"bsiqueira@gmail.com"}
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:34', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_new_send_to_friend\nargs: \n- bsiqueira@gmail.com\n- LOAD;CompanyZ;5\n', '2011-04-22 17:43:34', 0, '2011-04-22 17:43:34', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:34', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 15ms (View: 0, DB: 17) | 200 OK [http://test.host/company_to_friend?company_id=5&email_from=bruno_sil%40yahoo.com.br&email_to=bsiqueira%40gmail.com&name_from=Bruno+Siqueira]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Assigning #<File:test/resources/images/rails.png> to photo
[paperclip] Writing attributes for photo
[paperclip] Post-processing photo
  [4;36;1mComponentGallery Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:43:34', NULL, NULL, NULL, '2011-04-22 17:43:34', 1, 0, NULL, 1, 'ComponentGallery', NULL, 1, NULL, 1, NULL, 2, 1)[0m
  [4;35;1mPicture Create (0.5ms)[0m   [0mINSERT INTO `pictures` (`created_at`, `photo_file_size`, `title`, `updated_at`, `photo_file_name`, `photo_content_type`, `description`, `component_id`, `component_type`) VALUES('2011-04-22 17:43:34', 6646, NULL, '2011-04-22 17:43:34', 'rails.png', 'image/png', NULL, 13, 'Component')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/4/big/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/4/original/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/4/normal/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/4/thumb/rails.png
  [4;36;1mCompany Load (1.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mSQL (37.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:34', `font_colors` = '0x00000a;0x333333' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:43:34', `description` = ' bruno sqiueira COLOR=\"#000000\" oiasjdosadijoasidjasoij COLOR=\"#333333\" COLOR=\"#00000a\" ' WHERE `id` = 5[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mComponentPicture Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:43:34', `title` = 'ola' WHERE `id` = 7[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for picture
[paperclip] Deleting files for picture
[paperclip] Writing files for picture
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mContract Load Including Associations (0.7ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:43:34' and end_date>='2011-04-22 14:43:34') [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:43:34) [POST]
  Parameters: {"contract"=>{"parcel"=>12, "initial_date"=>"2008-02-12", "value"=>50.0, "status"=>"Aberto", "end_date"=>"2009-02-12"}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:43:34', '2008-02-12', '2011-04-22 17:43:34', 50.0, 4, '2009-02-12', 'Aberto')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/11
Completed in 14ms (DB: 55) | 302 Found [http://test.host/companies/4-MyString/contracts?contract%5Bend_date%5D=2009-02-12&contract%5Binitial_date%5D=2008-02-12&contract%5Bparcel%5D=12&contract%5Bstatus%5D=Aberto&contract%5Bvalue%5D=50.0]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m


Processing ContractsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:34) [DELETE]
  Parameters: {"id"=>#<Contract id: 4, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 4[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts
Completed in 11ms (DB: 5) | 302 Found [http://test.host/companies/4-MyString/contracts/4]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#edit (for 0.0.0.0 at 2011-04-22 14:43:34) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/edit
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 31ms (View: 27, DB: 4) | 200 OK [http://test.host/companies/4-MyString/contracts/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#index (for 0.0.0.0 at 2011-04-22 14:43:34) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/index
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 16, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts]
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#new (for 0.0.0.0 at 2011-04-22 14:43:34) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 26ms (View: 23, DB: 2) | 200 OK [http://test.host/companies/4-MyString/contracts/new]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:43:34) [POST]
  Parameters: {"contract"=>{}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 180ms (View: 30, DB: 4) | 200 OK [http://test.host/companies/4-MyString/contracts?]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#show (for 0.0.0.0 at 2011-04-22 14:43:34) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/show
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (titles.status<>'Liquidado')) [0m
Rendered titles/_title (0.9ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (`titles`.`status` = 'Liquidado')) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 19, DB: 4) | 200 OK [http://test.host/companies/4-MyString/contracts/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#update (for 0.0.0.0 at 2011-04-22 14:43:35) [PUT]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", value: 50.0, parcel: 12>, "contract"=>{}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/1
Completed in 7ms (DB: 3) | 302 Found [http://test.host/companies/4-MyString/contracts/1?]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing DomainsController#update (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"id"=>"8", "value"=>"empresa.com.br"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:35', `domain` = 'empresa.com.br' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 14ms (View: 0, DB: 3) | 200 OK [http://test.host/domains/update/8?value=empresa.com.br]
  [4;35;1mUserCompany Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (2.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mFeedItem Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mFeedLike Load (0.3ms)[0m   [0;1mSELECT `feed_likes`.id FROM `feed_likes` WHERE (`feed_likes`.`company_id` = 7 AND `feed_likes`.feed_item_id = 1) LIMIT 1[0m
  [4;35;1mFeedLike Create (0.2ms)[0m   [0mINSERT INTO `feed_likes` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:35', '2011-04-22 17:43:35', 7, 1)[0m
  [4;36;1mFeedItem Load (0.3ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mFeedItem Update (0.3ms)[0m   [0mUPDATE `feed_items` SET `feed_likes_count` = COALESCE(`feed_likes_count`, 0) + 1 WHERE (`id` = 1) [0m
  [4;36;1mFeedItem Update (0.2ms)[0m   [0;1mUPDATE `feed_items` SET `updated_at` = '2011-04-22 17:43:35' WHERE `id` = 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;36;1mSQL (105.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:43:35' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.6ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:43:35' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 29ms (View: 16, DB: 115) | 200 OK [http://test.host/financial/company_no_active_contracts]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"id"=>[]}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:43:35' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompanyZ Load Including Associations (0.6ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:43:35' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 8, DB: 3) | 200 OK [http://test.host/financial/company_no_active_contracts/index/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load (0.8ms)[0m   [0;1mSELECT distinct companies.* as companies FROM `companies` join titles as titles on titles.company_id = companies.id WHERE (titles.status <> 'Liquidado' and titles.due_date < '2011-04-22 14:43:35' and your_number is not null) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/index
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 25ms (View: 13, DB: 4) | 200 OK [http://test.host/financial/company_not_payed]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Financial::CompanyNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT `contracts`.* FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/show
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.4ms)
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:43:27' and our_number is not null)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 138ms (View: 17, DB: 5) | 200 OK [http://test.host/financial/company_not_payed/show/7-MyString]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"month"=>"4"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mContract Load Including Associations (0.8ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:43:35' and end_date>='2011-04-22 14:43:35') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-05-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:43:35', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:43:35', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-05-22 00:00:00', 0.2, '2011-04-22 14:43:35', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 26ms (View: 8, DB: 4) | 200 OK [http://test.host/financial/main/generate_new_titles?month=4]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"month"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mContract Load Including Associations (0.5ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-03-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:43:35' and end_date>='2011-04-22 14:43:35') [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-04-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:43:35', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:43:35', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-04-22 00:00:00', 0.2, '2011-04-22 14:43:35', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 8, DB: 5) | 200 OK [http://test.host/financial/main/generate_new_titles?month=3]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:43:35) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COB01.TXT>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`due_date` = '2009-05-13' AND `titles`.`your_number` = '22a33336') LIMIT 1[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`due_date` = '2009-05-15' AND `titles`.`your_number` = '22a33333') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`due_date` = '2009-05-02' AND `titles`.`your_number` = '22a33335') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`due_date` = '2009-05-07' AND `titles`.`your_number` = '22a33310') LIMIT 1[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`due_date` = '2009-05-08' AND `titles`.`your_number` = '22a33337') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`due_date` = '2009-03-20' AND `titles`.`your_number` = '827495320r') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 25ms (View: 10, DB: 5) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x1064af748%3E]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:43:35) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COBERROR.TXT>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 8, DB: 1) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x106375a30%3E]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#new (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 10, DB: 1) | 200 OK [http://test.host/financial/receive_return/new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::SendShippingController#index (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`status` = 'Aberto') [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/index
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 2)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 14, DB: 3) | 200 OK [http://test.host/financial/send_shipping]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#create (for 0.0.0.0 at 2011-04-22 14:43:35) [PUT]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`processing_date` = '2011-04-22 14:43:35' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;36;1mShipping Update (0.3ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:43:35', `processing_date` = '2011-04-22 14:43:35' WHERE `id` = 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.2ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mUserDirector Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUserDirector Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
  [4;35;1mUserAdministrator Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
Sent mail to quentin@example.com, quentin@example.com

Date: Fri, 22 Apr 2011 14:43:35 -0300
From: bsiqueira@suaempreza.com.br
To: quentin@example.com,
	 quentin@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D=3A_Gera=C3=A7=C3=A3o_de_Cobran=C3=A7a?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1>Envio de Remessa</h1>
<p>
  C√≥digo da Remessa: MyString
</p>

<p>
  Quantidade de T√≠tulos: 2
</p>

<p>
  Valor da Remessa: 3,00
</p>

<p>
  Voc√™ pode realizar o download do arquivo remessa no endere√ßo:<br>
  <a href="http://localhost:3000/financial/shippings/1">http://localhost:3000/financial/shippings/1</a>
</p>
<small>
  O envio da remessa para o banco deve ser realizado ainda na data corrente.
</small>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Enviado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Enviado' WHERE `id` = 3[0m
  [4;36;1mShipping Update (0.4ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:43:35', `file_name` = 'MyString_2204111443.txt', `file_content_type` = 'text/plain', `file_data` = x'303152454d455353413031434f4252414e434120202020202020303033343330353733393639342020202020202043c3a96c756c61204950202020202020202020202020202020202020202033353642616e636f205265616c20202020203232303431313031363030425049202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030310a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030382020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030320a383130303334333035373339363934323175303030382020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030330a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030372020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030340a383130303334333035373339363934323175303030372020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030350a393030303030323030303030303030303033303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030360a' WHERE `id` = 1[0m
  [4;35;1mShipping Update (0.2ms)[0m   [0mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Enviado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 50ms (View: 8, DB: 10) | 200 OK [http://test.host/financial/send_shipping/create/1]
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.1ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#show (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 131ms (View: 127, DB: 4) | 200 OK [http://test.host/financial/send_shipping/show/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.5ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.3ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:43:35', '2011-04-22 17:43:35', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.3ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:43:35', '2011-04-22 17:43:35', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.`id` = 964567534) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.1ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mTitle Update (0.2ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Digitado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Destroy (0.1ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567534[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m


Processing Financial::ShippingsController#create (for 0.0.0.0 at 2011-04-22 14:43:35) [POST]
  Parameters: {"shipping"=>{}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` IS NULL) LIMIT 1[0m
  [4;35;1mShipping Create (0.3ms)[0m   [0mINSERT INTO `shippings` (`created_at`, `code`, `updated_at`, `file_content_type`, `file_data`, `file_name`, `processing_date`, `status`) VALUES('2011-04-22 17:43:35', NULL, '2011-04-22 17:43:35', NULL, NULL, NULL, NULL, 'Aberto')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/5
Completed in 9ms (DB: 15) | 302 Found [http://test.host/financial/remessas?]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:35) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE (our_number is not null) AND ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mShippingTitle Destroy (0.4ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mShipping Destroy (0.3ms)[0m   [0mDELETE FROM `shippings` WHERE `id` = 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas
Completed in 17ms (DB: 7) | 302 Found [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#edit (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/edit
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
Rendered titles/_titles (10.2ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 26ms (View: 18, DB: 7) | 200 OK [http://test.host/financial/remessas/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#index (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/index
Rendered financial/shippings/_download (0.3ms)
Rendered financial/shippings/_download (0.1ms)
Rendered financial/shippings/_download (1.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 16, DB: 2) | 200 OK [http://test.host/financial/remessas]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#new (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/shippings/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 11, DB: 2) | 200 OK [http://test.host/financial/remessas/new]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#show (for 0.0.0.0 at 2011-04-22 14:43:35) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendered financial/shippings/_download (0.1ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((titles.status<>'Liquidado'))) [0m
Rendered titles/_title (0.6ms)
Rendered titles/_title (0.4ms)
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((`titles`.`status` = 'Liquidado'))) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 16, DB: 4) | 200 OK [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.1ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#update (for 0.0.0.0 at 2011-04-22 14:43:35) [PUT]
  Parameters: {"shipping"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/1
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.2ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:35', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 13ms (DB: 4) | 302 Found [http://test.host/financial/remessas/1?]
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:43:35) [POST]
  Parameters: {"title"=>{"your_number"=>"SZ20002", "discount_type"=>"Sem desconto", "value"=>450.0, "due_date"=>"2009-05-05", "emission_date"=>"2009-05-01", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'SZ20002') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(NULL, '2011-04-22 17:43:36', 'SZ20002', NULL, NULL, NULL, '2011-04-22 17:43:36', 'Sem desconto', NULL, NULL, NULL, 450.0, NULL, 5, '2009-05-05', NULL, '2009-05-01', NULL, NULL, NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/17
Completed in 137ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bvalue%5D=450.0&title%5Byour_number%5D=SZ20002]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:43:36) [POST]
  Parameters: {"title"=>{"fine_percent"=>"33,33", "your_number"=>"AZ924330", "abatement_value"=>"", "interest_type"=>"0", "discount_type"=>"Sem desconto", "value"=>"323,33", "due_date"=>"2009-05-05", "interest_percent"=>"0,50", "emission_date"=>"2009-05-01", "discount_value"=>"", "additional_data"=>"cdcscscsscdssd", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'AZ924330') LIMIT 1[0m
  [4;36;1mTitle Create (0.4ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(33.33, '2011-04-22 17:43:36', 'AZ924330', NULL, NULL, 0.0, '2011-04-22 17:43:36', 'Sem desconto', '0', NULL, NULL, 323.33, NULL, 5, '2009-05-05', 0.5, '2009-05-01', 0.0, 'cdcscscsscdssd', NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/18
Completed in 13ms (DB: 6) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Babatement_value%5D=&title%5Badditional_data%5D=cdcscscsscdssd&title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdiscount_value%5D=&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bfine_percent%5D=33%2C33&title%5Binterest_percent%5D=0%2C50&title%5Binterest_type%5D=0&title%5Bvalue%5D=323%2C33&title%5Byour_number%5D=AZ924330]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 18) [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#destroy (for 0.0.0.0 at 2011-04-22 14:43:36) [DELETE]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles
Completed in 9ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#edit (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/edit
  [4;35;1mContract Load (0.6ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 42ms (View: 36, DB: 6) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#index (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.6ms)[0m   [0;1mSELECT * FROM `titles` ORDER BY due_date desc LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 44ms (View: 39, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::TitlesController#index_new (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering financial/titles/index_new
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 14, DB: 5) | 200 OK [http://test.host/financial/titles/index_new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#new (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/new
  [4;36;1mContract Load (0.7ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 38ms (View: 34, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#show (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 12, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#update (for 0.0.0.0 at 2011-04-22 14:43:36) [PUT]
  Parameters: {"title"=>{}, "id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-02-15' AND `titles`.your_number = '21u0005' AND `titles`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/1
Completed in 10ms (DB: 4) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTitle Load (0.6ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) ORDER BY created_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering financial/titles_not_payed/index
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 25ms (View: 15, DB: 3) | 200 OK [http://test.host/titulos-nao-pagos?company_id=5-MyString]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
Rendering financial/titles_not_payed/show
Completed in 22ms (View: 12, DB: 4) | 200 OK [http://test.host/financial/titles_not_payed/show/1?company_id=5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:36', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (2.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1 AND (components.id is not null)) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 3ms (DB: 7) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
Redirected to http://test.host/empresa-inicio
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 1ms (DB: 1) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
Rendering template within layouts/main
Rendering main/index
  [4;36;1mLayout Load IDs For Limited Eager Loading (0.7ms)[0m   [0;1mSELECT DISTINCT `layouts`.id FROM `layouts` LEFT OUTER JOIN `companies` ON `companies`.id = `layouts`.company_id WHERE (companies.type = 'CompanyZ' and companies.id in (176,173,207,213,206,47,178,28,182)) ORDER BY layouts.updated_at LIMIT 8[0m
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (1.3ms)
Completed in 20ms (View: 14, DB: 1) | 200 OK [http://test.host/]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 2ms (DB: 1) | 302 Found [http://test.host/main/natal]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
Rendering template within layouts/main
Rendering main/natal
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.8ms)
Completed in 8ms (View: 7, DB: 1) | 200 OK [http://test.host/main/natal]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.1ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m
  [4;35;1mMessageCopy Load (0.2ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.1ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m


Processing MessagesController#create (for 0.0.0.0 at 2011-04-22 14:43:36) [POST]
  Parameters: {"message"=>{"sender_email"=>"tester@gmail.com", "body"=>"Corpo da mensagem", "subject"=>"Teste - Mensagem enviada do business card", "to"=>"8"}}
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.2ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES('tester@gmail.com', '2011-04-22 17:43:36', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:43:36', 'Teste - Mensagem enviada do business card', NULL, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.1ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 8) [0m
  [4;35;1mMessageCopy Create (0.1ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:43:36', NULL, 8, NULL, NULL, 8)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:36', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;7\n', '2011-04-22 17:43:36', 0, '2011-04-22 17:43:36', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:36', 0, '2011-04-22 17:43:36', 0, 0, 8, 'Message')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:36', '2011-04-22 17:43:36', 5, 13)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 140ms (View: 0, DB: 9) | 200 OK [http://test.host/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender_email%5D=tester%40gmail.com&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+business+card&message%5Bto%5D=8]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m


Processing PasswordsController#new (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
Rendering template within layouts/e-mail
Rendering passwords/new
Completed in 7ms (View: 2, DB: 2) | 200 OK [http://test.host/esqueci-a-senha]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (20.4ms)
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mState Load (0.5ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (6.4ms)
Rendered companies/_company (13.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 67ms (View: 48, DB: 9) | 200 OK [http://test.host/people_confirm/edit/9]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"id"=>"13"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (16.7ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 31ms (View: 26, DB: 3) | 200 OK [http://test.host/people_confirm/edit/13]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:43:36) [GET]
  Parameters: {"id"=>"7"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:36', `user_create_id` = 6, `user_web_adm_id` = 6 WHERE `id` = 7[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
Sent mail to emp@emp.com

Date: Fri, 22 Apr 2011 14:43:36 -0300
From: bsiqueira@suaempreza.com.br
To: emp@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (5.0ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.9ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 172ms (View: 147, DB: 12) | 200 OK [http://test.host/people_confirm/create/7]
  [4;35;1mSQL (169.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 14, DB: 174) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 14ms (View: 9, DB: 3) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.8ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 22ms (View: 17, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 18ms (View: 11, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mPerson Update (0.2ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:37', `user_confirm_id` = 4 WHERE `id` = 9[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Sent mail to empconf222@emp.com

Date: Fri, 22 Apr 2011 14:43:37 -0300
From: bsiqueira@suaempreza.com.br
To: empconf222@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa_first_confirm!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.7ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (5.2ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
Completed in 48ms (View: 23, DB: 12) | 200 OK [http://test.host/people_confirm/create/9]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.8ms)
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.1ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (5.5ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 36ms (View: 24, DB: 11) | 200 OK [http://test.host/people_confirm/create/9]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#destroy (for 0.0.0.0 at 2011-04-22 14:43:37) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.3ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.3ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people_confirm
Completed in 8ms (DB: 4) | 302 Found [http://test.host/people_confirm/destroy/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#show (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  Parameters: {"id"=>"9"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (5.5ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (7.0ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 158ms (View: 149, DB: 9) | 200 OK [http://test.host/people_confirm/show/9]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 1) [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:43:37) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", enabled: true>, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "state"=>#<State id: 1, acronym: "AC", name: "Acre", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29">, "rg_exp"=>"MyString"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:37', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:43:37', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, 1, 'MyString', 'MyString', NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/30
Completed in 14ms (DB: 3) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate%5D=1&person%5Bsubsidiary_id%5D=1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:43:37) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:37', 6, '356.726.002-20', '2008-09-09', '2011-04-22 17:43:37', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 6)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/31
Completed in 11ms (DB: 5) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleController#destroy (for 0.0.0.0 at 2011-04-22 14:43:37) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.4ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.4ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people
Completed in 10ms (DB: 6) | 302 Found [http://test.host/people/13]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/edit
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.4ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Person') [0m
Rendered person_phone/_phones (5.1ms)
Rendered people/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 42ms (View: 36, DB: 7) | 200 OK [http://test.host/people/1/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#index (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` as people left join user_people as up on people.id = up.person_id left join users as u on up.user_id = u.id and u.type <>'UserCompany' WHERE (user_confirm_id is not null ) ORDER BY people.name LIMIT 0, 30[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` IN (1,2,4)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people/index
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 11)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 2)) [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 196ms (View: 180, DB: 13) | 200 OK [http://test.host/people]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#new (for 0.0.0.0 at 2011-04-22 14:43:37) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people/new
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (16.0ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 37ms (View: 31, DB: 5) | 200 OK [http://test.host/people/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#show (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/show
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (6.0ms)
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 14, DB: 3) | 200 OK [http://test.host/people/1]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#update (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/1
Completed in 7ms (DB: 2) | 302 Found [http://test.host/people/1?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>""}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Completed in 10ms (View: 3, DB: 2) | 200 OK [http://test.host/person_phone/create/8?phone%5Bnumber%5D=]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>12345678, "ddd"=>17}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Create (0.3ms)[0m   [0mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(12345678, '2011-04-22 17:43:38', '2011-04-22 17:43:38', 17, NULL, NULL, 8, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered person_phone/_phone (2.5ms)
Completed in 8ms (View: 5, DB: 3) | 200 OK [http://test.host/person_phone/create/8?phone%5Bddd%5D=17&phone%5Bnumber%5D=12345678]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.1ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m


Processing PersonPhoneController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"id"=>"298486374"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPhone Load (0.1ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.2ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 298486374[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 3ms (View: 1, DB: 4) | 200 OK [http://test.host/person_phone/destroy/298486374]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (94.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mPicture Load (0.2ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.3ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:43:38', `title` = 'ola' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"email"=>"quentin@example.com"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (email='quentin@example.com' and activated_at is null) LIMIT 1[0m
Redirected to http://test.host/login
Completed in 5ms (DB: 100) | 302 Found [http://test.host/resend_activation_mail/create?email=quentin%40example.com]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"email"=>"gerente_geral@example.com"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (email='gerente_geral@example.com' and activated_at is null) LIMIT 1[0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:43:38 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 5ms (DB: 1) | 302 Found [http://test.host/resend_activation_mail/create?email=gerente_geral%40example.com]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ResendActivationMailController#new (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
Rendering template within layouts/e-mail
Rendering resend_activation_mail/new
Completed in 3ms (View: 3, DB: 0) | 200 OK [http://test.host/resend_activation_mail/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 8ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:38', `remember_token_expires_at` = '2011-05-06 17:43:38', `remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:38', `remember_token_expires_at` = '2011-05-06 17:43:38', `remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.5ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:38', `remember_token_expires_at` = '2011-04-22 17:38:38' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 5) | 302 Found [http://test.host/logout]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22') LIMIT 1[0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"password"=>"bad password", "login"=>"quentin"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
Redirected to http://test.host/
Completed in 2ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin&password=bad+password]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"password"=>"test", "login"=>"empresa"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'empresa' or email = 'empresa') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
Redirected to http://test.host/
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa&password=test]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"password"=>"test", "login"=>"quentin"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"password"=>"test", "login"=>"empresa_valid"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'empresa_valid' or email = 'empresa_valid') LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Redirected to http://test.host/empresa-inicio
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa_valid&password=test]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:38', `remember_token_expires_at` = '2011-05-06 17:43:38', `remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#new (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:not_logged_in_required] rendered_or_redirected.
Completed in 2ms (DB: 1) | 302 Found [http://test.host/sessao/new]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"password"=>"test", "login"=>"quentin@example.com"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin@example.com' or email = 'quentin@example.com') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin%40example.com&password=test]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 4ms (DB: 1) | 302 Found [http://test.host/logout]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"remember_me"=>"0", "password"=>"test", "login"=>"quentin"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=0]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"remember_me"=>"1", "password"=>"test", "login"=>"quentin"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:38', `remember_token_expires_at` = '2011-05-06 17:43:38', `remember_token` = '6f380ae33f3cb5ba743f6b80ba7edb68dfabfc22' WHERE `id` = 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:38', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 18ms (DB: 4) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=1]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.1ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", enabled: true>, "state"=>#<State id: 21, acronym: "RS", name: "Rio Grande do Sul", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29">}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m
  [4;35;1mState Load (0.2ms)[0m   [0mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 21) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Create (0.3ms)[0m   [0mINSERT INTO `subsidiary_states` (`created_at`, `updated_at`, `subsidiary_id`, `state_id`) VALUES('2011-04-22 17:43:38', '2011-04-22 17:43:38', 1, 21)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 33ms (View: 18, DB: 7) | 200 OK [http://test.host/subsidiaries/change_range/1?state=21]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m


Processing SubsidiariesController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"subsidiary"=>{"title"=>"teste"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'teste') LIMIT 1[0m
  [4;35;1mSubsidiary Create (0.3ms)[0m   [0mINSERT INTO `subsidiaries` (`created_at`, `title`, `updated_at`, `enabled`) VALUES('2011-04-22 17:43:38', 'teste', '2011-04-22 17:43:38', 1)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/6
Completed in 5ms (DB: 3) | 302 Found [http://test.host/filiais?subsidiary%5Btitle%5D=teste]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m


Processing SubsidiariesController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [DELETE]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` WHERE (`people`.subsidiary_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Load (0.2ms)[0m   [0mSELECT * FROM `subsidiary_states` WHERE (`subsidiary_states`.subsidiary_id = 3) [0m
  [4;36;1mSubsidiary Destroy (0.1ms)[0m   [0;1mDELETE FROM `subsidiaries` WHERE `id` = 3[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais
Completed in 5ms (DB: 3) | 302 Found [http://test.host/filiais/3]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#edit (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit
Rendered subsidiaries/_form (2.5ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 11, DB: 3) | 200 OK [http://test.host/filiais/1/editar]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#index (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/index
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 17, DB: 2) | 200 OK [http://test.host/filiais]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#new (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/new
Rendered subsidiaries/_form (2.1ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 10, DB: 1) | 200 OK [http://test.host/filiais/nova]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", enabled: true>, "state"=>#<State id: 19, acronym: "RJ", name: "Rio de Janeiro", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29">}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mState Load (0.2ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 19) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiaryState Delete all (0.3ms)[0m   [0;1mDELETE FROM `subsidiary_states` WHERE (`subsidiary_states`.`subsidiary_id` = 1 AND `subsidiary_states`.`state_id` = 19) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;35;1mState Load (0.5ms)[0m   [0mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 149ms (View: 16, DB: 5) | 200 OK [http://test.host/subsidiaries/change_range/1?state=19]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#show (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/show
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 3) | 200 OK [http://test.host/filiais/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#update (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"subsidiary"=>{"title"=>"123"}, "id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY '123' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSubsidiary Update (0.3ms)[0m   [0;1mUPDATE `subsidiaries` SET `updated_at` = '2011-04-22 17:43:38', `title` = '123' WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/1
Completed in 6ms (DB: 3) | 302 Found [http://test.host/filiais/1?subsidiary%5Btitle%5D=123]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m


Processing TemplateTextsController#create (for 0.0.0.0 at 2011-04-22 14:43:38) [POST]
  Parameters: {"template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Create (0.4ms)[0m   [0;1mINSERT INTO `template_texts` (`created_at`, `title`, `updated_at`, `content`) VALUES('2011-04-22 17:43:38', 'dadsas', '2011-04-22 17:43:38', 'fsdcsd')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190964
Completed in 11ms (DB: 3) | 302 Found [http://test.host/template_texts?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#destroy (for 0.0.0.0 at 2011-04-22 14:43:38) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTemplateText Destroy (0.2ms)[0m   [0mDELETE FROM `template_texts` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts
Completed in 4ms (DB: 4) | 302 Found [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#edit (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/edit
Rendered template_texts/_form (2.5ms)
Rendered template_texts/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 14ms (View: 12, DB: 3) | 200 OK [http://test.host/template_texts/980190962/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#index (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` [0m
Rendering template within layouts/new_admin
Rendering template_texts/index
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 15ms (View: 12, DB: 2) | 200 OK [http://test.host/template_texts]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#new (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering template_texts/new
Rendered template_texts/_form (1.8ms)
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 2) | 200 OK [http://test.host/template_texts/new]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#show (for 0.0.0.0 at 2011-04-22 14:43:38) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/show
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 3) | 200 OK [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#update (for 0.0.0.0 at 2011-04-22 14:43:38) [PUT]
  Parameters: {"id"=>"980190962", "template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Update (0.2ms)[0m   [0;1mUPDATE `template_texts` SET `content` = 'fsdcsd', `updated_at` = '2011-04-22 17:43:38', `title` = 'dadsas' WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190962
Completed in 5ms (DB: 2) | 302 Found [http://test.host/template_texts/980190962?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 6) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:38', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 11) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1 and people.user_web_adm_id = 6) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 15) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 16) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.8ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUserCompany Load Including Associations (0.7ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.5ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5, 7, 8, 12) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUserCompany Load IDs For Limited Eager Loading (0.4ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUserCompany Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) AND `users`.id IN (6, 1) ORDER BY login[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `domain` = 'empresa.com' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (176.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` WHERE (`people`.user_web_adm_id = 6 AND (not exists (select up.* from user_people as up where people.id = up.person_id))) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9c642bd9a09a7daaa336a836ffcc15c1aee014ca', '2011-04-22 17:43:39', NULL, NULL, NULL, '9fa86aa882dc1a68bf8460f2cc438101d3f782ac', NULL, '2011-04-22 17:43:39', NULL, 'c3400a76c95986a71013266f286790e54ac755fb', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.1ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 30, NULL)[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:39', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;30\n', '2011-04-22 17:43:39', 0, '2011-04-22 17:43:39', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9c642bd9a09a7daaa336a836ffcc15c1aee014ca', '2011-04-22 17:43:39', NULL, NULL, NULL, '9fa86aa882dc1a68bf8460f2cc438101d3f782ac', NULL, '2011-04-22 17:43:39', NULL, '3a81f328dc56c780d04f213f99f98bdafefa7eb5', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 31, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:39', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;31\n', '2011-04-22 17:43:39', 0, '2011-04-22 17:43:39', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 31) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;36;1mUserPerson Destroy (0.5ms)[0m   [0;1mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mVote Update (0.4ms)[0m   [0;1mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;35;1mFeedLike Load (0.3ms)[0m   [0mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;35;1mFeed Load (0.3ms)[0m   [0mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;36;1mFeed Destroy (0.2ms)[0m   [0;1mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;35;1mNews Load (0.3ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.1ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:39', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.3ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.2ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:39', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:39', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;35;1mShippingTitle Destroy (0.1ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;35;1mShippingTitle Load (0.5ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:43:27' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.4ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mComponentText Destroy (0.4ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 5[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.4ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 6[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.4ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 7[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mPicture Load (0.4ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.4ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.4ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;35;1mComponentGallery Destroy (0.4ms)[0m   [0mDELETE FROM `components` WHERE `id` = 8[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;35;1mComponentForm Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 9[0m
  [4;36;1mComponentGallery Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mTab Destroy (0.3ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;35;1mColor Load (0.3ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;35;1mBackgroundTop Load (0.3ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;36;1mBackground Load (0.3ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.3ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mPhone Destroy (0.2ms)[0m   [0;1mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mAddress Destroy (0.1ms)[0m   [0;1mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;35;1mCompanyService Load (0.3ms)[0m   [0mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;36;1mCompanyRelationship Load (0.2ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.1ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Destroy (0.1ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.3ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.2ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;36;1mMessageCopy Destroy (0.2ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;35;1mMessage Destroy (0.2ms)[0m   [0mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;36;1mFolder Destroy (0.1ms)[0m   [0;1mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `login` = 'quentin2' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin2' or email = 'quentin2') LIMIT 1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `remember_token_expires_at` = '2011-05-06 17:43:39', `remember_token` = '72c1745fb49bbcbfd090db8c0c14022e6e7c16d3' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (2.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `remember_token_expires_at` = '2011-04-29 17:43:39', `remember_token` = 'a2d1ae336c227351392975fe4acc628bb8359b92' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `remember_token_expires_at` = '2011-04-29 17:43:39', `remember_token` = 'a2d1ae336c227351392975fe4acc628bb8359b92' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `crypted_password` = '4b6dd603c64f03bc2f676658e287094878df9603' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `remember_token_expires_at` = '2011-05-06 17:43:39', `remember_token` = '72c1745fb49bbcbfd090db8c0c14022e6e7c16d3' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `remember_token_expires_at` = '2011-05-06 17:43:39', `remember_token` = '72c1745fb49bbcbfd090db8c0c14022e6e7c16d3' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:39', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno com espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno_sem_espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno-sem-espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno12345434543comnumeros323') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'comcaract√©resespeciais') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing UsersController#create_page_2 (for 0.0.0.0 at 2011-04-22 14:43:40) [POST]
  Parameters: {"company"=>{"person_id"=>8}, "person"=>{"user_web_adm_id"=>#<UserWebAdministrator id: 6, login: "admin_web", email: "mg@mg2.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:43:29", updated_at: "2011-04-22 17:43:30", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:43:29", password_reset_code: nil, enabled: true, type: "UserWebAdministrator", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}, "id"=>"8"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:40', `user_web_adm_id` = 6 WHERE `id` = 10[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompanyZ Update (0.4ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:43:40', `person_id` = 8 WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 25ms (DB: 307) | 302 Found [http://test.host/users/create_page_2/8?company%5Bperson_id%5D=8&person%5Buser_web_adm_id%5D=6]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:40) [POST]
  Parameters: {"person"=>{"name"=>"gerente_geral", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:43:29 UTC 2011, "updated_at"=>Fri Apr 22 17:43:29 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"898.361.554-06", "id"=>4, "user_id"=>nil, "subsidiary_id"=>"1", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '898.361.554-06') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('7f50ce3c81c87f05bee561b00a3cec94e34360ce', '2011-04-22 17:43:40', NULL, NULL, NULL, '9da87a90e8c5059c8f97523743a1aab284e3b217', NULL, '2011-04-22 17:43:40', NULL, '0cee84084af6a2440ac3ee979483a627de613797', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 32, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:40', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;32\n', '2011-04-22 17:43:40', 0, '2011-04-22 17:43:40', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 32) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:40', '2011-04-22 17:43:40', 32, 4)[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 32) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 32 AND `user_people`.id <> 956136640) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 32)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 32) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 32) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:40', `user_id` = 32 WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '0cee84084af6a2440ac3ee979483a627de613797') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:40', `activated_at` = '2011-04-22 17:43:40' WHERE `id` = 32[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:40', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;32\n', '2011-04-22 17:43:40', 0, '2011-04-22 17:43:40', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (5.1ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.9ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 90ms (View: 37, DB: 16) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=898.361.554-06&person%5Bcreated_at%5D=Fri+Apr+22+17%3A43%3A29+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=4&person%5Bname%5D=gerente_geral&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=1&person%5Bupdated_at%5D=Fri+Apr+22+17%3A43%3A29+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 10) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:40) [POST]
  Parameters: {"person"=>{"name"=>"empresa_valid", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:43:29 UTC 2011, "updated_at"=>Fri Apr 22 17:43:29 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"573.683.830-39", "id"=>10, "user_id"=>nil, "subsidiary_id"=>"2", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '573.683.830-39') LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (145.1ms)
Rendered people/_person (145.8ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.9ms)
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 172ms (View: 161, DB: 7) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=573.683.830-39&person%5Bcreated_at%5D=Fri+Apr+22+17%3A43%3A29+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=10&person%5Bname%5D=empresa_valid&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=2&person%5Bupdated_at%5D=Fri+Apr+22+17%3A43%3A29+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  Parameters: {"id"=>#<UserCompany id: 8, login: "empresa_valid", email: "empconfxx@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:43:29", updated_at: "2011-04-22 17:43:30", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:43:29", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:40', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- empresa_valid\n- administrator\n', '2011-04-22 17:43:40', 0, '2011-04-22 17:43:40', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;36;1mFeed Load (0.3ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;35;1mFeed Destroy (0.3ms)[0m   [0mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;36;1mNews Load (0.3ms)[0m   [0;1mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.2ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;35;1mShippingTitle Load (0.4ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:40', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:40', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:43:40', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:43:27' and our_number is not null)) [0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.3ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;35;1mComponentText Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 5[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 6[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 7[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;35;1mPicture Load (0.3ms)[0m   [0mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.1ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.1ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;36;1mComponentGallery Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 8[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 9[0m
  [4;35;1mComponentGallery Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.3ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mTab Destroy (0.4ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;35;1mBanner Load (0.3ms)[0m   [0mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;36;1mBackgroundTop Load (0.3ms)[0m   [0;1mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;35;1mBackground Load (0.3ms)[0m   [0mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;35;1mLayout Destroy (0.3ms)[0m   [0mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mPhone Destroy (0.3ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.2ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;36;1mCompanyService Load (0.3ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;36;1mCompanyZ Destroy (0.3ms)[0m   [0;1mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;36;1mMessage Destroy (0.2ms)[0m   [0;1mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mMessageCopy Destroy (0.2ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;35;1mFolder Destroy (0.2ms)[0m   [0mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 222ms (DB: 32) | 302 Found [http://test.host/usuarios/8]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (2.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:43:29", updated_at: "2011-04-22 17:43:30", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:43:29", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Redirected to http://test.host/usuarios
Completed in 2ms (DB: 5) | 302 Found [http://test.host/usuarios/12]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:40', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- administrator\n', '2011-04-22 17:43:40', 0, '2011-04-22 17:43:40', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.1ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.1ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.1ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.1ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.2ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.3ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 14ms (DB: 5) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (30.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:43:29", updated_at: "2011-04-22 17:43:30", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:43:29", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:40', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- \"empres\\xC3\\xA3 _&valid_2\"\n- administrator\n', '2011-04-22 17:43:40', 0, '2011-04-22 17:43:40', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) [0m
  [4;35;1mUserPerson Destroy (0.1ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 956136629[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 12) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 7) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.3ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 7) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
  [4;36;1mFeed Load (0.3ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 7) [0m
  [4;35;1mNews Load (0.1ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 7) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 2[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.2ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 3[0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:43:27' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 1) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 956136629[0m
  [4;36;1mComponentText Destroy (0.3ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 1[0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 2) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 2[0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 3) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.1ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 997002036[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 3[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 4) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 208288675[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 4[0m
  [4;35;1mComponentGallery Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.3ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 3[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 4[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 2) LIMIT 1[0m
  [4;35;1mColor Destroy (0.3ms)[0m   [0mDELETE FROM `colors` WHERE `id` = 980190962[0m
  [4;36;1mBanner Load (0.4ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
  [4;35;1mBackgroundTop Load (0.3ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 2) [0m
  [4;36;1mBackground Load (0.3ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 2) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.3ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 2[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.2ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 7[0m
  [4;36;1mCompanyService Load (0.3ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 7) [0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 980190962[0m
  [4;36;1mCompanyService Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 298486374[0m
  [4;35;1mCompanyService Destroy (0.2ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 113629430[0m
  [4;36;1mCompanyService Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 281110143[0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 1018350795[0m
  [4;36;1mCompanyService Destroy (0.3ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 51848956[0m
  [4;35;1mCompanyService Destroy (0.2ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 374648174[0m
  [4;36;1mCompanyService Destroy (0.1ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 638205575[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.2ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 7) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.1ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.3ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 7[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 12 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 12 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 12) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 12) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mUserCompany Destroy (0.3ms)[0m   [0;1mDELETE FROM `users` WHERE `id` = 12[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 198ms (DB: 52) | 302 Found [http://test.host/usuarios/12]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (2.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:40', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- gerente_segmento\n', '2011-04-22 17:43:40', 0, '2011-04-22 17:43:40', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.1ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.1ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.3ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 15ms (DB: 8) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (16.2ms)
Rendered people/_person (16.6ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.2ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 33ms (View: 29, DB: 4) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (14.8ms)
Rendered people/_person (15.1ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 31ms (View: 27, DB: 3) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:43:40) [GET]
  Parameters: {"type"=>"UserCompany"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
  [4;36;1mSubsidiary Load (0.5ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (14.3ms)
Rendered people/_person (14.6ms)
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.5ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (5.1ms)
Rendered companies/_company (12.2ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (132.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 175ms (View: 168, DB: 5) | 200 OK [http://test.host/signup?type=UserCompany]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:41) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('89fce171ed344b97b3a4bdbec6123e46e4a58532', '2011-04-22 17:43:41', NULL, NULL, NULL, '98962e1eeed9e802f0b3d37c180d45855fe939c2', NULL, '2011-04-22 17:43:41', NULL, '37bce092c7bd946f28a571c14b1a377de5d4b22d', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 33, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:41', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;33\n', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 33) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 33) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:41', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:43:41', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 33) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.2ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:41', '2011-04-22 17:43:41', 33, 32)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 33) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 33 AND `user_people`.id <> 956136641) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 33)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 33) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 33) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 32)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=32) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 32)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 32)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 32)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 32)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:41', `user_id` = 33 WHERE `id` = 32[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '37bce092c7bd946f28a571c14b1a377de5d4b22d') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:41', `activated_at` = '2011-04-22 17:43:41' WHERE `id` = 33[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:41', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;33\n', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (2.7ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.7ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 80ms (View: 30, DB: 12) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 33) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (3.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:41) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('89fce171ed344b97b3a4bdbec6123e46e4a58532', '2011-04-22 17:43:41', NULL, NULL, NULL, '98962e1eeed9e802f0b3d37c180d45855fe939c2', NULL, '2011-04-22 17:43:41', NULL, 'c2b01cb2a6628c7805cd9b27f1bee4de59aaca8e', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 34, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:41', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;34\n', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 0, NULL, NULL)[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 34) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 34) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:41', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:43:41', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 34) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:41', '2011-04-22 17:43:41', 34, 33)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=33) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 34) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 34) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (12.8ms)
Rendered people/_person (140.2ms)
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (11.4ms)
Rendered companies/_company (30.4ms)
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 227ms (View: 180, DB: 12) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:43:41) [GET]
  Parameters: {"user"=>{"login"=>""}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY '' AND `users`.id <> 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'mg@mg.com' AND `users`.id <> 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 4) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering users/edit
Rendered people/_person_edit (13.9ms)
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (4.1ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 56ms (View: 42, DB: 7) | 200 OK [http://test.host/users/update?user%5Blogin%5D=]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:43:41) [GET]
  Parameters: {"id"=>#<UserSegmentManager id: 4, login: "gerente_segmento", email: "mg@mg.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:43:29", updated_at: "2011-04-22 17:43:30", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:43:29", password_reset_code: nil, enabled: true, type: "UserSegmentManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
Redirected to http://test.host/usuarios
Completed in 2ms (DB: 1) | 302 Found [http://test.host/users/resend_signup_mail/4]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:41) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "parcel"=>12, "cnpj"=>"61.286.834/0001-08", "value"=>50.0, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "company_type"=>"CompanyZ", "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.4ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('89fce171ed344b97b3a4bdbec6123e46e4a58532', '2011-04-22 17:43:41', NULL, NULL, NULL, '98962e1eeed9e802f0b3d37c180d45855fe939c2', NULL, '2011-04-22 17:43:41', NULL, '23eaae71374d3853a6a2697debb919b57d689ddc', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.1ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 35, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:41', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;35\n', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ760662') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.3ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:43:41', NULL, '2011-04-22 17:43:41', '61.286.834/0001-08', NULL, NULL, 35, 'CompanyZ', 'SZ760662', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 15) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:43:41', '2011-04-22 17:43:41', '2011-04-22 17:43:41', 50.0, 15, '2012-04-22 17:43:41', 'Aberto')[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 15) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:43:41', NULL, NULL, '2011-04-22 17:43:41', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 15, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.3ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 11) LIMIT 1[0m
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 11, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:41', `name` = 'Empresa', `created_at` = '2011-04-22 17:43:41', `company_id` = 15 WHERE `id` = 11[0m
  [4;36;1mAddress Create (0.4ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 11, 'MyString', 'MySring', 1, NULL, 'Layout', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.3ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:43:41', 'Home', '2011-04-22 17:43:41', NULL, 11)[0m
  [4;36;1mColorTemplate Load (0.2ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 11, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.3ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:43:41', `layout_id` = NULL WHERE `id` = 980190975[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 0, 1, 15, 'Company')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:41', '2011-04-22 17:43:41', 15, 14)[0m
  [4;35;1mAddress Create (0.2ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 15, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 35) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 35) LIMIT 1[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 35) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 35) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 35) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 35) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ760662' AND `companies`.id <> 15) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (14.8ms)
Rendered people/_person (15.2ms)
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (4.8ms)
Rendered companies/_company (9.2ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 238ms (View: 35, DB: 15) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.0&company_type=CompanyZ&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ760662' AND `companies`.id <> 15) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 35) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 35) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 35) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 35) LIMIT 1[0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:41) [POST]
  Parameters: {"person"=>{}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('89fce171ed344b97b3a4bdbec6123e46e4a58532', '2011-04-22 17:43:41', NULL, NULL, NULL, '98962e1eeed9e802f0b3d37c180d45855fe939c2', NULL, '2011-04-22 17:43:41', NULL, '2a5088c90fe962ad9fbab5d2ddc88cc2e2777240', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 36, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:41', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;36\n', '2011-04-22 17:43:41', 0, '2011-04-22 17:43:41', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 36) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 36) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 36) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 36) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 36) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 36) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (16.7ms)
Rendered people/_person (17.1ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.2ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 57ms (View: 29, DB: 11) | 200 OK [http://test.host/usuarios?&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.7ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 36) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 36) LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:41) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.0ms)
Rendered people/_person (15.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.1ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 50ms (View: 32, DB: 7) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>nil, "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (14.6ms)
Rendered people/_person (15.0ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 53ms (View: 35, DB: 5) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>nil, "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.2ms)
Rendered people/_person (15.6ms)
  [4;36;1mCompany Load (0.8ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (131.1ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 176ms (View: 159, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>nil, "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.9ms)
Rendered people/_person (16.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 56ms (View: 36, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:43:42) [GET]
  Parameters: {"id"=>#<UserGeneralManager id: 2, login: "gerente_geral", email: "gerente_geral@example.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-21 17:43:29", updated_at: "2011-04-22 17:43:30", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9a", activated_at: nil, password_reset_code: nil, enabled: true, type: "UserGeneralManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:43:42 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/usuarios
Completed in 5ms (DB: 2) | 302 Found [http://test.host/users/resend_signup_mail/2]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('f36136d679b2bef77d27246256b3a4e463252351', '2011-04-22 17:43:42', NULL, NULL, NULL, '489d200f8bb4cda62ef9c54c0d74470853e1fc58', NULL, '2011-04-22 17:43:42', NULL, 'dee306a38f5548a33d2b6fe3fa83e7334454ce51', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.4ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 37, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;37\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 37) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 37) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:42', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:43:42', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 37) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.3ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:42', '2011-04-22 17:43:42', 37, 34)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 37) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 37 AND `user_people`.id <> 956136643) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 37)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 37) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 37) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 34)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=34) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 34)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 34)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 34)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 34)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:42', `user_id` = 37 WHERE `id` = 34[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'dee306a38f5548a33d2b6fe3fa83e7334454ce51') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:42', `activated_at` = '2011-04-22 17:43:42' WHERE `id` = 37[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;37\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (1.8ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 60ms (View: 7, DB: 13) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 37) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (3.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('f36136d679b2bef77d27246256b3a4e463252351', '2011-04-22 17:43:42', NULL, NULL, NULL, '489d200f8bb4cda62ef9c54c0d74470853e1fc58', NULL, '2011-04-22 17:43:42', NULL, 'a64c2a5e1ba584a4e32e8d87d8170063eb85c00d', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.1ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 38, NULL)[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;38\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 38) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 38) LIMIT 1[0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:42', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:43:42', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;36;1mUserPerson Load (0.5ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 38) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:42', '2011-04-22 17:43:42', 38, 35)[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 38) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 38 AND `user_people`.id <> 956136644) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 38)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 38) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 38) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 35)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=35) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 35)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 35)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 35)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 35)) LIMIT 1[0m
  [4;35;1mPerson Update (0.5ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:42', `user_id` = 38 WHERE `id` = 35[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'a64c2a5e1ba584a4e32e8d87d8170063eb85c00d') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:42', `activated_at` = '2011-04-22 17:43:42' WHERE `id` = 38[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;38\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.0ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 193ms (View: 8, DB: 17) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUserAdministrator Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 38) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('f36136d679b2bef77d27246256b3a4e463252351', '2011-04-22 17:43:42', NULL, NULL, NULL, '489d200f8bb4cda62ef9c54c0d74470853e1fc58', NULL, '2011-04-22 17:43:42', NULL, '39394444f813c029cc128aea8c5a3b28f3be7c30', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 39, NULL)[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;39\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 39) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 39) LIMIT 1[0m
  [4;35;1mPerson Create (0.5ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:42', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:43:42', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 39) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:42', '2011-04-22 17:43:42', 39, 36)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 39) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 39 AND `user_people`.id <> 956136645) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 39)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 39) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 39) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 36)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=36) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 36)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 36)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 36)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 36)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:42', `user_id` = 39 WHERE `id` = 36[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '39394444f813c029cc128aea8c5a3b28f3be7c30') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:42', `activated_at` = '2011-04-22 17:43:42' WHERE `id` = 39[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;39\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (2.8ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 81ms (View: 31, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 39) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "parcel"=>12, "cnpj"=>"61.286.834/0001-08", "value"=>50.1, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"034.185.221-06", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '034.185.221-06') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('f36136d679b2bef77d27246256b3a4e463252351', '2011-04-22 17:43:42', NULL, NULL, NULL, '489d200f8bb4cda62ef9c54c0d74470853e1fc58', NULL, '2011-04-22 17:43:42', NULL, '59dd72f00674e28ac153de69552efe681b186d72', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 40, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;40\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ9517') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.2ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:43:42', NULL, '2011-04-22 17:43:42', '61.286.834/0001-08', NULL, NULL, 40, 'CompanyZ', 'SZ9517', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 16) [0m
  [4;35;1mContract Create (0.4ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:43:42', '2011-04-22 17:43:42', '2011-04-22 17:43:42', 50.1, 16, '2012-04-22 17:43:42', 'Aberto')[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 16) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:43:42', NULL, NULL, '2011-04-22 17:43:42', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 16, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.5ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.5ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 12) LIMIT 1[0m
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 12, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:42', `name` = 'Empresa', `created_at` = '2011-04-22 17:43:42', `company_id` = 16 WHERE `id` = 12[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 12, 'MyString', 'MySring', 1, NULL, 'Layout', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.3ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:43:42', 'Home', '2011-04-22 17:43:42', NULL, 12)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 12, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.3ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:43:42', `layout_id` = NULL WHERE `id` = 980190977[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, 1, 16, 'Company')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:42', '2011-04-22 17:43:42', 16, 15)[0m
  [4;35;1mAddress Create (0.3ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 16, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 40) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 40) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:42', 4, '034.185.221-06', '2008-09-09', '2011-04-22 17:43:42', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 40) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.2ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:42', '2011-04-22 17:43:42', 40, 37)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ9517' AND `companies`.id <> 16) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 40) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 40 AND `user_people`.id <> 956136646) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 40)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 40) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 40) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=37) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:42', `user_id` = 40 WHERE `id` = 37[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '59dd72f00674e28ac153de69552efe681b186d72') LIMIT 1[0m
  [4;35;1mUserCompany Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:42', `activated_at` = '2011-04-22 17:43:42' WHERE `id` = 40[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;40\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 37) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=37) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.7ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;36;1mUser Load Including Associations (0.8ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 40) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 40)) [0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (4.2ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 16 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 258ms (View: 18, DB: 26) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.1&company_type=CompanyZ&person%5Bcpf%5D=034.185.221-06&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ9517' AND `companies`.id <> 16) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=37) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 37)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 40) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 40) LIMIT 1[0m
  [4;35;1mSQL (2.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:42) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "company_type"=>"CompanyZ", "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('f36136d679b2bef77d27246256b3a4e463252351', '2011-04-22 17:43:42', NULL, NULL, NULL, '489d200f8bb4cda62ef9c54c0d74470853e1fc58', NULL, '2011-04-22 17:43:42', NULL, 'dd642c6616653bbc65e5e68fc917e9c21351f82b', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.4ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.4ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 41, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;41\n', '2011-04-22 17:43:42', 0, '2011-04-22 17:43:42', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ50922') LIMIT 1[0m
  [4;36;1mCompanyZ Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:43:43', NULL, '2011-04-22 17:43:43', NULL, NULL, NULL, 41, 'CompanyZ', 'SZ50922', NULL, 'Empresa', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 17) [0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 17, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 41) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 41) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:43', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:43:43', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 41) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:43', '2011-04-22 17:43:43', 41, 38)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ50922' AND `companies`.id <> 17) LIMIT 1[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 17) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=38) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 41) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 41) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ50922' AND `companies`.id <> 17) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (13.3ms)
Rendered people/_person (13.7ms)
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (4.6ms)
Rendered companies/_company (11.2ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 219ms (View: 34, DB: 20) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company_type=CompanyZ&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ50922' AND `companies`.id <> 17) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:43) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa", "informal"=>"1"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('ffcc6723c91566458dec0c1314e659ba12bae5d1', '2011-04-22 17:43:43', NULL, NULL, NULL, '9e983c0128a009ee1947c2e4884d79de32d37e1b', NULL, '2011-04-22 17:43:43', NULL, '61888a51dac12931d68ad6c7649d7b75d7ee4d25', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 42, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;42\n', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ668155') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.5ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:43:43', NULL, '2011-04-22 17:43:43', NULL, NULL, NULL, 42, 'CompanyS', 'SZ668155', NULL, 'Empresa', NULL, NULL, 1, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 18) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.3ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:43:43', NULL, NULL, '2011-04-22 17:43:43', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 18, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.4ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 13) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 13, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:43', `name` = 'Empresa', `created_at` = '2011-04-22 17:43:43', `company_id` = 18 WHERE `id` = 13[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.5ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 13, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.5ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:43:43', `layout_id` = NULL WHERE `id` = 980190979[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, 1, 18, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:43', '2011-04-22 17:43:43', 18, 16)[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 18, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 42) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 42) LIMIT 1[0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:43', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:43:43', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.6ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 42) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:43', '2011-04-22 17:43:43', 42, 39)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ668155' AND `companies`.id <> 18) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.5ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 42) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 42 AND `user_people`.id <> 956136648) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 42)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 42) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 42) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=39) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:43', `user_id` = 42 WHERE `id` = 39[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '61888a51dac12931d68ad6c7649d7b75d7ee4d25') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:43', `activated_at` = '2011-04-22 17:43:43' WHERE `id` = 42[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;42\n', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 39) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=39) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 39)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.7ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 42) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 42)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (4.4ms)
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 248ms (View: 16, DB: 26) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Binformal%5D=1&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ668155' AND `companies`.id <> 18) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:43) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('ffcc6723c91566458dec0c1314e659ba12bae5d1', '2011-04-22 17:43:43', NULL, NULL, NULL, '9e983c0128a009ee1947c2e4884d79de32d37e1b', NULL, '2011-04-22 17:43:43', NULL, 'd0324400f7bfdaa2eb6e54f8719a4259587fbb5e', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 43, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;43\n', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ671248') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.4ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:43:43', NULL, '2011-04-22 17:43:43', '61.286.834/0001-08', NULL, NULL, 43, 'CompanyS', 'SZ671248', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 19) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.5ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:43:43', NULL, NULL, '2011-04-22 17:43:43', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 19, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.5ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 14) LIMIT 1[0m
  [4;35;1mColor Create (0.5ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 14, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:43:43', `name` = 'Empresa', `created_at` = '2011-04-22 17:43:43', `company_id` = 19 WHERE `id` = 14[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.4ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:43:29', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 14, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:43:43', `layout_id` = NULL WHERE `id` = 980190981[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, 1, 19, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:43:43', '2011-04-22 17:43:43', 19, 17)[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 19, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 43) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 43) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:43:43', 4, NULL, '2008-09-09', '2011-04-22 17:43:43', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 43) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.1ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:43:43', '2011-04-22 17:43:43', 43, 40)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ671248' AND `companies`.id <> 19) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 43) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 43 AND `user_people`.id <> 956136649) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 43)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 43) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 43) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=40) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:43', `user_id` = 43 WHERE `id` = 40[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'd0324400f7bfdaa2eb6e54f8719a4259587fbb5e') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:43', `activated_at` = '2011-04-22 17:43:43' WHERE `id` = 43[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;43\n', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 40) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=40) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.8ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 43) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 43)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (136.2ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.7ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 241ms (View: 147, DB: 25) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ671248' AND `companies`.id <> 19) LIMIT 1[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=40) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 40)) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 43) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 43) LIMIT 1[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:43) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mUserSegmentManager Create (0.5ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('ffcc6723c91566458dec0c1314e659ba12bae5d1', '2011-04-22 17:43:43', NULL, NULL, NULL, '9e983c0128a009ee1947c2e4884d79de32d37e1b', NULL, '2011-04-22 17:43:43', NULL, '5746d96b02ace921571d584d04c54e414317423a', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.3ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 44, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;44\n', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 44) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 44) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 44) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 44) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 44) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 44) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (17.3ms)
Rendered people/_person (17.6ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 65ms (View: 33, DB: 16) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 44) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 44) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 44) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 44) LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:43:43) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg"=>"MyString", "rg_exp"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "password"=>"quire", "login"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;35;1mUserSegmentManager Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('ffcc6723c91566458dec0c1314e659ba12bae5d1', '2011-04-22 17:43:43', NULL, NULL, NULL, '9e983c0128a009ee1947c2e4884d79de32d37e1b', NULL, '2011-04-22 17:43:43', NULL, 'b9be08dff6ae0d4b16ceacb9ed0fdd056a297d55', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 45, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:43:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;45\n', '2011-04-22 17:43:43', 0, '2011-04-22 17:43:43', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 45) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 45) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 45) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 45) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 45) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 45) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (17.3ms)
Rendered people/_person (17.7ms)
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.8ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 193ms (View: 164, DB: 10) | 200 OK [http://test.host/usuarios?person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 45) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 45) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 45) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 45) LIMIT 1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:43:44) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:43:44', `login` = 'quentin2' WHERE `id` = 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:43:44', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/
Completed in 22ms (DB: 9) | 302 Found [http://test.host/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m


Processing VisitSchedulerController#create (for 0.0.0.0 at 2011-04-22 14:43:44) [PUT]
  Parameters: {"visit_schedule"=>{"segment_id"=>#<Segment id: 1, name: "Alimenta√ß√£o", file: "Mystring.jpg">, "city"=>"oidjsa", "name"=>"siuhsi", "address"=>"diuashdiauhdiusha", "ddd"=>"021", "time_to_visit"=>"Indiferente", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:43:29", updated_at: "2011-04-22 17:43:29", enabled: true>, "phone"=>"212121", "email"=>"bruno@diudh.com"}}
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Sent mail to bsiqueira@suaempreza.com.br

Date: Fri, 22 Apr 2011 14:43:44 -0300
From: bsiqueira@suaempreza.com.br
To: bsiqueira@suaempreza.com.br
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_siuhsi=3A_Solicita=C3=A7=C3=A3o_de_visita?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>C√©lula Z</title>
</head>
<body>
  <h1> Solicita√ß√£o de Agendamento de Visita</h1>

  <p>
    <b>Nome:</b>
    siuhsi
  </p>

  <p>
    <b>Email:</b>
    bruno@diudh.com
  </p>

  <p>
    <b>Telefone:</b>
    021 212121
  </p>

  <p>
    <b>Endere√ßo:</b>
    diuashdiauhdiusha - oidjsa
  </p>

  <p>
    <b>Filial:</b>
    Filial 1
  </p>

  <p>
    <b>Segmento:</b>
    Alimenta√ß√£o
  </p>

  <p>
    <b>Hor√°rio de Prefer√™ncia para Visita:</b>
    Indiferente
  </p>

  <p>
    <b>Observa√ß√µes:</b>
    
  </p>
</body>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 10ms (DB: 3) | 302 Found [http://test.host/visit_scheduler/create?visit_schedule%5Baddress%5D=diuashdiauhdiusha&visit_schedule%5Bcity%5D=oidjsa&visit_schedule%5Bddd%5D=021&visit_schedule%5Bemail%5D=bruno%40diudh.com&visit_schedule%5Bname%5D=siuhsi&visit_schedule%5Bphone%5D=212121&visit_schedule%5Bsegment_id%5D=1&visit_schedule%5Bsubsidiary_id%5D=1&visit_schedule%5Btime_to_visit%5D=Indiferente]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing VisitSchedulerController#new (for 0.0.0.0 at 2011-04-22 14:43:44) [GET]
Rendering template within layouts/main
Rendering visit_scheduler/new
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`enabled` = 1) ORDER BY title[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.9ms)
Completed in 13ms (View: 12, DB: 1) | 200 OK [http://test.host/agendar-visita]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:43:44) [GET]
  Parameters: {"domain"=>"www.celudoaudhisauhdiasuhlaz.com.br"}
Completed in 378ms (View: 0, DB: 1) | 200 OK [http://test.host/whois/check?domain=www.celudoaudhisauhdiasuhlaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:43:44) [GET]
  Parameters: {"domain"=>"www.sorvetefeliz.com.br"}
Completed in 383ms (View: 1, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.sorvetefeliz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:43:44) [GET]
  Parameters: {"domain"=>"www.celulaz.com.br"}
Completed in 886ms (View: 0, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.celulaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:43:45) [GET]
  Parameters: {"id"=>"empres√£ _&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;36;1mCompanyZ Load Including Associations (0.7ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `layouts`.`id` AS t1_r0, `layouts`.`company_id` AS t1_r1, `layouts`.`architecture_type` AS t1_r2, `layouts`.`name` AS t1_r3, `layouts`.`slogan` AS t1_r4, `layouts`.`website` AS t1_r5, `layouts`.`presentation_text` AS t1_r6, `layouts`.`background_file_name` AS t1_r7, `layouts`.`created_at` AS t1_r8, `layouts`.`updated_at` AS t1_r9, `layouts`.`card1_file_name` AS t1_r10, `layouts`.`card1_content_type` AS t1_r11, `layouts`.`card1_file_size` AS t1_r12, `layouts`.`card2_file_name` AS t1_r13, `layouts`.`card2_content_type` AS t1_r14, `layouts`.`card2_file_size` AS t1_r15, `layouts`.`card3_file_name` AS t1_r16, `layouts`.`card3_content_type` AS t1_r17, `layouts`.`card3_file_size` AS t1_r18, `layouts`.`component_decoration` AS t1_r19, `layouts`.`show_name` AS t1_r20, `layouts`.`show_slogan` AS t1_r21, `layouts`.`show_logo` AS t1_r22, `layouts`.`background_top` AS t1_r23, `layouts`.`send_to_friend` AS t1_r24, `layouts`.`side_image_url` AS t1_r25, `layouts`.`font_colors` AS t1_r26, `layouts`.`email` AS t1_r27, `layouts`.`facebook` AS t1_r28, `layouts`.`orkut` AS t1_r29, `layouts`.`twitter` AS t1_r30, `layouts`.`flickr` AS t1_r31, `layouts`.`repeat_background_x` AS t1_r32, `layouts`.`repeat_background_y` AS t1_r33, `layouts`.`centralize_background` AS t1_r34, `layouts`.`meta_description` AS t1_r35, `layouts`.`meta_keywords` AS t1_r36, `layouts`.`analytics` AS t1_r37, `colors`.`id` AS t2_r0, `colors`.`name` AS t2_r1, `colors`.`slogan` AS t2_r2, `colors`.`title` AS t2_r3, `colors`.`subtitle` AS t2_r4, `colors`.`checked_menu` AS t2_r5, `colors`.`unchecked_menu` AS t2_r6, `colors`.`background_menu` AS t2_r7, `colors`.`tool_botton` AS t2_r8, `colors`.`text` AS t2_r9, `colors`.`tool_body` AS t2_r10, `colors`.`background` AS t2_r11, `colors`.`body` AS t2_r12, `colors`.`created_at` AS t2_r13, `colors`.`updated_at` AS t2_r14, `colors`.`layout_id` AS t2_r15, `colors`.`menu_deselected_text` AS t2_r16, `colors`.`menu_deselected_background` AS t2_r17, `colors`.`menu_selected_text` AS t2_r18, `colors`.`menu_selected_background` AS t2_r19, `colors`.`menu_hover_text` AS t2_r20, `colors`.`menu_hover_background` AS t2_r21, `colors`.`title_text` AS t2_r22, `colors`.`title_background` AS t2_r23, `colors`.`subtitle_text` AS t2_r24, `colors`.`subtitle_background` AS t2_r25, `colors`.`text_background` AS t2_r26, `colors`.`link_text` AS t2_r27, `colors`.`link_background` AS t2_r28, `colors`.`body_sidebar` AS t2_r29, `colors`.`border` AS t2_r30, `colors`.`name_company_text` AS t2_r31, `colors`.`slogan_company_text` AS t2_r32, `colors`.`footer_background` AS t2_r33, `colors`.`footer_text` AS t2_r34, `colors`.`sidebar_text` AS t2_r35, `users`.`id` AS t3_r0, `users`.`login` AS t3_r1, `users`.`email` AS t3_r2, `users`.`crypted_password` AS t3_r3, `users`.`salt` AS t3_r4, `users`.`created_at` AS t3_r5, `users`.`updated_at` AS t3_r6, `users`.`remember_token` AS t3_r7, `users`.`remember_token_expires_at` AS t3_r8, `users`.`activation_code` AS t3_r9, `users`.`activated_at` AS t3_r10, `users`.`password_reset_code` AS t3_r11, `users`.`enabled` AS t3_r12, `users`.`type` AS t3_r13, `users`.`self_created` AS t3_r14, `users`.`avatar_file_name` AS t3_r15, `users`.`avatar_content_type` AS t3_r16, `users`.`avatar_file_size` AS t3_r17, `users`.`avatar_updated_at` AS t3_r18, `users`.`domain` AS t3_r19 FROM `companies` LEFT OUTER JOIN `layouts` ON layouts.company_id = companies.id LEFT OUTER JOIN `colors` ON colors.layout_id = layouts.id LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (7) [0m
Cache write: empres√£ _&valid_2_layout
  [4;35;1mTab Load IDs For Limited Eager Loading (0.3ms)[0m   [0mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;36;1mTab Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;35;1mTab Load Including Associations (0.4ms)[0m   [0mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) AND `tabs`.id IN (3) ORDER BY tabs.order[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (2.7ms)
  [4;36;1mTab Load Including Associations (0.7ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order[0m
Rendered z/_social (0.5ms)
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (1.0ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.3ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (5.0ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 2 AND `addresses`.owner_type = 'Layout') LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
Rendered z/_address (4.3ms)
Rendered z/_sidebar_address (0.8ms)
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
Completed in 67ms (View: 38, DB: 8) | 200 OK [http://test.host/z/empres%C3%A3%20_&valid_2]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:43:45) [GET]
  Parameters: {"id"=>"empres%C3%A3%20_&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (0.6ms)
Rendered z/_social (0.1ms)
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.4ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.0ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (2.8ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_address (0.8ms)
Rendered z/_sidebar_address (0.1ms)
Completed in 159ms (View: 152, DB: 5) | 200 OK [http://test.host/z/empres%25C3%25A3%2520_&valid_2]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:43:45) [GET]
  Parameters: {"id"=>"asiuhiasuhaiuhsiauhsiauhsiuhai"}
Cache read: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='asiuhiasuhaiuhsiauhsiauhsiuhai') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
Cache write: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
Redirected to http://test.host/not_found
Filter chain halted as [:find_company] rendered_or_redirected.
Completed in 10ms (DB: 1) | 302 Found [http://test.host/z/asiuhiasuhaiuhsiauhsiauhsiuhai]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUserGeneralManager Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:47:41) [GET]
  Parameters: {"id"=>"8f24789ae988411ccf33ab0c30fe9106fab32e9a"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '8f24789ae988411ccf33ab0c30fe9106fab32e9a') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserGeneralManager Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:41', `activated_at` = '2011-04-22 17:47:41' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:41', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserGeneralManager;2\n', '2011-04-22 17:47:41', 0, '2011-04-22 17:47:41', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 16ms (DB: 316) | 302 Found [http://test.host/ativar/8f24789ae988411ccf33ab0c30fe9106fab32e9a]
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:47:41) [GET]
  Parameters: {"id"=>""}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '') LIMIT 1[0m
Redirected to http://test.host/signup
Completed in 1ms (DB: 3) | 302 Found [http://test.host/ativar/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:47:41) [GET]
Redirected to http://test.host/signup
Completed in 0ms (DB: 0) | 302 Found [http://test.host/ativar]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUserCompany Columns (2.6ms)[0m   [0mSHOW FIELDS FROM `users`[0m


Processing Company::AddressController#update (for 0.0.0.0 at 2011-04-22 14:47:41) [GET]
  Parameters: {"address"=>{}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered company/address/_address (2.0ms)
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT * FROM `states` [0m
Rendered company/address/_form (7.4ms)
Rendering company/address/update
Completed in 29ms (View: 1, DB: 0) | 200 OK [http://test.host/company/address/update?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::AddressController#update (for 0.0.0.0 at 2011-04-22 14:47:41) [GET]
  Parameters: {"address"=>{"street"=>nil}}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered company/address/_form (5.3ms)
Rendering company/address/update
Completed in 12ms (View: 2, DB: 0) | 200 OK [http://test.host/company/address/update?address%5Bstreet%5D=]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessCardController#index (for 0.0.0.0 at 2011-04-22 14:47:41) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Google geocoding. Address: MyString MyString 1111 MyString MySring RJ Rio de Janeiro Brasil. Result: <?xml version="1.0" encoding="UTF-8" ?>
<kml xmlns="http://earth.google.com/kml/2.0"><Response>
  <name>MyString MyString 1111 MyString MySring RJ Rio de Janeiro Brasil</name>
  <Status>
    <code>200</code>
    <request>geocode</request>
  </Status>
  <Placemark id="p1">
    <address>Rio de Janeiro, Brazil</address>
    <AddressDetails Accuracy="4" xmlns="urn:oasis:names:tc:ciq:xsdschema:xAL:2.0"><Country><CountryNameCode>BR</CountryNameCode><CountryName>Brasil</CountryName><AdministrativeArea><AdministrativeAreaName>RJ</AdministrativeAreaName><Locality><LocalityName>Rio de Janeiro</LocalityName></Locality></AdministrativeArea></Country></AddressDetails>
    <ExtendedData>
      <LatLonBox north="-22.5742361" south="-23.2320449" east="-42.6973493" west="-43.7218245" />
    </ExtendedData>
    <Point><coordinates>-43.2095869,-22.9035393,0</coordinates></Point>
  </Placemark>
</Response></kml>
Rendering template within layouts/company
Rendering company/business_card/index
  [4;35;1mPhone Load (0.5ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
Rendered company/phones/_form (4.9ms)
Rendered company/address/_address (0.3ms)
  [4;36;1mState Load (0.5ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered company/address/_form (4.9ms)
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
Rendered company/business_card/_card_image_form (3.4ms)
Rendered company/business_card/_card_image_form (1.1ms)
Rendered company/business_card/_card_image_form (1.0ms)
  [4;35;1mService Load (0.7ms)[0m   [0mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 7)) [0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT * FROM `services` [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.7ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 644ms (View: 142, DB: 5) | 200 OK [http://test.host/empresa/cartao-de-visitas]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::BusinessCardController#update (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"presentation_text", "value"=>"123"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:42', `presentation_text` = '123' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 8ms (View: 0, DB: 2) | 200 OK [http://test.host/company/business_card/update/presentation_text?value=123]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:47:42) [POST]
  Parameters: {"business"=>{}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 28ms (View: 15, DB: 7) | 200 OK [http://test.host/company/businesses?]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:47:42) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;36;1mBusiness Destroy (0.4ms)[0m   [0;1mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 7ms (DB: 4) | 302 Found [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.5ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 17ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 11, DB: 2) | 200 OK [http://test.host/company/businesses/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 9, DB: 4) | 200 OK [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:47:42) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponentText Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:42', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Create (0.5ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:47:42', 'titulo do component', NULL, NULL, '2011-04-22 17:47:42', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 132ms (View: 0, DB: 10) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mComponentText Create (0.5ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:47:42', 'C√≥digo', NULL, NULL, '2011-04-22 17:47:42', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 12ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 2, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:42', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:47:42', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.3ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;35;1mComponentForm Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mComponentForm Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 17:47:42', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.3ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;36;1mSQL (2.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ConstructionController#content (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering /company/construction/content.json
  [4;36;1mTab Load (0.5ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mComponentPicture Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 1)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 3) [0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 3)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 4) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
Completed in 30ms (View: 0, DB: 0) | 200 OK [http://test.host/company/construction/content]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::LayoutController#update_background (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"/image/temp_small"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:42', `background_file_name` = '/image/temp' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 12ms (View: 0, DB: 3) | 200 OK [http://test.host/company/layout/update_background/%2Fimage%2Ftemp_small]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::LayoutController#update_background_top (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"/image/temp_small"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:42', `background_top` = '/image/temp' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 0, DB: 3) | 200 OK [http://test.host/company/layout/update_background_top/%2Fimage%2Ftemp_small]
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::MailboxController#index (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `message_copies`.id FROM `message_copies` LEFT OUTER JOIN `messages` ON `messages`.id = `message_copies`.message_id WHERE ((`message_copies`.folder_id = 980190962) AND (deleted IS NULL OR deleted = 0)) ORDER BY messages.created_at DESC LIMIT 0, 10[0m
  [4;35;1mMessageCopy Load (0.4ms)[0m   [0mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/mailbox/index
Rendered company/shared/_message_actions (0.5ms)
  [4;36;1mCompany Load (0.8ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mCompany Count (0.6ms)[0m   [0;1mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (7.9ms)
Rendered company/shared/_message_box_label (2.2ms)
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 141ms (View: 123, DB: 8) | 200 OK [http://test.host/company/mailbox]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::MessageToFriendController#create (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"message_to_friend"=>{"email_to"=>"teste@hotmail.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_to_friend\nargs: \n- &id001 !ruby/object:MessageToFriend \n company: !ruby/object:CompanyZ \n attributes: \n segment_id: \"1\"\n profile_logo_updated_at: \n created_at: 2011-04-22 17:47:41\n updated_at: 2011-04-22 17:47:41\n profile_logo_file_name: \n register_number: \n cnpj: 15.754.056/0001-09\n id: \"5\"\n drawee_code: SZ20002\n type: CompanyZ\n user_id: \"8\"\n person_id: \"13\"\n profile_logo_content_type: \n razao_social: MyString\n informal: \n state_id: \n profile_logo_file_size: \n payment_type: mensal\n attributes_cache: {}\n\n layout: !ruby/object:Layout \n attributes: \n flickr: \n name: Empresa 1\n created_at: 2011-04-22 17:47:41\n slogan: A primeira empresa do banco de testes\n repeat_background_x: \n font_colors: \n repeat_background_y: \n side_image_url: \n updated_at: 2011-04-22 17:47:41\n send_to_friend: \"0\"\n show_logo: \n show_slogan: \n show_name: \n centralize_background: \n id: \"1\"\n meta_keywords: \n meta_description: \n card2_file_name: \n card2_file_size: \n card2_content_type: \n card1_file_name: \n website: www.sitedaempresa1.com.br\n company_id: \"5\"\n facebook: \n background_top: \n card3_content_type: \n card1_file_size: \n architecture_type: \"6\"\n orkut: \n component_decoration: \n card3_file_name: \n background_file_name: \n presentation_text: \"texto de apresenta\\xC3\\xA7\\xC3\\xA3o da empresa 1\"\n analytics: \n twitter: \n email: \n card3_file_size: \n card1_content_type: \n attributes_cache: {}\n\n email_to: teste@hotmail.com\n errors: !ruby/object:ActiveRecord::Errors \n base: *id001\n errors: !omap []\n\n', '2011-04-22 17:47:42', 0, '2011-04-22 17:47:42', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/message_to_friend/create
Completed in 16ms (View: 1, DB: 2) | 200 OK [http://test.host/company/message_to_friend/create?message_to_friend%5Bemail_to%5D=teste%40hotmail.com]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m


Processing Company::MessagesController#destroy (for 0.0.0.0 at 2011-04-22 14:47:42) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = '1') AND (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mMessageCopy Update (0.3ms)[0m   [0;1mUPDATE `message_copies` SET `deleted` = 1, `updated_at` = '2011-04-22 17:47:42' WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 12ms (View: 0, DB: 4) | 200 OK [http://test.host/company/mensagens/1]
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m


Processing Company::MessagesController#create (for 0.0.0.0 at 2011-04-22 14:47:42) [POST]
  Parameters: {"message"=>{"body"=>"Corpo da mensagem", "sender"=>"8", "subject"=>"Teste - Mensagem enviada do sistema", "to"=>"8"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: sender
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.3ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES(NULL, '2011-04-22 17:47:42', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:47:42', 'Teste - Mensagem enviada do sistema', 8, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 9) [0m
  [4;35;1mMessageCopy Create (0.2ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:47:42', NULL, 8, NULL, NULL, 9)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;8\n', '2011-04-22 17:47:42', 0, '2011-04-22 17:47:42', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:42', 0, '2011-04-22 17:47:42', 0, 0, 9, 'Message')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:42', '2011-04-22 17:47:42', 5, 18)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 24ms (View: 0, DB: 6) | 200 OK [http://test.host/company/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender%5D=8&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+sistema&message%5Bto%5D=8]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m


Processing Company::MessagesController#create (for 0.0.0.0 at 2011-04-22 14:47:42) [POST]
  Parameters: {"message"=>{"body"=>"Corpo da mensagem de resposta", "sender"=>"8", "subject"=>"Teste - Mensagem enviada do sistema", "to"=>"8"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: sender
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;35;1mMessage Create (0.3ms)[0m   [0mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES(NULL, '2011-04-22 17:47:42', NULL, NULL, NULL, 'Corpo da mensagem de resposta', NULL, '2011-04-22 17:47:42', 'Teste - Mensagem enviada do sistema', 8, NULL, NULL)[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 10) [0m
  [4;36;1mMessageCopy Create (0.2ms)[0m   [0;1mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:47:42', NULL, 8, NULL, NULL, 10)[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:42', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;9\n', '2011-04-22 17:47:42', 0, '2011-04-22 17:47:42', 0, NULL, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mFeedItem Create (0.2ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:42', 0, '2011-04-22 17:47:42', 0, 0, 10, 'Message')[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:42', '2011-04-22 17:47:42', 5, 19)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 20ms (View: 0, DB: 6) | 200 OK [http://test.host/company/mensagens?message%5Bbody%5D=Corpo+da+mensagem+de+resposta&message%5Bsender%5D=8&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+sistema&message%5Bto%5D=8]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m


Processing Company::MessagesController#show (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = '1') AND (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mMessageCopy Update (0.4ms)[0m   [0mUPDATE `message_copies` SET `updated_at` = '2011-04-22 17:47:42', `read` = 1 WHERE `id` = 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/messages/show
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.5ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.0ms)
Rendered company/shared/_message_box_label (0.4ms)
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 29ms (View: 17, DB: 8) | 200 OK [http://test.host/company/mensagens/1]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing Company::PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:47:42) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Rendering template within layouts/company
Rendering company/people/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 140ms (View: 25, DB: 4) | 200 OK [http://test.host/company/people/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing Company::PeopleController#update (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/people/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 37ms (View: 23, DB: 5) | 200 OK [http://test.host/company/people/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"phone"=>{"number"=>88888888, "ddd"=>21}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mPhone Create (0.3ms)[0m   [0;1mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(88888888, '2011-04-22 17:47:43', '2011-04-22 17:47:43', 21, 5, NULL, NULL, 'Company')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_phone (0.3ms)
Rendered company/phones/_form (1.5ms)
Completed in 13ms (View: 4, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=21&phone%5Bnumber%5D=88888888]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.1ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m


Processing Company::PhonesController#destroy (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962 AND (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.3ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/destroy
Completed in 6ms (View: 1, DB: 4) | 200 OK [http://test.host/company/phones/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"phone"=>{"number"=>"", "ddd"=>""}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.6ms)
Completed in 10ms (View: 5, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=&phone%5Bnumber%5D=]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"phone"=>{"number"=>nil, "ddd"=>nil}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.5ms)
Completed in 9ms (View: 5, DB: 2) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=&phone%5Bnumber%5D=]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"phone"=>{"number"=>"dsafsa", "ddd"=>"3ewew"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.8ms)
Completed in 11ms (View: 6, DB: 2) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=3ewew&phone%5Bnumber%5D=dsafsa]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;36;1mPicture Load (0.2ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mComponentGallery Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::PicturesController#update (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"id"=>#<Picture id: 1, component_id: 8, title: "MyString", description: "MyText", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", photo_file_size: nil, photo_content_type: nil, photo_file_name: nil, component_type: "Component">, "component_id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "picture"=>{"description"=>"sou a nova descri√ß√£o"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8 AND (`components`.layout_id = 1)) [0m
  [4;36;1mPicture Load (0.3ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1 AND (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.3ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:47:43', `description` = 'sou a nova descri√ß√£o' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 17ms (View: 1, DB: 6) | 200 OK [http://test.host/company/componentes/8/images/1?picture%5Bdescription%5D=sou+a+nova+descri%C3%A7%C3%A3o]
  [4;36;1mPicture Load (0.3ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ProfileController#index (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 7)) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 7)) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT distinct feed_items.* FROM `feed_items` INNER JOIN `feeds` ON feeds.feed_item_id = feed_items.id WHERE (feeds.company_id in (5,7) and (is_public = 1 or company_id = 7)) ORDER BY feed_items.updated_at desc LIMIT 0, 10[0m
Rendering template within layouts/company
Rendering company/profile/index
  [4;36;1mCompany Load (0.5ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=false) 
 WHERE (destinies.company_destiny_id=7)[0m
Rendered company/news/_news (0.9ms)
Rendered company/profile/_feeds (1.0ms)
Rendered company/message_to_friend/_form (3.1ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7) LIMIT 0, 4[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mVisit Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `visits`[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/z/empres√£ _&valid_2' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:47:43') [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/z/empres√£ _&valid_2' and created_at>'2011-03-22 17:47:43' and created_at<'2011-04-22 17:47:43') [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/company/profile/public/7-MyString' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:47:43') [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/company/profile/public/7-MyString' and created_at>'2011-03-22 17:47:43' and created_at<'2011-04-22 17:47:43') [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/business_cards/7-MyString' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:47:43') [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/business_cards/7-MyString' and created_at>'2011-03-22 17:47:43' and created_at<'2011-04-22 17:47:43') [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
Completed in 153ms (View: 26, DB: 10) | 200 OK [http://test.host/empresa-inicio]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Company::ProfileController#public (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.* FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering company/profile/public
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE (`companies`.`id` = 7) AND ((`company_relationships`.company_destiny_id = 7)) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 7) AND ((`company_relationships`.company_origin_id = 7)) LIMIT 1[0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mAddress Load (0.5ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mService Load (0.5ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 7)) [0m
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7) LIMIT 20, 5[0m
  [4;36;1mCompany Count (0.6ms)[0m   [0;1mSELECT COUNT(*) FROM (
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7)) AS count_table[0m
Rendered company/profile/_feeds (0.1ms)
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mVisit Load (0.5ms)[0m   [0mSELECT `visits`.id FROM `visits` WHERE (`visits`.`session` = 'ca5250c19edb9df8033f80c8f7882b96' AND `visits`.`request_url` = '/company/profile/public/#<CompanyZ:0x10670ba28>') LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mVisit Create (0.4ms)[0m   [0mINSERT INTO `visits` (`created_at`, `session`, `updated_at`, `user_id`, `request_url`, `ip_address`) VALUES('2011-04-22 17:47:43', 'ca5250c19edb9df8033f80c8f7882b96', '2011-04-22 17:47:43', 12, '/company/profile/public/#<CompanyZ:0x10670ba28>', '0.0.0.0')[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 37ms (View: 23, DB: 9) | 200 OK [http://test.host/company/profile/public/7-MyString]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompanyS Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 4) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>"4"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 4 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.4ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 4 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.4ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 4) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.3ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:47:43', 0, 4, '2011-04-22 17:47:43')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:43', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyRelationshipMailer\nmethod: :deliver_request\nargs: \n- LOAD;CompanyRelationship;495905393\n- \n', '2011-04-22 17:47:43', 0, '2011-04-22 17:47:43', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/relationship_request/create
Completed in 18ms (View: 1, DB: 9) | 200 OK [http://test.host/company/relationship_request/create/4]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mCompanyZ Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 3) [0m
Redirected to http://test.host/company/relationship_request/update/3
Completed in 6ms (DB: 5) | 302 Found [http://test.host/company/relationship_request/create/3]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_destiny_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.1ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering company/relationship_request/create
Completed in 8ms (View: 0, DB: 3) | 200 OK [http://test.host/company/relationship_request/create/5]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing Company::RelationshipRequestController#destroy (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyRelationship Delete all (0.3ms)[0m   [0mDELETE FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3 AND `company_relationships`.`company_destiny_id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Delete all (0.2ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.`company_destiny_id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/profile/public/3-empresa
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company/relationship_request/destroy/3]
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5)) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing Company::RelationshipRequestController#update (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>"3"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.4ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = '3') AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyRelationship Update (0.2ms)[0m   [0;1mUPDATE `company_relationships` SET `updated_at` = '2011-04-22 17:47:43', `confirmed` = 1 WHERE `id` = 495905389[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:43', 0, '2011-04-22 17:47:43', 0, 1, 495905389, 'CompanyRelationship')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:43', '2011-04-22 17:47:43', 5, 20)[0m
  [4;35;1mFeed Create (0.4ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:43', '2011-04-22 17:47:43', 3, 20)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/relationship_request/update
Completed in 14ms (View: 1, DB: 5) | 200 OK [http://test.host/company/relationship_request/update/3]
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipsController#friend_requests (for 0.0.0.0 at 2011-04-22 14:47:43) [POST]
  Parameters: {"company_origin_id"=>#<CompanyS id: 3, user_id: 5, cnpj: "88.323.034/0001-68", razao_social: "empresa", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20004", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "status"=>"true"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.5ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3) AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyRelationship Update (0.2ms)[0m   [0;1mUPDATE `company_relationships` SET `updated_at` = '2011-04-22 17:47:43', `confirmed` = 1 WHERE `id` = 495905389[0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:43', 0, '2011-04-22 17:47:43', 0, 1, 495905389, 'CompanyRelationship')[0m
  [4;36;1mFeed Create (0.4ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:43', '2011-04-22 17:47:43', 5, 21)[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:43', '2011-04-22 17:47:43', 3, 21)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 129ms (View: 0, DB: 7) | 200 OK [http://test.host/company/relationships/friend_requests?company_origin_id=3-empresa&status=true]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipsController#friend_requests (for 0.0.0.0 at 2011-04-22 14:47:43) [POST]
  Parameters: {"company_origin_id"=>#<CompanyS id: 3, user_id: 5, cnpj: "88.323.034/0001-68", razao_social: "empresa", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20004", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "status"=>"false"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3) AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 6ms (View: 0, DB: 5) | 200 OK [http://test.host/company/relationships/friend_requests?company_origin_id=3-empresa&status=false]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::SentController#index (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessage Load (0.6ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) ORDER BY created_at DESC LIMIT 0, 10[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/sent/index
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.8ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.4ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.6ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `message_copies` ON `users`.id = `message_copies`.recipient_id WHERE ((`message_copies`.message_id = 1)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `message_copies` ON `users`.id = `message_copies`.recipient_id WHERE ((`message_copies`.message_id = 1)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 34ms (View: 19, DB: 7) | 200 OK [http://test.host/company/sent]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m


Processing Company::SentController#show (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1 AND (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null))) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/sent/show
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.5ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.2ms)
Rendered company/shared/_message_box_label (0.4ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 24ms (View: 14, DB: 6) | 200 OK [http://test.host/company/sent/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mService Load (0.1ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m


Processing Company::ServiceController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mService Load (0.3ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;36;1mService Load (0.2ms)[0m   [0;1mSELECT `services`.id FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE (`services`.`id` = 1) AND ((`company_services`.company_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyService Create (0.2ms)[0m   [0;1mINSERT INTO `company_services` (`created_at`, `updated_at`, `service_id`, `company_id`) VALUES('2011-04-22 17:47:43', '2011-04-22 17:47:43', 1, 5)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/service/create
Completed in 13ms (View: 1, DB: 3) | 200 OK [http://test.host/company/service/create/1]
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyZ Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mService Load (0.2ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyService Create (0.3ms)[0m   [0mINSERT INTO `company_services` (`created_at`, `updated_at`, `service_id`, `company_id`) VALUES('2011-04-22 17:47:43', '2011-04-22 17:47:43', 1, 5)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) LIMIT 1[0m


Processing Company::ServiceController#destroy (for 0.0.0.0 at 2011-04-22 14:47:43) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mService Load (0.2ms)[0m   [0;1mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyService Delete all (0.3ms)[0m   [0;1mDELETE FROM `company_services` WHERE (`company_services`.`service_id` = 1 AND `company_services`.`company_id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/service/destroy
Completed in 6ms (View: 1, DB: 7) | 200 OK [http://test.host/company/service/destroy/1]
  [4;36;1mCompanyZ Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `services`.id) AS count_services_id FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabComponentsController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "tab_component"=>{"line"=>5, "column"=>1, "full_line"=>true, "tab_id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", order: 1.0>}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 8)) LIMIT 1[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 8) [0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Create (0.3ms)[0m   [0mINSERT INTO `tab_components` (`created_at`, `line`, `updated_at`, `column`, `full_line`, `tab_id`, `component_id`) VALUES('2011-04-22 17:47:43', 5, '2011-04-22 17:47:43', 1, 1, 1, 8)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 14ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tab_components/create/8?tab_component%5Bcolumn%5D=1&tab_component%5Bfull_line%5D=true&tab_component%5Bline%5D=5&tab_component%5Btab_id%5D=1]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m


Processing Company::TabComponentsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;36;1mTabComponent Delete all (0.5ms)[0m   [0;1mDELETE FROM `tab_components` WHERE (`id` IN (148646006)) [0m
Completed in 7ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tab_components/destroy/5]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabComponentsController#create (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "tab_component"=>{"line"=>5, "column"=>1, "full_line"=>true, "tab_id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", order: 1.0>}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;36;1mTabComponent Load (0.2ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;35;1mTabComponent Delete all (0.1ms)[0m   [0mDELETE FROM `tab_components` WHERE (`id` IN (148646006)) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTabComponent Create (0.3ms)[0m   [0;1mINSERT INTO `tab_components` (`created_at`, `line`, `updated_at`, `column`, `full_line`, `tab_id`, `component_id`) VALUES('2011-04-22 17:47:43', 5, '2011-04-22 17:47:43', 1, 1, 1, 5)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 9ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tab_components/create/5?tab_component%5Bcolumn%5D=1&tab_component%5Bfull_line%5D=true&tab_component%5Bline%5D=5&tab_component%5Btab_id%5D=1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tab_components` [0m


Processing Company::TabComponentsController#update (for 0.0.0.0 at 2011-04-22 14:47:43) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "full_line"=>true}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Update (0.4ms)[0m   [0mUPDATE `tab_components` SET `updated_at` = '2011-04-22 17:47:43', `full_line` = 1 WHERE `id` = 148646006[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 9ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tab_components/update/5?full_line=true]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponentText Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) AND ( (`components`.`type` = 'ComponentText' ) ) [0m
  [4;35;1mTabComponent Load (0.6ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tabs` [0m


Processing Company::TabsController#create (for 0.0.0.0 at 2011-04-22 14:47:44) [POST]
  Parameters: {"tab"=>{"title"=>"Aba 1"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Create (0.2ms)[0m   [0;1mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:47:44', 'Aba 1', '2011-04-22 17:47:44', NULL, 1)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 12ms (View: 1, DB: 5) | 200 OK [http://test.host/company/tabs/create?tab%5Btitle%5D=Aba+1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:44) [POST]
  Parameters: {"id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", order: 1.0>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 1) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 9ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tabs/destroy/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mTab Load (0.2ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2) [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabsController#reorder (for 0.0.0.0 at 2011-04-22 14:47:44) [POST]
  Parameters: {"tab_ids"=>[#<Tab id: 2, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", order: 2.0>, #<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", order: 1.0>]}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTab Load (0.4ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 2) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Update (0.3ms)[0m   [0;1mUPDATE `tabs` SET `updated_at` = '2011-04-22 17:47:44', `order` = 1.0 WHERE `id` = 2[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mTab Load (0.4ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 1) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Update (0.3ms)[0m   [0;1mUPDATE `tabs` SET `updated_at` = '2011-04-22 17:47:44', `order` = 2.0 WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 14ms (View: 0, DB: 7) | 200 OK [http://test.host/company/tabs/reorder?tab_ids%5B%5D=2&tab_ids%5B%5D=1]
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2) [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#edit (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (2.7ms)
Rendered company/accounts/_password (3.3ms)
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 27ms (View: 18, DB: 4) | 200 OK [http://test.host/company/users/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"user"=>{"login"=>nil}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL AND `users`.id <> 12) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx2@emp.com' AND `users`.id <> 12) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (1.3ms)
Rendered company/accounts/_password (1.8ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 26ms (View: 18, DB: 4) | 200 OK [http://test.host/company/users/update?user%5Blogin%5D=]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update_profile_logo (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"company"=>{}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20006' AND `companies`.id <> 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
Rendered company/accounts/_form (1.3ms)
Rendered company/accounts/_password (1.6ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 23ms (View: 14, DB: 3) | 200 OK [http://test.host/company/users/update_profile_logo?]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 12) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx2@emp.com' AND `users`.id <> 12) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:44', `login` = 'quentin2' WHERE `id` = 12[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (1.2ms)
Rendered company/accounts/_password (1.4ms)
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 22ms (View: 13, DB: 4) | 200 OK [http://test.host/company/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUserAdministrator Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mCompany Load (0.8ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_to_z (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyS Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) AND ( (`companies`.`type` = 'CompanyS' ) ) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
Rendering template within layouts/new_admin
Rendering company_management/change_to_z
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 141ms (View: 131, DB: 10) | 200 OK [http://test.host/company_management/change_to_z/4-MyString]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing CompanyManagementController#change_type_to_s (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyZ Update (0.3ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:47:44', `type` = 'CompanyS' WHERE `id` = 7[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:44', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_s\nargs: \n- LOAD;CompanyZ;7\n', '2011-04-22 17:47:44', 0, '2011-04-22 17:47:44', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.6ms)
Rendered companies/_company_show (7.4ms)
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (9.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 41ms (View: 29, DB: 7) | 200 OK [http://test.host/company_management/change_type_to_s/7-MyString]
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"company"=>{"register_number"=>"TESTESTESTES"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;36;1mCompanyS Update (0.4ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:47:44', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:44', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:47:44', 0, '2011-04-22 17:47:44', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (5.7ms)
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUserWebAdministrator Columns (1.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (8.3ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 51ms (View: 21, DB: 12) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bregister_number%5D=TESTESTESTES]
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"company"=>{"parcel"=>1, "register_number"=>"TESTESTESTES", "value"=>50.0}, "person"=>{"cpf"=>"099.033.907-69"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.3ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:47:44', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:44', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:47:44', 0, '2011-04-22 17:47:44', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(1, '2011-04-22 17:47:44', '2011-04-22 17:47:41', '2011-04-22 17:47:44', 50.0, 4, '2012-04-22 17:47:41', 'Aberto')[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:44', `cpf` = '099.033.907-69' WHERE `id` = 9[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (5.9ms)
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (6.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 47ms (View: 19, DB: 11) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bparcel%5D=1&company%5Bregister_number%5D=TESTESTESTES&company%5Bvalue%5D=50.0&person%5Bcpf%5D=099.033.907-69]
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 23ms (View: 17, DB: 4) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IN (12,7,8,5)) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 152ms (View: 142, DB: 8) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 16ms (View: 9, DB: 4) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"id"=>"8"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '8') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` WHERE (`companies`.`id` = 5) [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/8]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"id"=>"XXX"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 'XXX') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/company_management
Completed in 2ms (DB: 1) | 302 Found [http://test.host/company_management/loggin_as_company/XXX]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  Parameters: {"id"=>"5"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggout_as_company (for 0.0.0.0 at 2011-04-22 14:47:44) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Redirected to http://test.host/
Completed in 1ms (DB: 1) | 302 Found [http://test.host/company_management/loggout_as_company]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#edit (for 0.0.0.0 at 2011-04-22 14:47:44) [PUT]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering company_management/edit
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered companies/_company_edit (4.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 14, DB: 2) | 200 OK [http://test.host/company_management/edit/5-MyString]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#update (for 0.0.0.0 at 2011-04-22 14:47:44) [PUT]
  Parameters: {"company"=>{}, "id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management/show/5-MyString
Completed in 7ms (DB: 2) | 302 Found [http://test.host/company_management/update/5-MyString?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 3 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 3) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.3ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:47:44', 0, 3, '2011-04-22 17:47:44')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (174.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.5ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing CompanySellerController#create (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"company"=>{"person_id"=>1}, "id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:45', `user_web_adm_id` = NULL WHERE `id` = 7[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20004' AND `companies`.id <> 3) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.3ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:47:45', `person_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 23ms (DB: 187) | 302 Found [http://test.host/company_seller/create/3?company%5Bperson_id%5D=1]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing CompanySellerController#destroy (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompanyZ Update (0.3ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:47:45', `person_id` = NULL WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 8ms (DB: 4) | 302 Found [http://test.host/company_seller/destroy/5-MyString]
  [4;35;1mCompanyZ Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mUserSegmentManager Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mPerson Load (1.0ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.7ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering company_seller/new
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 19ms (View: 11, DB: 7) | 200 OK [http://test.host/company_seller/new/3]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"id"=>"XXXXX"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 0) [0m
Redirected to http://test.host/company_management
Completed in 2ms (DB: 2) | 302 Found [http://test.host/company_seller/new/XXXXX]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ8235') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:47:45', NULL, '2011-04-22 17:47:45', '76.633.274/0001-80', NULL, NULL, NULL, 'CompanyS', 'SZ8235', NULL, 'MyString', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 20) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.3ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('MyString', NULL, NULL, '2011-04-22 17:47:45', NULL, NULL, '2011-04-22 17:47:45', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 20, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 15) LIMIT 1[0m
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 15, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:45', `name` = 'MyString', `created_at` = '2011-04-22 17:47:45', `company_id` = 20 WHERE `id` = 15[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 15, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:47:45', `layout_id` = NULL WHERE `id` = 980190983[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:45', 0, '2011-04-22 17:47:45', 0, 1, 20, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:45', '2011-04-22 17:47:45', 20, 22)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 20) [0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:47:45' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.5ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:47:45' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:47:38' and our_number is not null)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyToFriendController#create (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"email_from"=>"bruno_sil@yahoo.com.br", "company_id"=>"5", "name_from"=>"Bruno Siqueira", "email_to"=>"bsiqueira@gmail.com"}
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:45', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_new_send_to_friend\nargs: \n- bsiqueira@gmail.com\n- LOAD;CompanyZ;5\n', '2011-04-22 17:47:45', 0, '2011-04-22 17:47:45', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:45', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 13ms (View: 0, DB: 16) | 200 OK [http://test.host/company_to_friend?company_id=5&email_from=bruno_sil%40yahoo.com.br&email_to=bsiqueira%40gmail.com&name_from=Bruno+Siqueira]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Assigning #<File:test/resources/images/rails.png> to photo
[paperclip] Writing attributes for photo
[paperclip] Post-processing photo
  [4;36;1mComponentGallery Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:47:45', NULL, NULL, NULL, '2011-04-22 17:47:45', 1, 0, NULL, 1, 'ComponentGallery', NULL, 1, NULL, 1, NULL, 2, 1)[0m
  [4;35;1mPicture Create (0.3ms)[0m   [0mINSERT INTO `pictures` (`created_at`, `photo_file_size`, `title`, `updated_at`, `photo_file_name`, `photo_content_type`, `description`, `component_id`, `component_type`) VALUES('2011-04-22 17:47:45', 6646, NULL, '2011-04-22 17:47:45', 'rails.png', 'image/png', NULL, 16, 'Component')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/5/big/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/5/thumb/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/5/original/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/5/normal/rails.png
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:45', `font_colors` = '0x00000a;0x333333' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:47:45', `description` = ' bruno sqiueira COLOR=\"#000000\" oiasjdosadijoasidjasoij COLOR=\"#333333\" COLOR=\"#00000a\" ' WHERE `id` = 5[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mComponentPicture Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:47:45', `title` = 'ola' WHERE `id` = 7[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mFeedItem Load (0.3ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for picture
[paperclip] Deleting files for picture
[paperclip] Writing files for picture
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mContract Load Including Associations (0.8ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:47:45' and end_date>='2011-04-22 14:47:45') [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:47:45) [POST]
  Parameters: {"contract"=>{"parcel"=>12, "initial_date"=>"2008-02-12", "value"=>50.0, "status"=>"Aberto", "end_date"=>"2009-02-12"}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.2ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:47:45', '2008-02-12', '2011-04-22 17:47:45', 50.0, 4, '2009-02-12', 'Aberto')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/15
Completed in 14ms (DB: 17) | 302 Found [http://test.host/companies/4-MyString/contracts?contract%5Bend_date%5D=2009-02-12&contract%5Binitial_date%5D=2008-02-12&contract%5Bparcel%5D=12&contract%5Bstatus%5D=Aberto&contract%5Bvalue%5D=50.0]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m


Processing ContractsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:45) [DELETE]
  Parameters: {"id"=>#<Contract id: 4, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.8ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 4[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts
Completed in 12ms (DB: 6) | 302 Found [http://test.host/companies/4-MyString/contracts/4]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#edit (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/edit
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 33ms (View: 29, DB: 4) | 200 OK [http://test.host/companies/4-MyString/contracts/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#index (for 0.0.0.0 at 2011-04-22 14:47:45) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/index
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 168ms (View: 163, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts]
  [4;35;1mContract Load (0.6ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#new (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 20, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts/new]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:47:46) [POST]
  Parameters: {"contract"=>{}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 32ms (View: 26, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts?]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#show (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/show
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (titles.status<>'Liquidado')) [0m
Rendered titles/_title (0.9ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.3ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (`titles`.`status` = 'Liquidado')) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 18, DB: 4) | 200 OK [http://test.host/companies/4-MyString/contracts/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#update (for 0.0.0.0 at 2011-04-22 14:47:46) [PUT]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", value: 50.0, parcel: 12>, "contract"=>{}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/1
Completed in 7ms (DB: 3) | 302 Found [http://test.host/companies/4-MyString/contracts/1?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing DomainsController#update (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"id"=>"8", "value"=>"empresa.com.br"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:46', `domain` = 'empresa.com.br' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 13ms (View: 0, DB: 3) | 200 OK [http://test.host/domains/update/8?value=empresa.com.br]
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mFeedItem Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mFeedLike Load (0.4ms)[0m   [0;1mSELECT `feed_likes`.id FROM `feed_likes` WHERE (`feed_likes`.`company_id` = 7 AND `feed_likes`.feed_item_id = 1) LIMIT 1[0m
  [4;35;1mFeedLike Create (0.4ms)[0m   [0mINSERT INTO `feed_likes` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:46', '2011-04-22 17:47:46', 7, 1)[0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mFeedItem Update (0.4ms)[0m   [0mUPDATE `feed_items` SET `feed_likes_count` = COALESCE(`feed_likes_count`, 0) + 1 WHERE (`id` = 1) [0m
  [4;36;1mFeedItem Update (0.2ms)[0m   [0;1mUPDATE `feed_items` SET `updated_at` = '2011-04-22 17:47:46' WHERE `id` = 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;35;1mFeedItem Load (0.3ms)[0m   [0mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;36;1mSQL (105.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:47:46' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.6ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:47:46' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 29ms (View: 16, DB: 115) | 200 OK [http://test.host/financial/company_no_active_contracts]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"id"=>[]}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.8ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:47:46' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompanyZ Load Including Associations (0.7ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:47:46' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 138ms (View: 9, DB: 3) | 200 OK [http://test.host/financial/company_no_active_contracts/index/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load (0.6ms)[0m   [0;1mSELECT distinct companies.* as companies FROM `companies` join titles as titles on titles.company_id = companies.id WHERE (titles.status <> 'Liquidado' and titles.due_date < '2011-04-22 14:47:46' and your_number is not null) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/index
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 12, DB: 4) | 200 OK [http://test.host/financial/company_not_payed]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Financial::CompanyNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT `contracts`.* FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/show
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mAddress Load (0.5ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.4ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:47:38' and our_number is not null)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 16, DB: 5) | 200 OK [http://test.host/financial/company_not_payed/show/7-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"month"=>"4"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mContract Load Including Associations (0.7ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:47:46' and end_date>='2011-04-22 14:47:46') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-05-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:47:46', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:47:46', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-05-22 00:00:00', 0.2, '2011-04-22 14:47:46', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 8, DB: 4) | 200 OK [http://test.host/financial/main/generate_new_titles?month=4]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"month"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mContract Load Including Associations (0.6ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-03-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:47:46' and end_date>='2011-04-22 14:47:46') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-04-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:47:46', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:47:46', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-04-22 00:00:00', 0.2, '2011-04-22 14:47:46', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 8, DB: 6) | 200 OK [http://test.host/financial/main/generate_new_titles?month=3]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:47:46) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COB01.TXT>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33336' AND `titles`.`due_date` = '2009-05-13') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33333' AND `titles`.`due_date` = '2009-05-15') LIMIT 1[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33335' AND `titles`.`due_date` = '2009-05-02') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33310' AND `titles`.`due_date` = '2009-05-07') LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33337' AND `titles`.`due_date` = '2009-05-08') LIMIT 1[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '827495320r' AND `titles`.`due_date` = '2009-03-20') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 10, DB: 5) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x1062ec258%3E]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:47:46) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COBERROR.TXT>}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 10ms (View: 7, DB: 1) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x1062147b8%3E]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#new (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 2) | 200 OK [http://test.host/financial/receive_return/new]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::SendShippingController#index (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`status` = 'Aberto') [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/index
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 2)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 22ms (View: 13, DB: 3) | 200 OK [http://test.host/financial/send_shipping]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#create (for 0.0.0.0 at 2011-04-22 14:47:46) [PUT]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`processing_date` = '2011-04-22 14:47:46' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;36;1mShipping Update (0.2ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:47:46', `processing_date` = '2011-04-22 14:47:46' WHERE `id` = 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.5ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mUserDirector Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUserDirector Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
  [4;35;1mUserAdministrator Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
Sent mail to quentin@example.com, quentin@example.com

Date: Fri, 22 Apr 2011 14:47:46 -0300
From: bsiqueira@suaempreza.com.br
To: quentin@example.com,
	 quentin@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D=3A_Gera=C3=A7=C3=A3o_de_Cobran=C3=A7a?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1>Envio de Remessa</h1>
<p>
  C√≥digo da Remessa: MyString
</p>

<p>
  Quantidade de T√≠tulos: 2
</p>

<p>
  Valor da Remessa: 3,00
</p>

<p>
  Voc√™ pode realizar o download do arquivo remessa no endere√ßo:<br>
  <a href="http://localhost:3000/financial/shippings/1">http://localhost:3000/financial/shippings/1</a>
</p>
<small>
  O envio da remessa para o banco deve ser realizado ainda na data corrente.
</small>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:46', `status` = 'Enviado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:46', `status` = 'Enviado' WHERE `id` = 3[0m
  [4;36;1mShipping Update (0.3ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:47:46', `file_name` = 'MyString_2204111447.txt', `file_content_type` = 'text/plain', `file_data` = x'303152454d455353413031434f4252414e434120202020202020303033343330353733393639342020202020202043c3a96c756c61204950202020202020202020202020202020202020202033353642616e636f205265616c20202020203232303431313031363030425049202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030310a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030382020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030320a383130303334333035373339363934323175303030382020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030330a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030372020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030340a383130303334333035373339363934323175303030372020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030350a393030303030323030303030303030303033303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030360a' WHERE `id` = 1[0m
  [4;35;1mShipping Update (0.3ms)[0m   [0mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:47:46', `status` = 'Enviado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 170ms (View: 8, DB: 13) | 200 OK [http://test.host/financial/send_shipping/create/1]
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (1.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#show (for 0.0.0.0 at 2011-04-22 14:47:46) [GET]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 5) | 200 OK [http://test.host/financial/send_shipping/show/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mShipping Load (0.1ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.2ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:47:47', '2011-04-22 17:47:47', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.3ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:47:47', '2011-04-22 17:47:47', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.`id` = 964567536) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Digitado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567536[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m


Processing Financial::ShippingsController#create (for 0.0.0.0 at 2011-04-22 14:47:47) [POST]
  Parameters: {"shipping"=>{}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` IS NULL) LIMIT 1[0m
  [4;35;1mShipping Create (0.2ms)[0m   [0mINSERT INTO `shippings` (`created_at`, `code`, `updated_at`, `file_content_type`, `file_data`, `file_name`, `processing_date`, `status`) VALUES('2011-04-22 17:47:47', NULL, '2011-04-22 17:47:47', NULL, NULL, NULL, NULL, 'Aberto')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/6
Completed in 9ms (DB: 15) | 302 Found [http://test.host/financial/remessas?]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:47) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE (our_number is not null) AND ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mShipping Destroy (0.2ms)[0m   [0mDELETE FROM `shippings` WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas
Completed in 14ms (DB: 6) | 302 Found [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#edit (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/edit
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
Rendered titles/_titles (8.3ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 17, DB: 6) | 200 OK [http://test.host/financial/remessas/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#index (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.1ms)[0m   [0mSELECT * FROM `shippings` [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/index
Rendered financial/shippings/_download (0.3ms)
Rendered financial/shippings/_download (0.1ms)
Rendered financial/shippings/_download (1.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 15, DB: 1) | 200 OK [http://test.host/financial/remessas]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#new (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/shippings/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 10, DB: 1) | 200 OK [http://test.host/financial/remessas/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#show (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendered financial/shippings/_download (0.1ms)
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((titles.status<>'Liquidado'))) [0m
Rendered titles/_title (0.5ms)
Rendered titles/_title (0.4ms)
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((`titles`.`status` = 'Liquidado'))) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 142ms (View: 138, DB: 4) | 200 OK [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.1ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#update (for 0.0.0.0 at 2011-04-22 14:47:47) [PUT]
  Parameters: {"id"=>"1", "shipping"=>{}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/1
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:47', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 13ms (DB: 4) | 302 Found [http://test.host/financial/remessas/1?]
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:47:47) [POST]
  Parameters: {"title"=>{"your_number"=>"SZ20002", "discount_type"=>"Sem desconto", "value"=>450.0, "due_date"=>"2009-05-05", "emission_date"=>"2009-05-01", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'SZ20002') LIMIT 1[0m
  [4;36;1mTitle Create (0.4ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(NULL, '2011-04-22 17:47:47', 'SZ20002', NULL, NULL, NULL, '2011-04-22 17:47:47', 'Sem desconto', NULL, NULL, NULL, 450.0, NULL, 5, '2009-05-05', NULL, '2009-05-01', NULL, NULL, NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/21
Completed in 18ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bvalue%5D=450.0&title%5Byour_number%5D=SZ20002]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:47:47) [POST]
  Parameters: {"title"=>{"fine_percent"=>"33,33", "your_number"=>"AZ924330", "abatement_value"=>"", "interest_type"=>"0", "discount_type"=>"Sem desconto", "value"=>"323,33", "interest_percent"=>"0,50", "due_date"=>"2009-05-05", "emission_date"=>"2009-05-01", "discount_value"=>"", "additional_data"=>"cdcscscsscdssd", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'AZ924330') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(33.33, '2011-04-22 17:47:47', 'AZ924330', NULL, NULL, 0.0, '2011-04-22 17:47:47', 'Sem desconto', '0', NULL, NULL, 323.33, NULL, 5, '2009-05-05', 0.5, '2009-05-01', 0.0, 'cdcscscsscdssd', NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/22
Completed in 12ms (DB: 4) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Babatement_value%5D=&title%5Badditional_data%5D=cdcscscsscdssd&title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdiscount_value%5D=&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bfine_percent%5D=33%2C33&title%5Binterest_percent%5D=0%2C50&title%5Binterest_type%5D=0&title%5Bvalue%5D=323%2C33&title%5Byour_number%5D=AZ924330]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 22) [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#destroy (for 0.0.0.0 at 2011-04-22 14:47:47) [DELETE]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles
Completed in 7ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#edit (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/edit
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 40ms (View: 35, DB: 4) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#index (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.6ms)[0m   [0;1mSELECT * FROM `titles` ORDER BY due_date desc LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 45ms (View: 40, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::TitlesController#index_new (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering financial/titles/index_new
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSegment Load (0.1ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 14, DB: 4) | 200 OK [http://test.host/financial/titles/index_new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#new (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/new
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 162ms (View: 34, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#show (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 16ms (View: 11, DB: 4) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#update (for 0.0.0.0 at 2011-04-22 14:47:47) [PUT]
  Parameters: {"title"=>{}, "id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-02-15' AND `titles`.your_number = '21u0005' AND `titles`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/1
Completed in 9ms (DB: 3) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) ORDER BY created_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering financial/titles_not_payed/index
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 24ms (View: 15, DB: 3) | 200 OK [http://test.host/titulos-nao-pagos?company_id=5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.1ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
Rendering financial/titles_not_payed/show
Completed in 22ms (View: 12, DB: 3) | 200 OK [http://test.host/financial/titles_not_payed/show/1?company_id=5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:47', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (2.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1 AND (components.id is not null)) [0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 3ms (DB: 7) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
Redirected to http://test.host/empresa-inicio
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 1ms (DB: 1) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
Rendering template within layouts/main
Rendering main/index
  [4;36;1mLayout Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `layouts`.id FROM `layouts` LEFT OUTER JOIN `companies` ON `companies`.id = `layouts`.company_id WHERE (companies.type = 'CompanyZ' and companies.id in (176,173,207,213,206,47,178,28,182)) ORDER BY layouts.updated_at LIMIT 8[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (1.2ms)
Completed in 20ms (View: 14, DB: 1) | 200 OK [http://test.host/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 2ms (DB: 1) | 302 Found [http://test.host/main/natal]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:47:47) [GET]
Rendering template within layouts/main
Rendering main/natal
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.8ms)
Completed in 7ms (View: 6, DB: 1) | 200 OK [http://test.host/main/natal]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m
  [4;35;1mMessageCopy Load (120.7ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mPhone Load (0.5ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.1ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m


Processing MessagesController#create (for 0.0.0.0 at 2011-04-22 14:47:48) [POST]
  Parameters: {"message"=>{"sender_email"=>"tester@gmail.com", "body"=>"Corpo da mensagem", "subject"=>"Teste - Mensagem enviada do business card", "to"=>"8"}}
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.3ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES('tester@gmail.com', '2011-04-22 17:47:48', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:47:48', 'Teste - Mensagem enviada do business card', NULL, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 11) [0m
  [4;35;1mMessageCopy Create (0.3ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:47:48', NULL, 8, NULL, NULL, 11)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:48', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;10\n', '2011-04-22 17:47:48', 0, '2011-04-22 17:47:48', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:48', 0, '2011-04-22 17:47:48', 0, 0, 11, 'Message')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:48', '2011-04-22 17:47:48', 5, 23)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 23ms (View: 0, DB: 131) | 200 OK [http://test.host/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender_email%5D=tester%40gmail.com&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+business+card&message%5Bto%5D=8]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing PasswordsController#new (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
Rendering template within layouts/e-mail
Rendering passwords/new
Completed in 6ms (View: 2, DB: 2) | 200 OK [http://test.host/esqueci-a-senha]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (19.9ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (5.7ms)
Rendered companies/_company (12.1ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 63ms (View: 47, DB: 7) | 200 OK [http://test.host/people_confirm/edit/9]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"13"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (16.2ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 30ms (View: 26, DB: 4) | 200 OK [http://test.host/people_confirm/edit/13]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"7"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:48', `user_create_id` = 6, `user_web_adm_id` = 6 WHERE `id` = 7[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
Sent mail to emp@emp.com

Date: Fri, 22 Apr 2011 14:47:48 -0300
From: bsiqueira@suaempreza.com.br
To: emp@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.6ms)
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (7.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 175ms (View: 27, DB: 13) | 200 OK [http://test.host/people_confirm/create/7]
  [4;35;1mSQL (1.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 12, DB: 6) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 14ms (View: 9, DB: 3) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.9ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 21ms (View: 15, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.7ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 18ms (View: 11, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:48', `user_confirm_id` = 4 WHERE `id` = 9[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Sent mail to empconf222@emp.com

Date: Fri, 22 Apr 2011 14:47:48 -0300
From: bsiqueira@suaempreza.com.br
To: empconf222@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa_first_confirm!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.6ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
Completed in 52ms (View: 25, DB: 15) | 200 OK [http://test.host/people_confirm/create/9]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.5ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.1ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.7ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (130.6ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 161ms (View: 150, DB: 10) | 200 OK [http://test.host/people_confirm/create/9]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#destroy (for 0.0.0.0 at 2011-04-22 14:47:48) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.4ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.4ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people_confirm
Completed in 9ms (DB: 4) | 302 Found [http://test.host/people_confirm/destroy/13]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#show (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"9"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (5.7ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (5.6ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 35ms (View: 26, DB: 10) | 200 OK [http://test.host/people_confirm/show/9]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.1ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 1) [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:47:48) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", enabled: true>, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString", "state"=>#<State id: 1, acronym: "AC", name: "Acre", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41">}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.2ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:48', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:47:48', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, 1, 'MyString', 'MyString', NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/41
Completed in 13ms (DB: 3) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate%5D=1&person%5Bsubsidiary_id%5D=1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:47:48) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:48', 6, '356.726.002-20', '2008-09-09', '2011-04-22 17:47:48', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 6)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/42
Completed in 11ms (DB: 4) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleController#destroy (for 0.0.0.0 at 2011-04-22 14:47:48) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.2ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.1ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.1ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people
Completed in 7ms (DB: 4) | 302 Found [http://test.host/people/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/edit
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (14.8ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Person') [0m
Rendered person_phone/_phones (6.5ms)
Rendered people/_sidebar (0.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 43ms (View: 38, DB: 6) | 200 OK [http://test.host/people/1/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#index (for 0.0.0.0 at 2011-04-22 14:47:48) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` as people left join user_people as up on people.id = up.person_id left join users as u on up.user_id = u.id and u.type <>'UserCompany' WHERE (user_confirm_id is not null ) ORDER BY people.name LIMIT 0, 30[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` IN (1,2,4)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people/index
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 11)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 2)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 195ms (View: 181, DB: 11) | 200 OK [http://test.host/people]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#new (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people/new
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.0ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 35ms (View: 29, DB: 5) | 200 OK [http://test.host/people/new]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#show (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/show
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (6.8ms)
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 14, DB: 4) | 200 OK [http://test.host/people/1]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#update (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/1
Completed in 8ms (DB: 3) | 302 Found [http://test.host/people/1?]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>""}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Completed in 11ms (View: 3, DB: 3) | 200 OK [http://test.host/person_phone/create/8?phone%5Bnumber%5D=]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>12345678, "ddd"=>17}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Create (0.4ms)[0m   [0mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(12345678, '2011-04-22 17:47:49', '2011-04-22 17:47:49', 17, NULL, NULL, 8, NULL)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered person_phone/_phone (2.5ms)
Completed in 9ms (View: 5, DB: 3) | 200 OK [http://test.host/person_phone/create/8?phone%5Bddd%5D=17&phone%5Bnumber%5D=12345678]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (2.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.2ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m


Processing PersonPhoneController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"id"=>"298486374"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPhone Load (0.1ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.2ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 298486374[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 3ms (View: 1, DB: 5) | 200 OK [http://test.host/person_phone/destroy/298486374]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (92.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mPicture Load (0.2ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.3ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:47:49', `title` = 'ola' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"email"=>"quentin@example.com"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (email='quentin@example.com' and activated_at is null) LIMIT 1[0m
Redirected to http://test.host/login
Completed in 5ms (DB: 99) | 302 Found [http://test.host/resend_activation_mail/create?email=quentin%40example.com]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"email"=>"gerente_geral@example.com"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (email='gerente_geral@example.com' and activated_at is null) LIMIT 1[0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:47:49 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 5ms (DB: 1) | 302 Found [http://test.host/resend_activation_mail/create?email=gerente_geral%40example.com]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ResendActivationMailController#new (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
Rendering template within layouts/e-mail
Rendering resend_activation_mail/new
Completed in 3ms (View: 3, DB: 0) | 200 OK [http://test.host/resend_activation_mail/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 9ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:49', `remember_token_expires_at` = '2011-05-06 17:47:49', `remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:49', `remember_token_expires_at` = '2011-05-06 17:47:49', `remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:49', `remember_token_expires_at` = '2011-04-22 17:42:49' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 3) | 302 Found [http://test.host/logout]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3') LIMIT 1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"login"=>"quentin", "password"=>"bad password"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
Redirected to http://test.host/
Completed in 2ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin&password=bad+password]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"login"=>"empresa", "password"=>"test"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'empresa' or email = 'empresa') LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
Redirected to http://test.host/
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa&password=test]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"login"=>"quentin", "password"=>"test"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"login"=>"empresa_valid", "password"=>"test"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'empresa_valid' or email = 'empresa_valid') LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Redirected to http://test.host/empresa-inicio
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa_valid&password=test]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:49', `remember_token_expires_at` = '2011-05-06 17:47:49', `remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#new (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:not_logged_in_required] rendered_or_redirected.
Completed in 2ms (DB: 2) | 302 Found [http://test.host/sessao/new]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"login"=>"quentin@example.com", "password"=>"test"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin@example.com' or email = 'quentin@example.com') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin%40example.com&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 4ms (DB: 1) | 302 Found [http://test.host/logout]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"remember_me"=>"0", "login"=>"quentin", "password"=>"test"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=0]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"remember_me"=>"1", "login"=>"quentin", "password"=>"test"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:49', `remember_token_expires_at` = '2011-05-06 17:47:49', `remember_token` = '19bb7c3f8126748388913324d6486c77036c5ef3' WHERE `id` = 1[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:49', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 18ms (DB: 4) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=1]
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.1ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", enabled: true>, "state"=>#<State id: 21, acronym: "RS", name: "Rio Grande do Sul", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41">}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 21) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Create (0.2ms)[0m   [0mINSERT INTO `subsidiary_states` (`created_at`, `updated_at`, `subsidiary_id`, `state_id`) VALUES('2011-04-22 17:47:49', '2011-04-22 17:47:49', 1, 21)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 33ms (View: 17, DB: 7) | 200 OK [http://test.host/subsidiaries/change_range/1?state=21]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m


Processing SubsidiariesController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"subsidiary"=>{"title"=>"teste"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'teste') LIMIT 1[0m
  [4;35;1mSubsidiary Create (0.3ms)[0m   [0mINSERT INTO `subsidiaries` (`created_at`, `title`, `updated_at`, `enabled`) VALUES('2011-04-22 17:47:49', 'teste', '2011-04-22 17:47:49', 1)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/7
Completed in 5ms (DB: 3) | 302 Found [http://test.host/filiais?subsidiary%5Btitle%5D=teste]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m


Processing SubsidiariesController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [DELETE]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` WHERE (`people`.subsidiary_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Load (0.3ms)[0m   [0mSELECT * FROM `subsidiary_states` WHERE (`subsidiary_states`.subsidiary_id = 3) [0m
  [4;36;1mSubsidiary Destroy (0.3ms)[0m   [0;1mDELETE FROM `subsidiaries` WHERE `id` = 3[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais
Completed in 5ms (DB: 4) | 302 Found [http://test.host/filiais/3]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#edit (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit
Rendered subsidiaries/_form (2.5ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 10, DB: 3) | 200 OK [http://test.host/filiais/1/editar]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#index (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/index
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 21ms (View: 18, DB: 2) | 200 OK [http://test.host/filiais]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#new (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/new
Rendered subsidiaries/_form (2.0ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/filiais/nova]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", enabled: true>, "state"=>#<State id: 19, acronym: "RJ", name: "Rio de Janeiro", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41">}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 19) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiaryState Delete all (0.2ms)[0m   [0;1mDELETE FROM `subsidiary_states` WHERE (`subsidiary_states`.`subsidiary_id` = 1 AND `subsidiary_states`.`state_id` = 19) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 25ms (View: 15, DB: 6) | 200 OK [http://test.host/subsidiaries/change_range/1?state=19]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#show (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/show
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 3) | 200 OK [http://test.host/filiais/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#update (for 0.0.0.0 at 2011-04-22 14:47:49) [PUT]
  Parameters: {"subsidiary"=>{"title"=>"123"}, "id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY '123' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSubsidiary Update (0.4ms)[0m   [0;1mUPDATE `subsidiaries` SET `updated_at` = '2011-04-22 17:47:49', `title` = '123' WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/1
Completed in 7ms (DB: 3) | 302 Found [http://test.host/filiais/1?subsidiary%5Btitle%5D=123]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m


Processing TemplateTextsController#create (for 0.0.0.0 at 2011-04-22 14:47:49) [POST]
  Parameters: {"template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Create (0.3ms)[0m   [0;1mINSERT INTO `template_texts` (`created_at`, `title`, `updated_at`, `content`) VALUES('2011-04-22 17:47:49', 'dadsas', '2011-04-22 17:47:49', 'fsdcsd')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190965
Completed in 10ms (DB: 3) | 302 Found [http://test.host/template_texts?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mTemplateText Load (0.1ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#destroy (for 0.0.0.0 at 2011-04-22 14:47:49) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTemplateText Destroy (0.3ms)[0m   [0mDELETE FROM `template_texts` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts
Completed in 3ms (DB: 3) | 302 Found [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#edit (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/edit
Rendered template_texts/_form (2.4ms)
Rendered template_texts/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 14ms (View: 12, DB: 3) | 200 OK [http://test.host/template_texts/980190962/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#index (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` [0m
Rendering template within layouts/new_admin
Rendering template_texts/index
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 14ms (View: 11, DB: 2) | 200 OK [http://test.host/template_texts]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#new (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering template_texts/new
Rendered template_texts/_form (1.9ms)
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 2) | 200 OK [http://test.host/template_texts/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#show (for 0.0.0.0 at 2011-04-22 14:47:49) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/show
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 14ms (View: 11, DB: 2) | 200 OK [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#update (for 0.0.0.0 at 2011-04-22 14:47:50) [PUT]
  Parameters: {"id"=>"980190962", "template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Update (0.3ms)[0m   [0;1mUPDATE `template_texts` SET `content` = 'fsdcsd', `updated_at` = '2011-04-22 17:47:50', `title` = 'dadsas' WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190962
Completed in 5ms (DB: 3) | 302 Found [http://test.host/template_texts/980190962?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 6) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:50', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 11) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1 and people.user_web_adm_id = 6) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 15) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 16) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUserCompany Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.5ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5, 7, 8, 12) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUserCompany Load IDs For Limited Eager Loading (0.8ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUserCompany Load Including Associations (0.9ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.4ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
  [4;36;1mUser Load Including Associations (0.5ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) AND `users`.id IN (6, 1) ORDER BY login[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `domain` = 'empresa.com' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (171.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` WHERE (`people`.user_web_adm_id = 6 AND (not exists (select up.* from user_people as up where people.id = up.person_id))) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('3c8df8f5ce7087b9371cca20d974ba8071be3809', '2011-04-22 17:47:50', NULL, NULL, NULL, '664fafbba286a1d72e66073d629ef690180c0a52', NULL, '2011-04-22 17:47:50', NULL, 'acf6668df2b36d711f0419d4aed5da1ff12b6357', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 46, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:50', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;46\n', '2011-04-22 17:47:50', 0, '2011-04-22 17:47:50', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('3c8df8f5ce7087b9371cca20d974ba8071be3809', '2011-04-22 17:47:50', NULL, NULL, NULL, '664fafbba286a1d72e66073d629ef690180c0a52', NULL, '2011-04-22 17:47:50', NULL, '3ca7bce5f29df002bc4363e9184be1c0f8907947', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 47, NULL)[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:50', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;47\n', '2011-04-22 17:47:50', 0, '2011-04-22 17:47:50', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 47) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;36;1mUserPerson Destroy (0.3ms)[0m   [0;1mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mVote Update (0.2ms)[0m   [0;1mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;35;1mFeedLike Load (0.2ms)[0m   [0mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;35;1mFeed Load (0.2ms)[0m   [0mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;36;1mFeed Destroy (0.3ms)[0m   [0;1mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;35;1mNews Load (0.3ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.4ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:50', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.3ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:50', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:50', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;35;1mShippingTitle Load (0.1ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:47:38' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.1ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mComponentText Destroy (0.1ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 5[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.3ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 6[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.4ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 7[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mPicture Load (0.4ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.2ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.1ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;35;1mComponentGallery Destroy (0.1ms)[0m   [0mDELETE FROM `components` WHERE `id` = 8[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;35;1mComponentForm Destroy (0.1ms)[0m   [0mDELETE FROM `components` WHERE `id` = 9[0m
  [4;36;1mComponentGallery Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.2ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mTab Destroy (0.3ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;36;1mTab Destroy (0.4ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;35;1mColor Load (0.5ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;36;1mBanner Load (0.4ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;35;1mBackgroundTop Load (0.3ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;36;1mBackground Load (0.3ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.3ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mPhone Destroy (0.3ms)[0m   [0;1mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mAddress Destroy (0.2ms)[0m   [0;1mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;35;1mCompanyService Load (0.3ms)[0m   [0mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.1ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Destroy (0.1ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.3ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;36;1mMessageCopy Destroy (0.2ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;35;1mMessage Destroy (0.3ms)[0m   [0mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;36;1mFolder Load (0.1ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;35;1mFolder Load (0.1ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;36;1mFolder Destroy (0.1ms)[0m   [0;1mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.2ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `login` = 'quentin2' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin2' or email = 'quentin2') LIMIT 1[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `remember_token_expires_at` = '2011-05-06 17:47:50', `remember_token` = '21cf2ca008c33d152070b1385a2b2b4ee503d0cf' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `remember_token_expires_at` = '2011-04-29 17:47:50', `remember_token` = '43142329e58972367bde414a093eb915f2a3ab95' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `remember_token_expires_at` = '2011-04-29 17:47:50', `remember_token` = '43142329e58972367bde414a093eb915f2a3ab95' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `crypted_password` = '4b6dd603c64f03bc2f676658e287094878df9603' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:50', `remember_token_expires_at` = '2011-05-06 17:47:50', `remember_token` = '21cf2ca008c33d152070b1385a2b2b4ee503d0cf' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:51', `remember_token_expires_at` = '2011-05-06 17:47:51', `remember_token` = '27e117a54cbf9380dc7279d12c7c2cc5dd668718' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:51', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno com espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno_sem_espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno-sem-espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno12345434543comnumeros323') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'comcaract√©resespeciais') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUser Load Including Associations (0.7ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load Including Associations (0.7ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing UsersController#create_page_2 (for 0.0.0.0 at 2011-04-22 14:47:51) [POST]
  Parameters: {"company"=>{"person_id"=>8}, "person"=>{"user_web_adm_id"=>#<UserWebAdministrator id: 6, login: "admin_web", email: "mg@mg2.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:47:40", updated_at: "2011-04-22 17:47:41", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:47:40", password_reset_code: nil, enabled: true, type: "UserWebAdministrator", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}, "id"=>"8"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:51', `user_web_adm_id` = 6 WHERE `id` = 10[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompanyZ Update (0.5ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:47:51', `person_id` = 8 WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 27ms (DB: 296) | 302 Found [http://test.host/users/create_page_2/8?company%5Bperson_id%5D=8&person%5Buser_web_adm_id%5D=6]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:51) [POST]
  Parameters: {"person"=>{"name"=>"gerente_geral", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:47:41 UTC 2011, "updated_at"=>Fri Apr 22 17:47:41 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"898.361.554-06", "id"=>4, "user_id"=>nil, "subsidiary_id"=>"1", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '898.361.554-06') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.2ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('1b2c3b74903004ee14659345bfb69b20152248f6', '2011-04-22 17:47:51', NULL, NULL, NULL, 'c65f8a7798d8e69b65612a068a7a199fd3430a33', NULL, '2011-04-22 17:47:51', NULL, '7ce690c1926a5a79c54c1b8f310b4598a1667824', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 48, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;48\n', '2011-04-22 17:47:51', 0, '2011-04-22 17:47:51', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 48) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:51', '2011-04-22 17:47:51', 48, 4)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 48) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 48 AND `user_people`.id <> 956136650) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 48)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 48) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 48) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:51', `user_id` = 48 WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '7ce690c1926a5a79c54c1b8f310b4598a1667824') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.5ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:51', `activated_at` = '2011-04-22 17:47:51' WHERE `id` = 48[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;48\n', '2011-04-22 17:47:51', 0, '2011-04-22 17:47:51', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (4.7ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (137.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 222ms (View: 169, DB: 18) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=898.361.554-06&person%5Bcreated_at%5D=Fri+Apr+22+17%3A47%3A41+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=4&person%5Bname%5D=gerente_geral&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=1&person%5Bupdated_at%5D=Fri+Apr+22+17%3A47%3A41+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 10) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:51) [POST]
  Parameters: {"person"=>{"name"=>"empresa_valid", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:47:41 UTC 2011, "updated_at"=>Fri Apr 22 17:47:41 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"573.683.830-39", "id"=>10, "user_id"=>nil, "subsidiary_id"=>"2", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '573.683.830-39') LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (18.2ms)
Rendered people/_person (18.9ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.7ms)
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 47ms (View: 35, DB: 7) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=573.683.830-39&person%5Bcreated_at%5D=Fri+Apr+22+17%3A47%3A41+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=10&person%5Bname%5D=empresa_valid&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=2&person%5Bupdated_at%5D=Fri+Apr+22+17%3A47%3A41+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  Parameters: {"id"=>#<UserCompany id: 8, login: "empresa_valid", email: "empconfxx@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:47:40", updated_at: "2011-04-22 17:47:41", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:47:40", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- empresa_valid\n- administrator\n', '2011-04-22 17:47:51', 0, '2011-04-22 17:47:51', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mVote Update (0.4ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.4ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;36;1mFeed Load (0.4ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;35;1mFeed Destroy (0.4ms)[0m   [0mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;36;1mNews Load (0.4ms)[0m   [0;1mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.3ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:51', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:51', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:47:51', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:47:38' and our_number is not null)) [0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.4ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;35;1mComponentText Destroy (0.5ms)[0m   [0mDELETE FROM `components` WHERE `id` = 5[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.3ms)[0m   [0mDELETE FROM `components` WHERE `id` = 6[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.3ms)[0m   [0mDELETE FROM `components` WHERE `id` = 7[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;35;1mPicture Load (0.3ms)[0m   [0mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.3ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.2ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;36;1mComponentGallery Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 8[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 9[0m
  [4;35;1mComponentGallery Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.3ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;35;1mBanner Load (0.3ms)[0m   [0mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;36;1mBackgroundTop Load (0.3ms)[0m   [0;1mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;35;1mBackground Load (0.3ms)[0m   [0mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;36;1mPhone Load (0.2ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;35;1mLayout Destroy (0.3ms)[0m   [0mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mPhone Destroy (0.4ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.4ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;36;1mCompanyService Load (0.4ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;35;1mCompanyRelationship Load (0.4ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Destroy (0.3ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;35;1mCompanyRelationship Destroy (0.3ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;36;1mCompanyZ Destroy (0.2ms)[0m   [0;1mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;36;1mMessage Destroy (0.2ms)[0m   [0;1mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;35;1mMessageCopy Load (0.4ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mMessageCopy Destroy (0.3ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;36;1mFolder Load (0.1ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;35;1mFolder Destroy (0.1ms)[0m   [0mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.2ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 232ms (DB: 34) | 302 Found [http://test.host/usuarios/8]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (1.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:47:40", updated_at: "2011-04-22 17:47:41", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:47:40", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Redirected to http://test.host/usuarios
Completed in 2ms (DB: 4) | 302 Found [http://test.host/usuarios/12]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- administrator\n', '2011-04-22 17:47:51', 0, '2011-04-22 17:47:51', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.3ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 14ms (DB: 6) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:47:40", updated_at: "2011-04-22 17:47:41", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:47:40", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- \"empres\\xC3\\xA3 _&valid_2\"\n- administrator\n', '2011-04-22 17:47:51', 0, '2011-04-22 17:47:51', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 956136629[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 12) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 7) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 7) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;36;1mBusiness Destroy (0.3ms)[0m   [0;1mDELETE FROM `businesses` WHERE `id` = 298486374[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mFeed Load (0.4ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 7) [0m
  [4;35;1mNews Load (0.4ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 7) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 2[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.4ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 3[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7) [0m
  [4;35;1mTitle Load (0.1ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:47:38' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) [0m
  [4;36;1mTabComponent Load (0.6ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 1) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.4ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 956136629[0m
  [4;36;1mComponentText Destroy (0.4ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 1[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 2) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.3ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 2[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 3) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.2ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 997002036[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 3[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 4) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.2ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 208288675[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 4[0m
  [4;35;1mComponentGallery Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.3ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 3[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 4[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 2) LIMIT 1[0m
  [4;35;1mColor Destroy (0.2ms)[0m   [0mDELETE FROM `colors` WHERE `id` = 980190962[0m
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
  [4;35;1mBackgroundTop Load (0.3ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 2) [0m
  [4;36;1mBackground Load (0.3ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 2) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.2ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 2[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.4ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 7[0m
  [4;36;1mCompanyService Load (0.4ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 7) [0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 980190962[0m
  [4;36;1mCompanyService Destroy (0.4ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 298486374[0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 113629430[0m
  [4;36;1mCompanyService Destroy (0.4ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 281110143[0m
  [4;35;1mCompanyService Destroy (0.4ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 1018350795[0m
  [4;36;1mCompanyService Destroy (0.4ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 51848956[0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 374648174[0m
  [4;36;1mCompanyService Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 638205575[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 7) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.3ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 7[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 12 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 12 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 12) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 12) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mUserCompany Destroy (0.3ms)[0m   [0;1mDELETE FROM `users` WHERE `id` = 12[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 209ms (DB: 27) | 302 Found [http://test.host/usuarios/12]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (1.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:51', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- gerente_segmento\n', '2011-04-22 17:47:51', 0, '2011-04-22 17:47:51', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.2ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.2ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 16ms (DB: 9) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.5ms)
Rendered people/_person (15.8ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 33ms (View: 28, DB: 5) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:47:51) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.4ms)
Rendered people/_person (15.7ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 31ms (View: 27, DB: 3) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:47:52) [GET]
  Parameters: {"type"=>"UserCompany"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (13.7ms)
Rendered people/_person (14.1ms)
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (4.6ms)
Rendered companies/_company (12.2ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 44ms (View: 40, DB: 4) | 200 OK [http://test.host/signup?type=UserCompany]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:52) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('903cd2a671f58425b91a3770f2a690d2b74dbb56', '2011-04-22 17:47:52', NULL, NULL, NULL, '2ccc1e090380ab389e83bde83bfb1bfed7dd929e', NULL, '2011-04-22 17:47:52', NULL, '42b287def829fb0028af513faea5d6d7994de910', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 49, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:52', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;49\n', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 49) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 49) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:52', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:47:52', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 49) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.2ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:52', '2011-04-22 17:47:52', 49, 43)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 49) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 49 AND `user_people`.id <> 956136651) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 49)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 49) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 49) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 43)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=43) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 43)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 43)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 43)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 43)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:52', `user_id` = 49 WHERE `id` = 43[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '42b287def829fb0028af513faea5d6d7994de910') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:52', `activated_at` = '2011-04-22 17:47:52' WHERE `id` = 49[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:52', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;49\n', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (3.1ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 79ms (View: 30, DB: 13) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 49) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (3.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:52) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('903cd2a671f58425b91a3770f2a690d2b74dbb56', '2011-04-22 17:47:52', NULL, NULL, NULL, '2ccc1e090380ab389e83bde83bfb1bfed7dd929e', NULL, '2011-04-22 17:47:52', NULL, '3a9cd0ee929b04a369c5ada128f312bab5409949', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 50, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:52', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;50\n', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 0, NULL, NULL)[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 50) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 50) LIMIT 1[0m
  [4;35;1mPerson Create (0.2ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:52', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:47:52', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.5ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 50) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.4ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:52', '2011-04-22 17:47:52', 50, 44)[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=44) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 50) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 50) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (12.9ms)
Rendered people/_person (13.3ms)
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.5ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (10.5ms)
Rendered companies/_company (28.1ms)
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.6ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 229ms (View: 51, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:47:52) [GET]
  Parameters: {"user"=>{"login"=>""}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY '' AND `users`.id <> 4) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'mg@mg.com' AND `users`.id <> 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 4) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering users/edit
Rendered people/_person_edit (14.1ms)
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (4.1ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 56ms (View: 42, DB: 6) | 200 OK [http://test.host/users/update?user%5Blogin%5D=]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:47:52) [GET]
  Parameters: {"id"=>#<UserSegmentManager id: 4, login: "gerente_segmento", email: "mg@mg.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:47:40", updated_at: "2011-04-22 17:47:41", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:47:40", password_reset_code: nil, enabled: true, type: "UserSegmentManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
Redirected to http://test.host/usuarios
Completed in 2ms (DB: 1) | 302 Found [http://test.host/users/resend_signup_mail/4]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:52) [POST]
  Parameters: {"company"=>{"parcel"=>12, "segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "value"=>50.0, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('903cd2a671f58425b91a3770f2a690d2b74dbb56', '2011-04-22 17:47:52', NULL, NULL, NULL, '2ccc1e090380ab389e83bde83bfb1bfed7dd929e', NULL, '2011-04-22 17:47:52', NULL, '31cbcdd0455312662cfff3e31d11714ce45d2536', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.3ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 51, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:52', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;51\n', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ806768') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.3ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:47:52', NULL, '2011-04-22 17:47:52', '61.286.834/0001-08', NULL, NULL, 51, 'CompanyZ', 'SZ806768', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 21) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:47:52', '2011-04-22 17:47:52', '2011-04-22 17:47:52', 50.0, 21, '2012-04-22 17:47:52', 'Aberto')[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 21) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:47:52', NULL, NULL, '2011-04-22 17:47:52', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 21, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.5ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.5ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 16) LIMIT 1[0m
  [4;36;1mColor Create (0.4ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 16, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:52', `name` = 'Empresa', `created_at` = '2011-04-22 17:47:52', `company_id` = 21 WHERE `id` = 16[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 16, 'MyString', 'MySring', 1, NULL, 'Layout', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.3ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:47:52', 'Home', '2011-04-22 17:47:52', NULL, 16)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 16, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.3ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:47:52', `layout_id` = NULL WHERE `id` = 980190985[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 0, 1, 21, 'Company')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:52', '2011-04-22 17:47:52', 21, 24)[0m
  [4;35;1mAddress Create (0.3ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 21, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 51) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 51) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 51) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 51) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 51) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 51) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ806768' AND `companies`.id <> 21) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (14.2ms)
Rendered people/_person (14.6ms)
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (4.5ms)
Rendered companies/_company (8.7ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 241ms (View: 34, DB: 15) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.0&company_type=CompanyZ&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ806768' AND `companies`.id <> 21) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 51) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 51) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 51) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 51) LIMIT 1[0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:52) [POST]
  Parameters: {"person"=>{}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.4ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('903cd2a671f58425b91a3770f2a690d2b74dbb56', '2011-04-22 17:47:52', NULL, NULL, NULL, '2ccc1e090380ab389e83bde83bfb1bfed7dd929e', NULL, '2011-04-22 17:47:52', NULL, '1a9dd2c24bd4ba76b0dbe63dba223f469b6c98e1', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.4ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 52, NULL)[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:52', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;52\n', '2011-04-22 17:47:52', 0, '2011-04-22 17:47:52', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 52) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 52) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 52) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 52) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 52) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 52) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (17.1ms)
Rendered people/_person (17.5ms)
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.5ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 189ms (View: 30, DB: 14) | 200 OK [http://test.host/usuarios?&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 52) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 52) LIMIT 1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (14.7ms)
Rendered people/_person (15.1ms)
  [4;35;1mCompany Load (0.8ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.5ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 52ms (View: 32, DB: 8) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>nil, "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.5ms)
Rendered people/_person (15.9ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 55ms (View: 36, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>nil, "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (14.8ms)
Rendered people/_person (15.1ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 178ms (View: 29, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>nil, "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (14.9ms)
Rendered people/_person (15.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.2ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 54ms (View: 35, DB: 7) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:47:53) [GET]
  Parameters: {"id"=>#<UserGeneralManager id: 2, login: "gerente_geral", email: "gerente_geral@example.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-21 17:47:40", updated_at: "2011-04-22 17:47:41", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9a", activated_at: nil, password_reset_code: nil, enabled: true, type: "UserGeneralManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:47:53 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/usuarios
Completed in 5ms (DB: 2) | 302 Found [http://test.host/users/resend_signup_mail/2]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('43ca5d70d208083ffd78c5f07adc7fb4163e61ee', '2011-04-22 17:47:53', NULL, NULL, NULL, '9ea2f2364e2b5d64e96f3c97d43a5ae478da1c0c', NULL, '2011-04-22 17:47:53', NULL, '54e5f0c3f4d3159ef69c7dbb62419bd1d2178b3a', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 53, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;53\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 53) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 53) LIMIT 1[0m
  [4;36;1mPerson Create (0.4ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:53', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:47:53', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 53) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.2ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:53', '2011-04-22 17:47:53', 53, 45)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 53) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 53 AND `user_people`.id <> 956136653) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 53)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 53) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 53) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 45)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=45) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 45)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 45)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 45)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 45)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:53', `user_id` = 53 WHERE `id` = 45[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '54e5f0c3f4d3159ef69c7dbb62419bd1d2178b3a') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:53', `activated_at` = '2011-04-22 17:47:53' WHERE `id` = 53[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;53\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.0ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 191ms (View: 7, DB: 12) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 53) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (2.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('43ca5d70d208083ffd78c5f07adc7fb4163e61ee', '2011-04-22 17:47:53', NULL, NULL, NULL, '9ea2f2364e2b5d64e96f3c97d43a5ae478da1c0c', NULL, '2011-04-22 17:47:53', NULL, 'f847449a04e7766714e8a03384d69a4846fe0d53', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 54, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;54\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 54) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 54) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:53', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:47:53', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 54) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:53', '2011-04-22 17:47:53', 54, 46)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 54) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 54 AND `user_people`.id <> 956136654) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 54)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 54) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 54) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 46)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=46) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 46)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 46)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 46)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 46)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:53', `user_id` = 54 WHERE `id` = 46[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'f847449a04e7766714e8a03384d69a4846fe0d53') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:53', `activated_at` = '2011-04-22 17:47:53' WHERE `id` = 54[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;54\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.2ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 59ms (View: 7, DB: 15) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUserAdministrator Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 54) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('43ca5d70d208083ffd78c5f07adc7fb4163e61ee', '2011-04-22 17:47:53', NULL, NULL, NULL, '9ea2f2364e2b5d64e96f3c97d43a5ae478da1c0c', NULL, '2011-04-22 17:47:53', NULL, 'a7d6664a5567b150dcb6cba0b11f9596fcdde3e1', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 55, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;55\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 55) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 55) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:53', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:47:53', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 55) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:53', '2011-04-22 17:47:53', 55, 47)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 55) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 55 AND `user_people`.id <> 956136655) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 55)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 55) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 55) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 47)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=47) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 47)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 47)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 47)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 47)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:53', `user_id` = 55 WHERE `id` = 47[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'a7d6664a5567b150dcb6cba0b11f9596fcdde3e1') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:53', `activated_at` = '2011-04-22 17:47:53' WHERE `id` = 55[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;55\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (2.7ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 80ms (View: 30, DB: 15) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 55) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:53) [POST]
  Parameters: {"company"=>{"parcel"=>12, "segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "value"=>50.1, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"034.185.221-06", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '034.185.221-06') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('43ca5d70d208083ffd78c5f07adc7fb4163e61ee', '2011-04-22 17:47:53', NULL, NULL, NULL, '9ea2f2364e2b5d64e96f3c97d43a5ae478da1c0c', NULL, '2011-04-22 17:47:53', NULL, 'c1b3d833438efcfcbb3325d413a5935cc4da5928', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 56, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;56\n', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ925931') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.3ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:47:53', NULL, '2011-04-22 17:47:53', '61.286.834/0001-08', NULL, NULL, 56, 'CompanyZ', 'SZ925931', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 22) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:47:53', '2011-04-22 17:47:53', '2011-04-22 17:47:53', 50.1, 22, '2012-04-22 17:47:53', 'Aberto')[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 22) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:47:53', NULL, NULL, '2011-04-22 17:47:53', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 22, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.3ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 17) LIMIT 1[0m
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 17, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:53', `name` = 'Empresa', `created_at` = '2011-04-22 17:47:53', `company_id` = 22 WHERE `id` = 17[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 17, 'MyString', 'MySring', 1, NULL, 'Layout', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.4ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:47:53', 'Home', '2011-04-22 17:47:53', NULL, 17)[0m
  [4;36;1mColorTemplate Load (0.4ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 17, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.3ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:47:53', `layout_id` = NULL WHERE `id` = 980190987[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 0, 1, 22, 'Company')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:53', '2011-04-22 17:47:53', 22, 25)[0m
  [4;35;1mAddress Create (0.3ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:53', 0, '2011-04-22 17:47:53', 22, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 56) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 56) LIMIT 1[0m
  [4;36;1mPerson Create (0.4ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:53', 4, '034.185.221-06', '2008-09-09', '2011-04-22 17:47:53', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 56) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.4ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:53', '2011-04-22 17:47:53', 56, 48)[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ925931' AND `companies`.id <> 22) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mUserPerson Load (0.5ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 56) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 56 AND `user_people`.id <> 956136656) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 56)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 56) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 56) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=48) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:53', `user_id` = 56 WHERE `id` = 48[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'c1b3d833438efcfcbb3325d413a5935cc4da5928') LIMIT 1[0m
  [4;35;1mUserCompany Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:53', `activated_at` = '2011-04-22 17:47:53' WHERE `id` = 56[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;56\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 48) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=48) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.7ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;36;1mUser Load Including Associations (0.8ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 56) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 56)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (4.0ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 22 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.2ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 129ms (View: 18, DB: 28) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.1&company_type=CompanyZ&person%5Bcpf%5D=034.185.221-06&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ925931' AND `companies`.id <> 22) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=48) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 48)) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 56) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 56) LIMIT 1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:54) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('19acdb944f4152c6617f30d96f3f26d16237636c', '2011-04-22 17:47:54', NULL, NULL, NULL, '292d191ad425cff77fece761ca4884bf8e992199', NULL, '2011-04-22 17:47:54', NULL, 'a874bd7485ddd93d5105af0eaf4f375b084c6fd7', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 57, NULL)[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;57\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ201326') LIMIT 1[0m
  [4;36;1mCompanyZ Create (0.4ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:47:54', NULL, '2011-04-22 17:47:54', NULL, NULL, NULL, 57, 'CompanyZ', 'SZ201326', NULL, 'Empresa', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 23) [0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 23, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 57) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 57) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:54', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:47:54', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 57) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:54', '2011-04-22 17:47:54', 57, 49)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ201326' AND `companies`.id <> 23) LIMIT 1[0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 23) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=49) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 57) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 57) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ201326' AND `companies`.id <> 23) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (13.8ms)
Rendered people/_person (14.1ms)
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (4.7ms)
Rendered companies/_company (11.4ms)
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.2ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 89ms (View: 35, DB: 19) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company_type=CompanyZ&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ201326' AND `companies`.id <> 23) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (1.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:54) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa", "informal"=>"1"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.2ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('19acdb944f4152c6617f30d96f3f26d16237636c', '2011-04-22 17:47:54', NULL, NULL, NULL, '292d191ad425cff77fece761ca4884bf8e992199', NULL, '2011-04-22 17:47:54', NULL, 'c5104f72010727c30a78fa06fea094a7aa9d7021', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 58, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;58\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ974342') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.2ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:47:54', NULL, '2011-04-22 17:47:54', NULL, NULL, NULL, 58, 'CompanyS', 'SZ974342', NULL, 'Empresa', NULL, NULL, 1, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 24) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.3ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:47:54', NULL, NULL, '2011-04-22 17:47:54', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 24, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 18) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 18, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:54', `name` = 'Empresa', `created_at` = '2011-04-22 17:47:54', `company_id` = 24 WHERE `id` = 18[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 18, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:47:54', `layout_id` = NULL WHERE `id` = 980190989[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, 1, 24, 'Company')[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:54', '2011-04-22 17:47:54', 24, 26)[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 24, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 58) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 58) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:54', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:47:54', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 58) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:54', '2011-04-22 17:47:54', 58, 50)[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ974342' AND `companies`.id <> 24) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 58) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 58 AND `user_people`.id <> 956136658) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 58)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 58) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 58) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=50) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:54', `user_id` = 58 WHERE `id` = 50[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'c5104f72010727c30a78fa06fea094a7aa9d7021') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:54', `activated_at` = '2011-04-22 17:47:54' WHERE `id` = 58[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;58\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 50) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=50) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 50)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.7ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 58) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 58)) [0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (3.9ms)
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.5ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 242ms (View: 15, DB: 23) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Binformal%5D=1&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ974342' AND `companies`.id <> 24) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:54) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('19acdb944f4152c6617f30d96f3f26d16237636c', '2011-04-22 17:47:54', NULL, NULL, NULL, '292d191ad425cff77fece761ca4884bf8e992199', NULL, '2011-04-22 17:47:54', NULL, '82f3fd2724b91201f465618fb5934a8f840f1d9c', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 59, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;59\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ816430') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:47:54', NULL, '2011-04-22 17:47:54', '61.286.834/0001-08', NULL, NULL, 59, 'CompanyS', 'SZ816430', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 25) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.3ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:47:54', NULL, NULL, '2011-04-22 17:47:54', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 25, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 19) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 19, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:47:54', `name` = 'Empresa', `created_at` = '2011-04-22 17:47:54', `company_id` = 25 WHERE `id` = 19[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:47:40', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 19, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.4ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:47:54', `layout_id` = NULL WHERE `id` = 980190991[0m
  [4;36;1mFeedItem Create (0.2ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, 1, 25, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:47:54', '2011-04-22 17:47:54', 25, 27)[0m
  [4;36;1mAddress Create (0.4ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 25, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 59) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 59) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:47:54', 4, NULL, '2008-09-09', '2011-04-22 17:47:54', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 59) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:47:54', '2011-04-22 17:47:54', 59, 51)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ816430' AND `companies`.id <> 25) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 59) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 59 AND `user_people`.id <> 956136659) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 59)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 59) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 59) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=51) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:54', `user_id` = 59 WHERE `id` = 51[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '82f3fd2724b91201f465618fb5934a8f840f1d9c') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.2ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:54', `activated_at` = '2011-04-22 17:47:54' WHERE `id` = 59[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;59\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 51) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=51) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.7ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.8ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 59) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 59)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (4.4ms)
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.2ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 245ms (View: 16, DB: 23) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ816430' AND `companies`.id <> 25) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=51) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 51)) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 59) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 59) LIMIT 1[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:54) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mUserSegmentManager Create (0.2ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('19acdb944f4152c6617f30d96f3f26d16237636c', '2011-04-22 17:47:54', NULL, NULL, NULL, '292d191ad425cff77fece761ca4884bf8e992199', NULL, '2011-04-22 17:47:54', NULL, '857060a712810f936de1b28aad90831905280694', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 60, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;60\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 60) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 60) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 60) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 60) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 60) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 60) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (17.4ms)
Rendered people/_person (17.8ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.0ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 64ms (View: 32, DB: 13) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 60) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 60) LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 60) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 60) LIMIT 1[0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:47:54) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;35;1mUserSegmentManager Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('19acdb944f4152c6617f30d96f3f26d16237636c', '2011-04-22 17:47:54', NULL, NULL, NULL, '292d191ad425cff77fece761ca4884bf8e992199', NULL, '2011-04-22 17:47:54', NULL, 'f3f953b8a1137c301587dc662adeb376bb5bcc0a', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.1ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 61, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:47:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;61\n', '2011-04-22 17:47:54', 0, '2011-04-22 17:47:54', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 61) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 61) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 61) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 61) LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 61) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 61) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (18.1ms)
Rendered people/_person (18.4ms)
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 202ms (View: 34, DB: 11) | 200 OK [http://test.host/usuarios?person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 61) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 61) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 61) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 61) LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mUserWebAdministrator Update (0.5ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:47:55', `login` = 'quentin2' WHERE `id` = 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mPerson Update (0.5ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:47:55', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/
Completed in 24ms (DB: 10) | 302 Found [http://test.host/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m


Processing VisitSchedulerController#create (for 0.0.0.0 at 2011-04-22 14:47:55) [PUT]
  Parameters: {"visit_schedule"=>{"city"=>"oidjsa", "segment_id"=>#<Segment id: 1, name: "Alimenta√ß√£o", file: "Mystring.jpg">, "name"=>"siuhsi", "address"=>"diuashdiauhdiusha", "ddd"=>"021", "time_to_visit"=>"Indiferente", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:47:41", updated_at: "2011-04-22 17:47:41", enabled: true>, "phone"=>"212121", "email"=>"bruno@diudh.com"}}
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Sent mail to bsiqueira@suaempreza.com.br

Date: Fri, 22 Apr 2011 14:47:55 -0300
From: bsiqueira@suaempreza.com.br
To: bsiqueira@suaempreza.com.br
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_siuhsi=3A_Solicita=C3=A7=C3=A3o_de_visita?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>C√©lula Z</title>
</head>
<body>
  <h1> Solicita√ß√£o de Agendamento de Visita</h1>

  <p>
    <b>Nome:</b>
    siuhsi
  </p>

  <p>
    <b>Email:</b>
    bruno@diudh.com
  </p>

  <p>
    <b>Telefone:</b>
    021 212121
  </p>

  <p>
    <b>Endere√ßo:</b>
    diuashdiauhdiusha - oidjsa
  </p>

  <p>
    <b>Filial:</b>
    Filial 1
  </p>

  <p>
    <b>Segmento:</b>
    Alimenta√ß√£o
  </p>

  <p>
    <b>Hor√°rio de Prefer√™ncia para Visita:</b>
    Indiferente
  </p>

  <p>
    <b>Observa√ß√µes:</b>
    
  </p>
</body>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 10ms (DB: 3) | 302 Found [http://test.host/visit_scheduler/create?visit_schedule%5Baddress%5D=diuashdiauhdiusha&visit_schedule%5Bcity%5D=oidjsa&visit_schedule%5Bddd%5D=021&visit_schedule%5Bemail%5D=bruno%40diudh.com&visit_schedule%5Bname%5D=siuhsi&visit_schedule%5Bphone%5D=212121&visit_schedule%5Bsegment_id%5D=1&visit_schedule%5Bsubsidiary_id%5D=1&visit_schedule%5Btime_to_visit%5D=Indiferente]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing VisitSchedulerController#new (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
Rendering template within layouts/main
Rendering visit_scheduler/new
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`enabled` = 1) ORDER BY title[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.8ms)
Completed in 12ms (View: 11, DB: 1) | 200 OK [http://test.host/agendar-visita]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"domain"=>"www.celudoaudhisauhdiasuhlaz.com.br"}
Completed in 14ms (View: 0, DB: 1) | 200 OK [http://test.host/whois/check?domain=www.celudoaudhisauhdiasuhlaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"domain"=>"www.sorvetefeliz.com.br"}
Completed in 6ms (View: 0, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.sorvetefeliz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"domain"=>"www.celulaz.com.br"}
Completed in 107ms (View: 1, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.celulaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"id"=>"empres√£ _&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.6ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;36;1mCompanyZ Load Including Associations (1.1ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `layouts`.`id` AS t1_r0, `layouts`.`company_id` AS t1_r1, `layouts`.`architecture_type` AS t1_r2, `layouts`.`name` AS t1_r3, `layouts`.`slogan` AS t1_r4, `layouts`.`website` AS t1_r5, `layouts`.`presentation_text` AS t1_r6, `layouts`.`background_file_name` AS t1_r7, `layouts`.`created_at` AS t1_r8, `layouts`.`updated_at` AS t1_r9, `layouts`.`card1_file_name` AS t1_r10, `layouts`.`card1_content_type` AS t1_r11, `layouts`.`card1_file_size` AS t1_r12, `layouts`.`card2_file_name` AS t1_r13, `layouts`.`card2_content_type` AS t1_r14, `layouts`.`card2_file_size` AS t1_r15, `layouts`.`card3_file_name` AS t1_r16, `layouts`.`card3_content_type` AS t1_r17, `layouts`.`card3_file_size` AS t1_r18, `layouts`.`component_decoration` AS t1_r19, `layouts`.`show_name` AS t1_r20, `layouts`.`show_slogan` AS t1_r21, `layouts`.`show_logo` AS t1_r22, `layouts`.`background_top` AS t1_r23, `layouts`.`send_to_friend` AS t1_r24, `layouts`.`side_image_url` AS t1_r25, `layouts`.`font_colors` AS t1_r26, `layouts`.`email` AS t1_r27, `layouts`.`facebook` AS t1_r28, `layouts`.`orkut` AS t1_r29, `layouts`.`twitter` AS t1_r30, `layouts`.`flickr` AS t1_r31, `layouts`.`repeat_background_x` AS t1_r32, `layouts`.`repeat_background_y` AS t1_r33, `layouts`.`centralize_background` AS t1_r34, `layouts`.`meta_description` AS t1_r35, `layouts`.`meta_keywords` AS t1_r36, `layouts`.`analytics` AS t1_r37, `colors`.`id` AS t2_r0, `colors`.`name` AS t2_r1, `colors`.`slogan` AS t2_r2, `colors`.`title` AS t2_r3, `colors`.`subtitle` AS t2_r4, `colors`.`checked_menu` AS t2_r5, `colors`.`unchecked_menu` AS t2_r6, `colors`.`background_menu` AS t2_r7, `colors`.`tool_botton` AS t2_r8, `colors`.`text` AS t2_r9, `colors`.`tool_body` AS t2_r10, `colors`.`background` AS t2_r11, `colors`.`body` AS t2_r12, `colors`.`created_at` AS t2_r13, `colors`.`updated_at` AS t2_r14, `colors`.`layout_id` AS t2_r15, `colors`.`menu_deselected_text` AS t2_r16, `colors`.`menu_deselected_background` AS t2_r17, `colors`.`menu_selected_text` AS t2_r18, `colors`.`menu_selected_background` AS t2_r19, `colors`.`menu_hover_text` AS t2_r20, `colors`.`menu_hover_background` AS t2_r21, `colors`.`title_text` AS t2_r22, `colors`.`title_background` AS t2_r23, `colors`.`subtitle_text` AS t2_r24, `colors`.`subtitle_background` AS t2_r25, `colors`.`text_background` AS t2_r26, `colors`.`link_text` AS t2_r27, `colors`.`link_background` AS t2_r28, `colors`.`body_sidebar` AS t2_r29, `colors`.`border` AS t2_r30, `colors`.`name_company_text` AS t2_r31, `colors`.`slogan_company_text` AS t2_r32, `colors`.`footer_background` AS t2_r33, `colors`.`footer_text` AS t2_r34, `colors`.`sidebar_text` AS t2_r35, `users`.`id` AS t3_r0, `users`.`login` AS t3_r1, `users`.`email` AS t3_r2, `users`.`crypted_password` AS t3_r3, `users`.`salt` AS t3_r4, `users`.`created_at` AS t3_r5, `users`.`updated_at` AS t3_r6, `users`.`remember_token` AS t3_r7, `users`.`remember_token_expires_at` AS t3_r8, `users`.`activation_code` AS t3_r9, `users`.`activated_at` AS t3_r10, `users`.`password_reset_code` AS t3_r11, `users`.`enabled` AS t3_r12, `users`.`type` AS t3_r13, `users`.`self_created` AS t3_r14, `users`.`avatar_file_name` AS t3_r15, `users`.`avatar_content_type` AS t3_r16, `users`.`avatar_file_size` AS t3_r17, `users`.`avatar_updated_at` AS t3_r18, `users`.`domain` AS t3_r19 FROM `companies` LEFT OUTER JOIN `layouts` ON layouts.company_id = companies.id LEFT OUTER JOIN `colors` ON colors.layout_id = layouts.id LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (7) [0m
Cache write: empres√£ _&valid_2_layout
  [4;35;1mTab Load IDs For Limited Eager Loading (0.4ms)[0m   [0mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;36;1mTab Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;35;1mTab Load Including Associations (0.5ms)[0m   [0mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) AND `tabs`.id IN (3) ORDER BY tabs.order[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (2.1ms)
  [4;36;1mTab Load Including Associations (0.9ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order[0m
Rendered z/_social (0.5ms)
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.9ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.2ms)
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (5.1ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 2 AND `addresses`.owner_type = 'Layout') LIMIT 1[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
Rendered z/_address (4.7ms)
Rendered z/_sidebar_address (0.8ms)
  [4;36;1mBanner Load (0.4ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
Completed in 305ms (View: 171, DB: 11) | 200 OK [http://test.host/z/empres%C3%A3%20_&valid_2]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"id"=>"empres%C3%A3%20_&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (0.6ms)
Rendered z/_social (0.1ms)
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.4ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (0.9ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (2.7ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_address (0.7ms)
Rendered z/_sidebar_address (0.1ms)
Completed in 27ms (View: 19, DB: 6) | 200 OK [http://test.host/z/empres%25C3%25A3%2520_&valid_2]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:47:55) [GET]
  Parameters: {"id"=>"asiuhiasuhaiuhsiauhsiauhsiuhai"}
Cache read: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='asiuhiasuhaiuhsiauhsiauhsiuhai') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
Cache write: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
Redirected to http://test.host/not_found
Filter chain halted as [:find_company] rendered_or_redirected.
Completed in 10ms (DB: 1) | 302 Found [http://test.host/z/asiuhiasuhaiuhsiauhsiauhsiuhai]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (14.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:49:47) [POST]
  Parameters: {"business"=>{}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (11.4ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 49ms (View: 23, DB: 1340) | 200 OK [http://test.host/company/businesses?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:49:47) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 5ms (DB: 3) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:49:47) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:49:47) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 17ms (View: 12, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:49:47) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 11, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:49:47) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 9, DB: 4) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:49:47) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 7ms (DB: 3) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:50:27) [POST]
  Parameters: {"business"=>{}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.9ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 39ms (View: 23, DB: 558) | 200 OK [http://test.host/company/businesses?]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.1ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:50:27) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 5ms (DB: 3) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.1ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:50:27) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 16ms (View: 11, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:50:27) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 110ms (View: 106, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:50:27) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 10, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.1ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:50:27) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 10, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:50:27) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 7ms (DB: 3) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (14.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:52:25) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.3ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-04-22 17:52:25', 'test', '2011-04-22 17:52:25', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:52:25', 0, '2011-04-22 17:52:25', 0, 1, 980190963, 'Business')[0m
  [4;36;1mFeed Create (0.4ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:52:25', '2011-04-22 17:52:25', 7, 28)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:52:25) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;36;1mBusiness Destroy (0.4ms)[0m   [0;1mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 6ms (DB: 449) | 302 Found [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:52:25) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 26ms (View: 22, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:52:25) [GET]
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 113ms (View: 108, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:52:25) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 10, DB: 2) | 200 OK [http://test.host/company/businesses/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:52:25) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 10, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:52:25) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 7ms (DB: 3) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:52:54) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.3ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-04-22 17:52:54', 'test', '2011-04-22 17:52:54', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.2ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:52:54', 0, '2011-04-22 17:52:54', 0, 1, 980190964, 'Business')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:52:54', '2011-04-22 17:52:54', 7, 29)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190964
Completed in 25ms (DB: 315) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.1ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:52:54) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 5ms (DB: 4) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.1ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:52:54) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 26ms (View: 21, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:52:54) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 109ms (View: 105, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:52:54) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 11, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:52:54) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 10, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:52:54) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUserGeneralManager Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:55:53) [GET]
  Parameters: {"id"=>"8f24789ae988411ccf33ab0c30fe9106fab32e9a"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '8f24789ae988411ccf33ab0c30fe9106fab32e9a') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserGeneralManager Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:55:53', `activated_at` = '2011-04-22 17:55:53' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Columns (1.4ms)[0m   [0mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:53', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserGeneralManager;2\n', '2011-04-22 17:55:53', 0, '2011-04-22 17:55:53', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 17ms (DB: 430) | 302 Found [http://test.host/ativar/8f24789ae988411ccf33ab0c30fe9106fab32e9a]
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'gerente_geral' or email = 'gerente_geral') LIMIT 1[0m
  [4;35;1mSQL (2.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:55:53) [GET]
  Parameters: {"id"=>""}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '') LIMIT 1[0m
Redirected to http://test.host/signup
Completed in 2ms (DB: 4) | 302 Found [http://test.host/ativar/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing AccountsController#show (for 0.0.0.0 at 2011-04-22 14:55:53) [GET]
Redirected to http://test.host/signup
Completed in 1ms (DB: 0) | 302 Found [http://test.host/ativar]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUserCompany Columns (14.1ms)[0m   [0mSHOW FIELDS FROM `users`[0m


Processing Company::AddressController#update (for 0.0.0.0 at 2011-04-22 14:55:53) [GET]
  Parameters: {"address"=>{}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (14.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (1.0ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered company/address/_address (1.9ms)
  [4;35;1mState Load (0.5ms)[0m   [0mSELECT * FROM `states` [0m
Rendered company/address/_form (7.4ms)
Rendering company/address/update
Completed in 41ms (View: 1, DB: 0) | 200 OK [http://test.host/company/address/update?]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::AddressController#update (for 0.0.0.0 at 2011-04-22 14:55:53) [GET]
  Parameters: {"address"=>{"street"=>nil}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered company/address/_form (5.4ms)
Rendering company/address/update
Completed in 13ms (View: 2, DB: 0) | 200 OK [http://test.host/company/address/update?address%5Bstreet%5D=]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessCardController#index (for 0.0.0.0 at 2011-04-22 14:55:53) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Google geocoding. Address: MyString MyString 1111 MyString MySring RJ Rio de Janeiro Brasil. Result: <?xml version="1.0" encoding="UTF-8" ?>
<kml xmlns="http://earth.google.com/kml/2.0"><Response>
  <name>MyString MyString 1111 MyString MySring RJ Rio de Janeiro Brasil</name>
  <Status>
    <code>200</code>
    <request>geocode</request>
  </Status>
  <Placemark id="p1">
    <address>Rio de Janeiro, Brazil</address>
    <AddressDetails Accuracy="4" xmlns="urn:oasis:names:tc:ciq:xsdschema:xAL:2.0"><Country><CountryNameCode>BR</CountryNameCode><CountryName>Brasil</CountryName><AdministrativeArea><AdministrativeAreaName>RJ</AdministrativeAreaName><Locality><LocalityName>Rio de Janeiro</LocalityName></Locality></AdministrativeArea></Country></AddressDetails>
    <ExtendedData>
      <LatLonBox north="-22.5742361" south="-23.2320449" east="-42.6973493" west="-43.7218245" />
    </ExtendedData>
    <Point><coordinates>-43.2095869,-22.9035393,0</coordinates></Point>
  </Placemark>
</Response></kml>
Rendering template within layouts/company
Rendering company/business_card/index
  [4;35;1mPhone Load (0.9ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
Rendered company/phones/_form (4.9ms)
Rendered company/address/_address (0.2ms)
  [4;36;1mState Load (0.5ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered company/address/_form (5.3ms)
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
Rendered company/business_card/_card_image_form (3.5ms)
Rendered company/business_card/_card_image_form (1.2ms)
Rendered company/business_card/_card_image_form (1.1ms)
  [4;35;1mService Load (0.7ms)[0m   [0mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 7)) [0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT * FROM `services` [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 712ms (View: 147, DB: 6) | 200 OK [http://test.host/empresa/cartao-de-visitas]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::BusinessCardController#update (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"presentation_text", "value"=>"123"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:54', `presentation_text` = '123' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 9ms (View: 0, DB: 3) | 200 OK [http://test.host/company/business_card/update/presentation_text?value=123]
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-04-22 14:55:54) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;36;1mBusiness Create (0.3ms)[0m   [0;1mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-04-22 17:55:54', 'test', '2011-04-22 17:55:54', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Create (0.4ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:55:54', 0, '2011-04-22 17:55:54', 0, 1, 980190965, 'Business')[0m
  [4;35;1mFeed Create (0.4ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:54', '2011-04-22 17:55:54', 7, 30)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190965
Completed in 21ms (DB: 7) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (21.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-04-22 14:55:54) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;36;1mBusiness Destroy (0.3ms)[0m   [0;1mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 6ms (DB: 24) | 302 Found [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.1ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 16ms (View: 12, DB: 3) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 18ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 17ms (View: 12, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.5ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 16ms (View: 10, DB: 4) | 200 OK [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-04-22 14:55:54) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 6ms (DB: 3) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponentText Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:54', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Create (0.3ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:55:54', 'titulo do component', NULL, NULL, '2011-04-22 17:55:54', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 31ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mComponentText Create (0.5ms)[0m   [0mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:55:54', 'C√≥digo', NULL, NULL, '2011-04-22 17:55:54', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.6ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 13ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 3, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mLayout Update (0.5ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:54', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:55:54', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;35;1mComponentForm Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mComponentForm Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 17:55:54', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;36;1mSQL (6.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ConstructionController#content (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering /company/construction/content.json
  [4;36;1mTab Load (0.6ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mComponentPicture Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 1)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 3) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 3)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 4) [0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
Completed in 30ms (View: 0, DB: 0) | 200 OK [http://test.host/company/construction/content]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::LayoutController#update_background (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"/image/temp_small"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.5ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:54', `background_file_name` = '/image/temp' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 3) | 200 OK [http://test.host/company/layout/update_background/%2Fimage%2Ftemp_small]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::LayoutController#update_background_top (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"/image/temp_small"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:54', `background_top` = '/image/temp' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 0, DB: 4) | 200 OK [http://test.host/company/layout/update_background_top/%2Fimage%2Ftemp_small]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (1.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::MailboxController#index (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mFolder Load (0.5ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `message_copies`.id FROM `message_copies` LEFT OUTER JOIN `messages` ON `messages`.id = `message_copies`.message_id WHERE ((`message_copies`.folder_id = 980190962) AND (deleted IS NULL OR deleted = 0)) ORDER BY messages.created_at DESC LIMIT 0, 10[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/mailbox/index
Rendered company/shared/_message_actions (0.6ms)
  [4;36;1mCompany Load (0.7ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mCompany Count (0.6ms)[0m   [0;1mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (8.2ms)
Rendered company/shared/_message_box_label (2.3ms)
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 37ms (View: 20, DB: 8) | 200 OK [http://test.host/company/mailbox]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::MessageToFriendController#create (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"message_to_friend"=>{"email_to"=>"teste@hotmail.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_to_friend\nargs: \n- &id001 !ruby/object:MessageToFriend \n company: !ruby/object:CompanyZ \n attributes: \n segment_id: \"1\"\n profile_logo_updated_at: \n created_at: 2011-04-22 17:55:52\n updated_at: 2011-04-22 17:55:52\n profile_logo_file_name: \n register_number: \n cnpj: 15.754.056/0001-09\n id: \"5\"\n drawee_code: SZ20002\n type: CompanyZ\n user_id: \"8\"\n person_id: \"13\"\n profile_logo_content_type: \n razao_social: MyString\n informal: \n state_id: \n profile_logo_file_size: \n payment_type: mensal\n attributes_cache: {}\n\n layout: !ruby/object:Layout \n attributes: \n flickr: \n name: Empresa 1\n created_at: 2011-04-22 17:55:52\n slogan: A primeira empresa do banco de testes\n repeat_background_x: \n font_colors: \n repeat_background_y: \n side_image_url: \n updated_at: 2011-04-22 17:55:52\n send_to_friend: \"0\"\n show_logo: \n show_slogan: \n show_name: \n centralize_background: \n id: \"1\"\n meta_keywords: \n meta_description: \n card2_file_name: \n card2_file_size: \n card2_content_type: \n card1_file_name: \n website: www.sitedaempresa1.com.br\n company_id: \"5\"\n facebook: \n background_top: \n card3_content_type: \n card1_file_size: \n architecture_type: \"6\"\n orkut: \n component_decoration: \n card3_file_name: \n background_file_name: \n presentation_text: \"texto de apresenta\\xC3\\xA7\\xC3\\xA3o da empresa 1\"\n analytics: \n twitter: \n email: \n card3_file_size: \n card1_content_type: \n attributes_cache: {}\n\n email_to: teste@hotmail.com\n errors: !ruby/object:ActiveRecord::Errors \n base: *id001\n errors: !omap []\n\n', '2011-04-22 17:55:54', 0, '2011-04-22 17:55:54', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/message_to_friend/create
Completed in 123ms (View: 1, DB: 2) | 200 OK [http://test.host/company/message_to_friend/create?message_to_friend%5Bemail_to%5D=teste%40hotmail.com]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m


Processing Company::MessagesController#destroy (for 0.0.0.0 at 2011-04-22 14:55:54) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.4ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = '1') AND (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mMessageCopy Update (0.3ms)[0m   [0;1mUPDATE `message_copies` SET `deleted` = 1, `updated_at` = '2011-04-22 17:55:54' WHERE `id` = 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 12ms (View: 0, DB: 3) | 200 OK [http://test.host/company/mensagens/1]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m


Processing Company::MessagesController#create (for 0.0.0.0 at 2011-04-22 14:55:54) [POST]
  Parameters: {"message"=>{"body"=>"Corpo da mensagem", "sender"=>"8", "subject"=>"Teste - Mensagem enviada do sistema", "to"=>"8"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: sender
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.2ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES(NULL, '2011-04-22 17:55:54', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:55:54', 'Teste - Mensagem enviada do sistema', 8, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.1ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 12) [0m
  [4;35;1mMessageCopy Create (0.1ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:55:54', NULL, 8, NULL, NULL, 12)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;11\n', '2011-04-22 17:55:54', 0, '2011-04-22 17:55:54', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:55:54', 0, '2011-04-22 17:55:54', 0, 0, 12, 'Message')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:54', '2011-04-22 17:55:54', 5, 31)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 23ms (View: 0, DB: 5) | 200 OK [http://test.host/company/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender%5D=8&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+sistema&message%5Bto%5D=8]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m


Processing Company::MessagesController#create (for 0.0.0.0 at 2011-04-22 14:55:54) [POST]
  Parameters: {"message"=>{"body"=>"Corpo da mensagem de resposta", "sender"=>"8", "subject"=>"Teste - Mensagem enviada do sistema", "to"=>"8"}}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: sender
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;35;1mMessage Create (0.3ms)[0m   [0mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES(NULL, '2011-04-22 17:55:54', NULL, NULL, NULL, 'Corpo da mensagem de resposta', NULL, '2011-04-22 17:55:54', 'Teste - Mensagem enviada do sistema', 8, NULL, NULL)[0m
  [4;36;1mMessageCopy Load (0.2ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 13) [0m
  [4;36;1mMessageCopy Create (0.2ms)[0m   [0;1mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:55:54', NULL, 8, NULL, NULL, 13)[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:54', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;12\n', '2011-04-22 17:55:54', 0, '2011-04-22 17:55:54', 0, NULL, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:55:54', 0, '2011-04-22 17:55:54', 0, 0, 13, 'Message')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:54', '2011-04-22 17:55:54', 5, 32)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 20ms (View: 0, DB: 6) | 200 OK [http://test.host/company/mensagens?message%5Bbody%5D=Corpo+da+mensagem+de+resposta&message%5Bsender%5D=8&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+sistema&message%5Bto%5D=8]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m


Processing Company::MessagesController#show (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = '1') AND (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mMessageCopy Update (0.3ms)[0m   [0mUPDATE `message_copies` SET `updated_at` = '2011-04-22 17:55:54', `read` = 1 WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/messages/show
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.5ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.3ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 31ms (View: 19, DB: 8) | 200 OK [http://test.host/company/mensagens/1]
  [4;36;1mSQL (13.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing Company::PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:55:54) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Rendering template within layouts/company
Rendering company/people/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 141ms (View: 132, DB: 16) | 200 OK [http://test.host/company/people/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing Company::PeopleController#update (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/people/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 38ms (View: 24, DB: 6) | 200 OK [http://test.host/company/people/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"phone"=>{"number"=>88888888, "ddd"=>21}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mPhone Create (0.4ms)[0m   [0;1mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(88888888, '2011-04-22 17:55:55', '2011-04-22 17:55:55', 21, 5, NULL, NULL, 'Company')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_phone (0.4ms)
Rendered company/phones/_form (1.3ms)
Completed in 14ms (View: 3, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=21&phone%5Bnumber%5D=88888888]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m


Processing Company::PhonesController#destroy (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962 AND (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.3ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/destroy
Completed in 7ms (View: 1, DB: 5) | 200 OK [http://test.host/company/phones/980190962]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"phone"=>{"number"=>"", "ddd"=>""}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.7ms)
Completed in 10ms (View: 6, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=&phone%5Bnumber%5D=]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"phone"=>{"number"=>nil, "ddd"=>nil}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.9ms)
Completed in 10ms (View: 6, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=&phone%5Bnumber%5D=]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m


Processing Company::PhonesController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"phone"=>{"number"=>"dsafsa", "ddd"=>"3ewew"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/phones/create
Rendered company/phones/_form (2.8ms)
Completed in 11ms (View: 6, DB: 3) | 200 OK [http://test.host/company/phones?phone%5Bddd%5D=3ewew&phone%5Bnumber%5D=dsafsa]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;36;1mPicture Load (0.2ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mComponentGallery Columns (7.2ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::PicturesController#update (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"id"=>#<Picture id: 1, component_id: 8, title: "MyString", description: "MyText", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", photo_file_size: nil, photo_content_type: nil, photo_file_name: nil, component_type: "Component">, "component_id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "picture"=>{"description"=>"sou a nova descri√ß√£o"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8 AND (`components`.layout_id = 1)) [0m
  [4;36;1mPicture Load (0.5ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1 AND (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.3ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:55:55', `description` = 'sou a nova descri√ß√£o' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 18ms (View: 1, DB: 11) | 200 OK [http://test.host/company/componentes/8/images/1?picture%5Bdescription%5D=sou+a+nova+descri%C3%A7%C3%A3o]
  [4;36;1mPicture Load (0.3ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ProfileController#index (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 7)) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 7)) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT distinct feed_items.* FROM `feed_items` INNER JOIN `feeds` ON feeds.feed_item_id = feed_items.id WHERE (feeds.company_id in (5,7) and (is_public = 1 or company_id = 7)) ORDER BY feed_items.updated_at desc LIMIT 0, 10[0m
Rendering template within layouts/company
Rendering company/profile/index
  [4;36;1mCompany Load (0.4ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=false) 
 WHERE (destinies.company_destiny_id=7)[0m
Rendered company/news/_news (1.1ms)
Rendered company/profile/_feeds (1.1ms)
Rendered company/message_to_friend/_form (3.5ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7) LIMIT 0, 4[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mVisit Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `visits`[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/z/empres√£ _&valid_2' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:55:55') [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/z/empres√£ _&valid_2' and created_at>'2011-03-22 17:55:55' and created_at<'2011-04-22 17:55:55') [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/company/profile/public/7-MyString' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:55:55') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/company/profile/public/7-MyString' and created_at>'2011-03-22 17:55:55' and created_at<'2011-04-22 17:55:55') [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/business_cards/7-MyString' and created_at>'2011-04-22 00:00:00' and created_at<'2011-04-22 17:55:55') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `visits` WHERE (request_url='/business_cards/7-MyString' and created_at>'2011-03-22 17:55:55' and created_at<'2011-04-22 17:55:55') [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
Completed in 153ms (View: 134, DB: 11) | 200 OK [http://test.host/empresa-inicio]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Company::ProfileController#public (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.* FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering company/profile/public
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE (`companies`.`id` = 7) AND ((`company_relationships`.company_destiny_id = 7)) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 7) AND ((`company_relationships`.company_origin_id = 7)) LIMIT 1[0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 7)) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7) LIMIT 20, 5[0m
  [4;36;1mCompany Count (0.5ms)[0m   [0;1mSELECT COUNT(*) FROM (
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=7) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=7)) AS count_table[0m
Rendered company/profile/_feeds (0.1ms)
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mVisit Load (0.3ms)[0m   [0mSELECT `visits`.id FROM `visits` WHERE (`visits`.`session` = '639175b4968eb65f9d94cc1e8e4c4c18' AND `visits`.`request_url` = '/company/profile/public/#<CompanyZ:0x1067cfa40>') LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mVisit Create (0.3ms)[0m   [0mINSERT INTO `visits` (`created_at`, `session`, `updated_at`, `user_id`, `request_url`, `ip_address`) VALUES('2011-04-22 17:55:55', '639175b4968eb65f9d94cc1e8e4c4c18', '2011-04-22 17:55:55', 12, '/company/profile/public/#<CompanyZ:0x1067cfa40>', '0.0.0.0')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 35ms (View: 22, DB: 7) | 200 OK [http://test.host/company/profile/public/7-MyString]
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompanyS Columns (9.9ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 4) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>"4"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 4 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 4 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 4) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.3ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:55:55', 0, 4, '2011-04-22 17:55:55')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:55', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyRelationshipMailer\nmethod: :deliver_request\nargs: \n- LOAD;CompanyRelationship;495905395\n- \n', '2011-04-22 17:55:55', 0, '2011-04-22 17:55:55', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/relationship_request/create
Completed in 19ms (View: 1, DB: 16) | 200 OK [http://test.host/company/relationship_request/create/4]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mCompanyZ Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 3) [0m
Redirected to http://test.host/company/relationship_request/update/3
Completed in 5ms (DB: 5) | 302 Found [http://test.host/company/relationship_request/create/3]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_destiny_id = 5)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Company::RelationshipRequestController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.`company_origin_id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Load (0.1ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.1ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering company/relationship_request/create
Completed in 8ms (View: 0, DB: 4) | 200 OK [http://test.host/company/relationship_request/create/5]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing Company::RelationshipRequestController#destroy (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyRelationship Delete all (0.3ms)[0m   [0mDELETE FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3 AND `company_relationships`.`company_destiny_id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Delete all (0.1ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.`company_destiny_id` = 3) [0m
  [4;35;1mSQL (0.0ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/profile/public/3-empresa
Completed in 7ms (DB: 2) | 302 Found [http://test.host/company/relationship_request/destroy/3]
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5)) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing Company::RelationshipRequestController#update (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.2ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = '3') AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyRelationship Update (0.3ms)[0m   [0;1mUPDATE `company_relationships` SET `updated_at` = '2011-04-22 17:55:55', `confirmed` = 1 WHERE `id` = 495905389[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:55:55', 0, '2011-04-22 17:55:55', 0, 1, 495905389, 'CompanyRelationship')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:55', '2011-04-22 17:55:55', 5, 33)[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:55', '2011-04-22 17:55:55', 3, 33)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering company/relationship_request/update
Completed in 13ms (View: 1, DB: 4) | 200 OK [http://test.host/company/relationship_request/update/3]
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipsController#friend_requests (for 0.0.0.0 at 2011-04-22 14:55:55) [POST]
  Parameters: {"company_origin_id"=>#<CompanyS id: 3, user_id: 5, cnpj: "88.323.034/0001-68", razao_social: "empresa", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20004", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "status"=>"true"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.5ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3) AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompanyRelationship Update (0.4ms)[0m   [0;1mUPDATE `company_relationships` SET `updated_at` = '2011-04-22 17:55:55', `confirmed` = 1 WHERE `id` = 495905389[0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:55:55', 0, '2011-04-22 17:55:55', 0, 1, 495905389, 'CompanyRelationship')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:55', '2011-04-22 17:55:55', 5, 34)[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:55', '2011-04-22 17:55:55', 3, 34)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 22ms (View: 0, DB: 6) | 200 OK [http://test.host/company/relationships/friend_requests?company_origin_id=3-empresa&status=true]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE (`companies`.`id` = 3) AND ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m


Processing Company::RelationshipsController#friend_requests (for 0.0.0.0 at 2011-04-22 14:55:55) [POST]
  Parameters: {"company_origin_id"=>#<CompanyS id: 3, user_id: 5, cnpj: "88.323.034/0001-68", razao_social: "empresa", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20004", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>, "status"=>"false"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.5ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 3) AND (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyRelationship Destroy (0.3ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 7ms (View: 0, DB: 6) | 200 OK [http://test.host/company/relationships/friend_requests?company_origin_id=3-empresa&status=false]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `company_relationships` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_items` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing Company::SentController#index (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessage Load (0.5ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) ORDER BY created_at DESC LIMIT 0, 10[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/sent/index
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.5ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.7ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `message_copies` ON `users`.id = `message_copies`.recipient_id WHERE ((`message_copies`.message_id = 1)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `message_copies` ON `users`.id = `message_copies`.recipient_id WHERE ((`message_copies`.message_id = 1)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 33ms (View: 20, DB: 7) | 200 OK [http://test.host/company/sent]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mMessage Load (0.1ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m


Processing Company::SentController#show (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 1 AND (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null))) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE ((`message_copies`.folder_id = 980190962) AND ((`read` IS NULL OR `read` = 0) and (deleted is NULL OR deleted = 0))) [0m
Rendering template within layouts/company
Rendering company/sent/show
Rendered company/shared/_message_actions (0.3ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mCompany Count (0.5ms)[0m   [0mSELECT COUNT(1) FROM ( SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as destinies
 ON (companies.id = destinies.company_origin_id and confirmed=true)
 WHERE (destinies.company_destiny_id=5)
 UNION SELECT companies.id as id
 FROM companies as companies
 JOIN company_relationships as origins
 ON (companies.id = origins.company_destiny_id and confirmed=true)
 WHERE (origins.company_origin_id=5) group by id ) as count_friends[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 WHERE (origins.company_origin_id=5)[0m
Rendered company/shared/_new_message (5.4ms)
Rendered company/shared/_message_box_label (0.5ms)
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 25ms (View: 16, DB: 6) | 200 OK [http://test.host/company/sent/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mService Load (0.1ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m


Processing Company::ServiceController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mService Load (0.4ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;36;1mService Load (0.3ms)[0m   [0;1mSELECT `services`.id FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE (`services`.`id` = 1) AND ((`company_services`.company_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyService Create (0.3ms)[0m   [0;1mINSERT INTO `company_services` (`created_at`, `updated_at`, `service_id`, `company_id`) VALUES('2011-04-22 17:55:55', '2011-04-22 17:55:55', 1, 5)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/service/create
Completed in 14ms (View: 1, DB: 3) | 200 OK [http://test.host/company/service/create/1]
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompanyZ Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mService Load (0.2ms)[0m   [0mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompanyService Create (0.3ms)[0m   [0mINSERT INTO `company_services` (`created_at`, `updated_at`, `service_id`, `company_id`) VALUES('2011-04-22 17:55:55', '2011-04-22 17:55:55', 1, 5)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mService Load (0.4ms)[0m   [0;1mSELECT DISTINCT `services`.* FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) LIMIT 1[0m


Processing Company::ServiceController#destroy (for 0.0.0.0 at 2011-04-22 14:55:55) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mService Load (0.2ms)[0m   [0;1mSELECT * FROM `services` WHERE (`services`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyService Delete all (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE (`company_services`.`service_id` = 1 AND `company_services`.`company_id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering company/service/destroy
Completed in 6ms (View: 1, DB: 7) | 200 OK [http://test.host/company/service/destroy/1]
  [4;36;1mCompanyZ Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `services`.id) AS count_services_id FROM `services` INNER JOIN `company_services` ON `services`.id = `company_services`.service_id WHERE ((`company_services`.company_id = 5)) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mTab Load (0.1ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabComponentsController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "tab_component"=>{"line"=>5, "column"=>1, "full_line"=>true, "tab_id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", order: 1.0>}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 8)) LIMIT 1[0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 8) [0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Create (0.4ms)[0m   [0mINSERT INTO `tab_components` (`created_at`, `line`, `updated_at`, `column`, `full_line`, `tab_id`, `component_id`) VALUES('2011-04-22 17:55:55', 5, '2011-04-22 17:55:55', 1, 1, 1, 8)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 15ms (View: 0, DB: 5) | 200 OK [http://test.host/company/tab_components/create/8?tab_component%5Bcolumn%5D=1&tab_component%5Bfull_line%5D=true&tab_component%5Bline%5D=5&tab_component%5Btab_id%5D=1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mSQL (7.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.1ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m


Processing Company::TabComponentsController#destroy (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;36;1mTabComponent Delete all (0.3ms)[0m   [0;1mDELETE FROM `tab_components` WHERE (`id` IN (148646006)) [0m
Completed in 6ms (View: 0, DB: 10) | 200 OK [http://test.host/company/tab_components/destroy/5]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabComponentsController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "tab_component"=>{"line"=>5, "column"=>1, "full_line"=>true, "tab_id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", order: 1.0>}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;35;1mTabComponent Delete all (0.4ms)[0m   [0mDELETE FROM `tab_components` WHERE (`id` IN (148646006)) [0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTabComponent Create (0.3ms)[0m   [0;1mINSERT INTO `tab_components` (`created_at`, `line`, `updated_at`, `column`, `full_line`, `tab_id`, `component_id`) VALUES('2011-04-22 17:55:55', 5, '2011-04-22 17:55:55', 1, 1, 1, 5)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 10ms (View: 0, DB: 6) | 200 OK [http://test.host/company/tab_components/create/5?tab_component%5Bcolumn%5D=1&tab_component%5Bfull_line%5D=true&tab_component%5Bline%5D=5&tab_component%5Btab_id%5D=1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;35;1mSQL (11.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tab_components` [0m


Processing Company::TabComponentsController#update (for 0.0.0.0 at 2011-04-22 14:55:55) [PUT]
  Parameters: {"id"=>#<ComponentText id: 5, layout_id: 1, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "full_line"=>true}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (`components`.`id` = 5)) LIMIT 1[0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.component_id = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Update (0.3ms)[0m   [0mUPDATE `tab_components` SET `updated_at` = '2011-04-22 17:55:55', `full_line` = 1 WHERE `id` = 148646006[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 8ms (View: 0, DB: 15) | 200 OK [http://test.host/company/tab_components/update/5?full_line=true]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `tab_components` [0m
  [4;36;1mComponentText Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) AND ( (`components`.`type` = 'ComponentText' ) ) [0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `tabs` [0m


Processing Company::TabsController#create (for 0.0.0.0 at 2011-04-22 14:55:55) [POST]
  Parameters: {"tab"=>{"title"=>"Aba 1"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Create (0.4ms)[0m   [0;1mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:55:56', 'Aba 1', '2011-04-22 17:55:56', NULL, 1)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 122ms (View: 1, DB: 5) | 200 OK [http://test.host/company/tabs/create?tab%5Btitle%5D=Aba+1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabsController#destroy (for 0.0.0.0 at 2011-04-22 14:55:56) [POST]
  Parameters: {"id"=>#<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", order: 1.0>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTab Load (0.4ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 1) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 11ms (View: 0, DB: 6) | 200 OK [http://test.host/company/tabs/destroy/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `tabs` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mTab Load (0.2ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2) [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m


Processing Company::TabsController#reorder (for 0.0.0.0 at 2011-04-22 14:55:56) [POST]
  Parameters: {"tab_ids"=>[#<Tab id: 2, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", order: 2.0>, #<Tab id: 1, layout_id: 1, title: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", order: 1.0>]}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTab Load (0.3ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 2) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Update (0.2ms)[0m   [0;1mUPDATE `tabs` SET `updated_at` = '2011-04-22 17:55:56', `order` = 1.0 WHERE `id` = 2[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1 AND (`tabs`.layout_id = 1)) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id = 1) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTab Update (0.4ms)[0m   [0;1mUPDATE `tabs` SET `updated_at` = '2011-04-22 17:55:56', `order` = 2.0 WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 14ms (View: 0, DB: 6) | 200 OK [http://test.host/company/tabs/reorder?tab_ids%5B%5D=2&tab_ids%5B%5D=1]
  [4;36;1mTab Load (0.3ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 1) [0m
  [4;35;1mTab Load (0.2ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.`id` = 2) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#edit (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (3.1ms)
Rendered company/accounts/_password (3.7ms)
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 26ms (View: 18, DB: 4) | 200 OK [http://test.host/company/users/edit]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"user"=>{"login"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL AND `users`.id <> 12) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx2@emp.com' AND `users`.id <> 12) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (1.3ms)
Rendered company/accounts/_password (1.5ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 26ms (View: 18, DB: 3) | 200 OK [http://test.host/company/users/update?user%5Blogin%5D=]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update_profile_logo (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"company"=>{}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20006' AND `companies`.id <> 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
Rendered company/accounts/_form (1.2ms)
Rendered company/accounts/_password (1.5ms)
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 23ms (View: 14, DB: 3) | 200 OK [http://test.host/company/users/update_profile_logo?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::UsersController#update (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 12) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx2@emp.com' AND `users`.id <> 12) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:55:56', `login` = 'quentin2' WHERE `id` = 12[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/company
Rendering company/users/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
Rendered company/accounts/_form (1.2ms)
Rendered company/accounts/_password (1.4ms)
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 24ms (View: 14, DB: 4) | 200 OK [http://test.host/company/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUserAdministrator Columns (1.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_to_z (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyS Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) AND ( (`companies`.`type` = 'CompanyS' ) ) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
Rendering template within layouts/new_admin
Rendering company_management/change_to_z
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 28ms (View: 18, DB: 10) | 200 OK [http://test.host/company_management/change_to_z/4-MyString]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing CompanyManagementController#change_type_to_s (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompanyZ Update (0.3ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:55:56', `type` = 'CompanyS' WHERE `id` = 7[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_s\nargs: \n- LOAD;CompanyZ;7\n', '2011-04-22 17:55:56', 0, '2011-04-22 17:55:56', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.7ms)
Rendered companies/_company_show (7.8ms)
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (7.9ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 43ms (View: 30, DB: 7) | 200 OK [http://test.host/company_management/change_type_to_s/7-MyString]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"company"=>{"register_number"=>"TESTESTESTES"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;36;1mCompanyS Update (0.4ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:55:56', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:55:56', 0, '2011-04-22 17:55:56', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.5ms)
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUserWebAdministrator Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mPerson Load (0.9ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (9.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 54ms (View: 22, DB: 13) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bregister_number%5D=TESTESTESTES]
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing CompanyManagementController#change_type_to_z (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"company"=>{"parcel"=>1, "register_number"=>"TESTESTESTES", "value"=>50.0}, "person"=>{"cpf"=>"099.033.907-69"}, "id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20003' AND `companies`.id <> 4) LIMIT 1[0m
  [4;36;1mSegment Load (0.1ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.4ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:55:56', `register_number` = 'TESTESTESTES', `type` = 'CompanyZ' WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:56', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_changed_to_z\nargs: \n- LOAD;CompanyS;4\n', '2011-04-22 17:55:56', 0, '2011-04-22 17:55:56', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4 AND (status='Aberto')) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.4ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(1, '2011-04-22 17:55:56', '2011-04-22 17:55:52', '2011-04-22 17:55:56', 50.0, 4, '2012-04-22 17:55:52', 'Aberto')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:55:56', `cpf` = '099.033.907-69' WHERE `id` = 9[0m
Rendering template within layouts/new_admin
Rendering company_management/show
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.4ms)
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (6.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 51ms (View: 20, DB: 13) | 200 OK [http://test.host/company_management/change_type_to_z/4-MyString?company%5Bparcel%5D=1&company%5Bregister_number%5D=TESTESTESTES&company%5Bvalue%5D=50.0&person%5Bcpf%5D=099.033.907-69]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 23ms (View: 17, DB: 5) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IN (12,7,8,5)) [0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7) [0m
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 40ms (View: 27, DB: 10) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing CompanyManagementController#index (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSegment Load (0.1ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering company_management/index
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` ORDER BY name[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 17ms (View: 10, DB: 4) | 200 OK [http://test.host/company_management]
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"id"=>"8"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '8') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` WHERE (`companies`.`id` = 5) [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/8]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"id"=>"XXX"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 'XXX') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/company_management
Completed in 3ms (DB: 1) | 302 Found [http://test.host/company_management/loggin_as_company/XXX]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"id"=>"5"}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 4ms (DB: 2) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m


Processing CompanyManagementController#loggin_as_company (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  Parameters: {"id"=>"5"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = '5') AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(`companies`.id) AS count_id FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1 and companies.id=3) ORDER BY companies.razao_social [0m
Redirected to http://test.host/
Completed in 6ms (DB: 3) | 302 Found [http://test.host/company_management/loggin_as_company/5]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing CompanyManagementController#loggout_as_company (for 0.0.0.0 at 2011-04-22 14:55:56) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Redirected to http://test.host/
Completed in 1ms (DB: 1) | 302 Found [http://test.host/company_management/loggout_as_company]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#edit (for 0.0.0.0 at 2011-04-22 14:55:56) [PUT]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering company_management/edit
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered companies/_company_edit (4.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 15, DB: 2) | 200 OK [http://test.host/company_management/edit/5-MyString]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyManagementController#update (for 0.0.0.0 at 2011-04-22 14:55:56) [PUT]
  Parameters: {"company"=>{}, "id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management/show/5-MyString
Completed in 8ms (DB: 3) | 302 Found [http://test.host/company_management/update/5-MyString?]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.2ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 3 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 3) LIMIT 1[0m
  [4;36;1mCompanyRelationship Create (0.2ms)[0m   [0;1mINSERT INTO `company_relationships` (`company_origin_id`, `created_at`, `confirmed`, `company_destiny_id`, `updated_at`) VALUES(5, '2011-04-22 17:55:56', 0, 3, '2011-04-22 17:55:56')[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_destiny_id WHERE ((`company_relationships`.company_origin_id = 5)) LIMIT 1[0m
  [4;35;1mSQL (161.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_destiny_id` = 5 AND `company_relationships`.company_origin_id = 5) LIMIT 1[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT `company_relationships`.id FROM `company_relationships` WHERE (`company_relationships`.`company_origin_id` = 5 AND `company_relationships`.company_destiny_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing CompanySellerController#create (for 0.0.0.0 at 2011-04-22 14:55:57) [GET]
  Parameters: {"company"=>{"person_id"=>1}, "id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:55:57', `user_web_adm_id` = NULL WHERE `id` = 7[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20004' AND `companies`.id <> 3) LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompanyS Update (0.3ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:55:57', `person_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 25ms (DB: 174) | 302 Found [http://test.host/company_seller/create/3?company%5Bperson_id%5D=1]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing CompanySellerController#destroy (for 0.0.0.0 at 2011-04-22 14:55:57) [GET]
  Parameters: {"id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;36;1mSegment Load (0.1ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompanyZ Update (0.4ms)[0m   [0mUPDATE `companies` SET `updated_at` = '2011-04-22 17:55:57', `person_id` = NULL WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company_management
Completed in 8ms (DB: 3) | 302 Found [http://test.host/company_seller/destroy/5-MyString]
  [4;35;1mCompanyZ Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) AND ( (`companies`.`type` = 'CompanyZ' ) ) [0m
  [4;36;1mSQL (14.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:55:57) [GET]
  Parameters: {"id"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mUserSegmentManager Columns (11.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering company_seller/new
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 30ms (View: 11, DB: 30) | 200 OK [http://test.host/company_seller/new/3]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing CompanySellerController#new (for 0.0.0.0 at 2011-04-22 14:55:57) [GET]
  Parameters: {"id"=>"XXXXX"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 0) [0m
Redirected to http://test.host/company_management
Completed in 2ms (DB: 1) | 302 Found [http://test.host/company_seller/new/XXXXX]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ518897') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:55:57', NULL, '2011-04-22 17:55:57', '76.633.274/0001-80', NULL, NULL, NULL, 'CompanyS', 'SZ518897', NULL, 'MyString', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 26) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.4ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('MyString', NULL, NULL, '2011-04-22 17:55:57', NULL, NULL, '2011-04-22 17:55:57', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 26, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.2ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 20) LIMIT 1[0m
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 20, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:57', `name` = 'MyString', `created_at` = '2011-04-22 17:55:57', `company_id` = 26 WHERE `id` = 20[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.5ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.3ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 20, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.4ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:55:57', `layout_id` = NULL WHERE `id` = 980190993[0m
  [4;36;1mFeedItem Create (0.4ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:55:57', 0, '2011-04-22 17:55:57', 0, 1, 26, 'Company')[0m
  [4;35;1mFeed Create (0.3ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:57', '2011-04-22 17:55:57', 26, 35)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 26) [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0m
 SELECT companies.* FROM companies as companies 
 JOIN company_relationships as destinies 
 ON (companies.id = destinies.company_origin_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (destinies.company_destiny_id=5) 
 UNION SELECT companies.* 
 FROM companies as companies 
 JOIN company_relationships as origins 
 ON (companies.id = origins.company_destiny_id and confirmed=true) 
 JOIN layouts as layouts
 ON (companies.id = layouts.company_id)
 WHERE (origins.company_origin_id=5) LIMIT 0, 5[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT `companies`.* FROM `companies` INNER JOIN `company_relationships` ON `companies`.id = `company_relationships`.company_origin_id WHERE ((`company_relationships`.company_destiny_id = 5) AND ((confirmed=0))) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:55:57' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.6ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:55:57' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:55:49' and our_number is not null)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing CompanyToFriendController#create (for 0.0.0.0 at 2011-04-22 14:55:57) [GET]
  Parameters: {"email_from"=>"bruno_sil@yahoo.com.br", "company_id"=>"5", "name_from"=>"Bruno Siqueira", "email_to"=>"bsiqueira@gmail.com"}
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:55:57', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;CompanyMailer\nmethod: :deliver_new_send_to_friend\nargs: \n- bsiqueira@gmail.com\n- LOAD;CompanyZ;5\n', '2011-04-22 17:55:57', 0, '2011-04-22 17:55:57', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:57', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 17ms (View: 1, DB: 16) | 200 OK [http://test.host/company_to_friend?company_id=5&email_from=bruno_sil%40yahoo.com.br&email_to=bsiqueira%40gmail.com&name_from=Bruno+Siqueira]
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Assigning #<File:test/resources/images/rails.png> to photo
[paperclip] Writing attributes for photo
[paperclip] Post-processing photo
  [4;36;1mComponentGallery Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 17:55:57', NULL, NULL, NULL, '2011-04-22 17:55:57', 1, 0, NULL, 1, 'ComponentGallery', NULL, 1, NULL, 1, NULL, 2, 1)[0m
  [4;35;1mPicture Create (0.4ms)[0m   [0mINSERT INTO `pictures` (`created_at`, `photo_file_size`, `title`, `updated_at`, `photo_file_name`, `photo_content_type`, `description`, `component_id`, `component_type`) VALUES('2011-04-22 17:55:57', 6646, NULL, '2011-04-22 17:55:57', 'rails.png', 'image/png', NULL, 19, 'Component')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/6/big/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/6/thumb/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/6/original/rails.png
[paperclip] -> /Users/brunosilva/NetBeansProjects/sua_empreza/public/photos/6/normal/rails.png
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` [0m
  [4;36;1mSQL (38.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 5) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mLayout Update (0.6ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:55:57', `font_colors` = '0x00000a;0x333333' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mComponentText Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:55:57', `description` = ' bruno sqiueira COLOR=\"#000000\" oiasjdosadijoasidjasoij COLOR=\"#333333\" COLOR=\"#00000a\" ' WHERE `id` = 5[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
  [4;35;1mComponentPicture Update (0.2ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 17:55:57', `title` = 'ola' WHERE `id` = 7[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for picture
[paperclip] Deleting files for picture
[paperclip] Writing files for picture
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mContract Load Including Associations (0.7ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:55:57' and end_date>='2011-04-22 14:55:57') [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:55:57) [POST]
  Parameters: {"contract"=>{"parcel"=>12, "initial_date"=>"2008-02-12", "value"=>50.0, "status"=>"Aberto", "end_date"=>"2009-02-12"}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:55:57', '2008-02-12', '2011-04-22 17:55:57', 50.0, 4, '2009-02-12', 'Aberto')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/19
Completed in 16ms (DB: 55) | 302 Found [http://test.host/companies/4-MyString/contracts?contract%5Bend_date%5D=2009-02-12&contract%5Binitial_date%5D=2008-02-12&contract%5Bparcel%5D=12&contract%5Bstatus%5D=Aberto&contract%5Bvalue%5D=50.0]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.1ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m


Processing ContractsController#destroy (for 0.0.0.0 at 2011-04-22 14:55:57) [DELETE]
  Parameters: {"id"=>#<Contract id: 4, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;35;1mContract Load (0.1ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 4 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.2ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 4[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts
Completed in 11ms (DB: 5) | 302 Found [http://test.host/companies/4-MyString/contracts/4]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#edit (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.3ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/edit
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 29ms (View: 26, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#index (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/index
  [4;36;1mContract Load (0.5ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 22ms (View: 17, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts]
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 4) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#new (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 177ms (View: 173, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts/new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m


Processing ContractsController#create (for 0.0.0.0 at 2011-04-22 14:55:58) [POST]
  Parameters: {"contract"=>{}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering contracts/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 40ms (View: 33, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts?]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#show (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", value: 50.0, parcel: 12>, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering contracts/show
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (titles.status<>'Liquidado')) [0m
Rendered titles/_title (1.2ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
Rendered titles/_title (0.4ms)
Rendered titles/_title (0.3ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 1 AND (`titles`.`status` = 'Liquidado')) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 25ms (View: 20, DB: 3) | 200 OK [http://test.host/companies/4-MyString/contracts/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing ContractsController#update (for 0.0.0.0 at 2011-04-22 14:55:58) [PUT]
  Parameters: {"id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", value: 50.0, parcel: 12>, "contract"=>{}, "company_id"=>#<CompanyS id: 4, user_id: 7, cnpj: "55.086.845/0001-33", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyS", informal: nil, drawee_code: "SZ20003", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1 AND (`contracts`.company_id = 4)) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/companies/4-MyString/contracts/1
Completed in 7ms (DB: 2) | 302 Found [http://test.host/companies/4-MyString/contracts/1?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing DomainsController#update (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"id"=>"8", "value"=>"empresa.com.br"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:55:58', `domain` = 'empresa.com.br' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 14ms (View: 0, DB: 3) | 200 OK [http://test.host/domains/update/8?value=empresa.com.br]
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (344.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mFeedItem Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mFeedLike Load (0.2ms)[0m   [0;1mSELECT `feed_likes`.id FROM `feed_likes` WHERE (`feed_likes`.`company_id` = 7 AND `feed_likes`.feed_item_id = 1) LIMIT 1[0m
  [4;35;1mFeedLike Create (0.3ms)[0m   [0mINSERT INTO `feed_likes` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:55:58', '2011-04-22 17:55:58', 7, 1)[0m
  [4;36;1mFeedItem Load (0.2ms)[0m   [0;1mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;35;1mFeedItem Update (0.2ms)[0m   [0mUPDATE `feed_items` SET `feed_likes_count` = COALESCE(`feed_likes_count`, 0) + 1 WHERE (`id` = 1) [0m
  [4;36;1mFeedItem Update (0.3ms)[0m   [0;1mUPDATE `feed_items` SET `updated_at` = '2011-04-22 17:55:58' WHERE `id` = 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `feed_likes` [0m
  [4;35;1mFeedItem Load (0.2ms)[0m   [0mSELECT * FROM `feed_items` WHERE (`feed_items`.`id` = 1) [0m
  [4;36;1mSQL (2.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.6ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:55:58' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompanyZ Load Including Associations (0.7ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:55:58' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 30ms (View: 17, DB: 354) | 200 OK [http://test.host/financial/company_no_active_contracts]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNoActiveContractsController#index (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"id"=>[]}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:55:58' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompanyZ Load Including Associations (0.6ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `users`.`id` AS t1_r0, `users`.`login` AS t1_r1, `users`.`email` AS t1_r2, `users`.`crypted_password` AS t1_r3, `users`.`salt` AS t1_r4, `users`.`created_at` AS t1_r5, `users`.`updated_at` AS t1_r6, `users`.`remember_token` AS t1_r7, `users`.`remember_token_expires_at` AS t1_r8, `users`.`activation_code` AS t1_r9, `users`.`activated_at` AS t1_r10, `users`.`password_reset_code` AS t1_r11, `users`.`enabled` AS t1_r12, `users`.`type` AS t1_r13, `users`.`self_created` AS t1_r14, `users`.`avatar_file_name` AS t1_r15, `users`.`avatar_content_type` AS t1_r16, `users`.`avatar_file_size` AS t1_r17, `users`.`avatar_updated_at` AS t1_r18, `users`.`domain` AS t1_r19, `segments`.`id` AS t2_r0, `segments`.`name` AS t2_r1, `segments`.`file` AS t2_r2, `contracts`.`id` AS t3_r0, `contracts`.`company_id` AS t3_r1, `contracts`.`initial_date` AS t3_r2, `contracts`.`end_date` AS t3_r3, `contracts`.`status` AS t3_r4, `contracts`.`created_at` AS t3_r5, `contracts`.`updated_at` AS t3_r6, `contracts`.`value` AS t3_r7, `contracts`.`parcel` AS t3_r8 FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id LEFT OUTER JOIN `segments` ON `segments`.id = `companies`.segment_id LEFT OUTER JOIN `contracts` ON contracts.company_id = companies.id WHERE (not exists (select * from contracts as c where c.end_date >= '2011-04-22 14:55:58' and c.company_id = companies.id)) AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (5) ORDER BY razao_social[0m
Rendering template within layouts/new_admin
Rendering financial/company_no_active_contracts/index
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 9, DB: 3) | 200 OK [http://test.host/financial/company_no_active_contracts/index/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::CompanyNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load (0.8ms)[0m   [0;1mSELECT distinct companies.* as companies FROM `companies` join titles as titles on titles.company_id = companies.id WHERE (titles.status <> 'Liquidado' and titles.due_date < '2011-04-22 14:55:58' and your_number is not null) AND ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/index
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 145ms (View: 13, DB: 4) | 200 OK [http://test.host/financial/company_not_payed]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m


Processing Financial::CompanyNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"id"=>#<CompanyZ id: 7, user_id: 12, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: nil, payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20006", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompanyZ Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT `contracts`.* FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
Rendering template within layouts/new_admin
Rendering financial/company_not_payed/show
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mAddress Load (0.2ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.2ms)
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:55:49' and our_number is not null)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 22ms (View: 17, DB: 4) | 200 OK [http://test.host/financial/company_not_payed/show/7-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:55:58) [GET]
  Parameters: {"month"=>"4"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mContract Load Including Associations (0.7ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-04-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:55:59' and end_date>='2011-04-22 14:55:59') [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-05-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;36;1mTitle Create (0.4ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:55:59', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:55:59', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-05-22 00:00:00', 0.2, '2011-04-22 14:55:59', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 27ms (View: 8, DB: 4) | 200 OK [http://test.host/financial/main/generate_new_titles?month=4]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;36;1mSQL (13.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m


Processing Financial::MainController#generate_new_titles (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"month"=>"3"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mContract Load Including Associations (0.6ms)[0m   [0mSELECT `contracts`.`id` AS t0_r0, `contracts`.`company_id` AS t0_r1, `contracts`.`initial_date` AS t0_r2, `contracts`.`end_date` AS t0_r3, `contracts`.`status` AS t0_r4, `contracts`.`created_at` AS t0_r5, `contracts`.`updated_at` AS t0_r6, `contracts`.`value` AS t0_r7, `contracts`.`parcel` AS t0_r8, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `contracts` LEFT OUTER JOIN `companies` ON `companies`.id = `contracts`.company_id WHERE (status='Aberto' and not exists (select 1 from titles where contracts.id = titles.contract_id and titles.emission_date >= '2011-03-01 00:00:00') and companies.type = 'CompanyZ' and initial_date<='2011-04-22 14:55:59' and end_date>='2011-04-22 14:55:59') [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.contract_id = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2011-04-22 00:00:00' AND `titles`.your_number = 'SZ20006') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(2.0, '2011-04-22 17:55:59', 'SZ20006', 0, NULL, NULL, '2011-04-22 17:55:59', 'Sem desconto', '0', NULL, NULL, 50.0, NULL, 7, '2011-04-22 00:00:00', 0.2, '2011-04-22 14:55:59', NULL, 'C√©lula Z - servi√ßos de internet\nAp√≥s vencimento, cobrar multa de 2%\nJuros ao dia: R$ 0,50 ap√≥s o vencimento', NULL, 'Digitado', 3)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/main/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 7, DB: 18) | 200 OK [http://test.host/financial/main/generate_new_titles?month=3]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date ASC LIMIT 1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:55:59) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COB01.TXT>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.6ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33336' AND `titles`.`due_date` = '2009-05-13') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33333' AND `titles`.`due_date` = '2009-05-15') LIMIT 1[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33335' AND `titles`.`due_date` = '2009-05-02') LIMIT 1[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33310' AND `titles`.`due_date` = '2009-05-07') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '22a33337' AND `titles`.`due_date` = '2009-05-08') LIMIT 1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`your_number` = '827495320r' AND `titles`.`due_date` = '2009-03-20') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 37ms (View: 10, DB: 5) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x1063853e0%3E]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#create (for 0.0.0.0 at 2011-04-22 14:55:59) [PUT]
  Parameters: {"return"=>#<File:test/resources/return/COBERROR.TXT>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 9ms (View: 7, DB: 1) | 200 OK [http://test.host/financial/receive_return/create?return=%23%3CFile%3A0x106282830%3E]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ReceiveReturnController#new (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/receive_return/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/financial/receive_return/new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::SendShippingController#index (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.5ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`status` = 'Aberto') [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/index
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 2)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 14, DB: 3) | 200 OK [http://test.host/financial/send_shipping]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#create (for 0.0.0.0 at 2011-04-22 14:55:59) [PUT]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.4ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`processing_date` = '2011-04-22 14:55:59' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;36;1mShipping Update (0.3ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:55:59', `processing_date` = '2011-04-22 14:55:59' WHERE `id` = 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.4ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.5ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mUserDirector Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUserDirector Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
  [4;35;1mUserAdministrator Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) LIMIT 1[0m
Sent mail to quentin@example.com, quentin@example.com

Date: Fri, 22 Apr 2011 14:55:59 -0300
From: bsiqueira@suaempreza.com.br
To: quentin@example.com,
	 quentin@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D=3A_Gera=C3=A7=C3=A3o_de_Cobran=C3=A7a?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1>Envio de Remessa</h1>
<p>
  C√≥digo da Remessa: MyString
</p>

<p>
  Quantidade de T√≠tulos: 2
</p>

<p>
  Valor da Remessa: 3,00
</p>

<p>
  Voc√™ pode realizar o download do arquivo remessa no endere√ßo:<br>
  <a href="http://localhost:3000/financial/shippings/1">http://localhost:3000/financial/shippings/1</a>
</p>
<small>
  O envio da remessa para o banco deve ser realizado ainda na data corrente.
</small>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
  [4;36;1mTitle Update (0.5ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Enviado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.5ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Enviado' WHERE `id` = 3[0m
  [4;36;1mShipping Update (0.5ms)[0m   [0;1mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:55:59', `file_name` = 'MyString_2204111455.txt', `file_content_type` = 'text/plain', `file_data` = x'303152454d455353413031434f4252414e434120202020202020303033343330353733393639342020202020202043c3a96c756c61204950202020202020202020202020202020202020202033353642616e636f205265616c20202020203232303431313031363030425049202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030310a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030382020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030320a383130303334333035373339363934323175303030382020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030330a31303230392e3233352e3033332f303030303033343330353733393639342020202020202020202020202020202020202020202020202020202020202020303030303030303030303031313030303030303030303031353020202020202020303030303030303030203030353031323175303030372020203135303230393030303030303030303031353033353620202020203036413133303230393939202020303030303030303030313530313330323039303030303030303030303135302020202020202020202020202030303030303030303030313530303231353735343035363030303130394d79537472696e6720202020202020202020202020202020202020202020202020202020202020204d79537472696e6720313131312020202020202020202020202020202020202020202020202020204d795372696e6720202020204d795374726e67204d79537472696e6720202020202020524a202020202020202020202020202020202020202020202020202020202020202020202020202020203030373030303030340a383130303334333035373339363934323175303030372020204d79537472696e67202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030350a393030303030323030303030303030303033303020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020203030303030360a' WHERE `id` = 1[0m
  [4;35;1mShipping Update (0.3ms)[0m   [0mUPDATE `shippings` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Enviado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 175ms (View: 8, DB: 15) | 200 OK [http://test.host/financial/send_shipping/create/1]
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::SendShippingController#show (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"id"=>#<Shipping id: 1, code: "MyString", status: "Aberto", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", processing_date: nil, file_name: nil, file_content_type: nil, file_data: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/send_shipping/show
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 13ms (View: 9, DB: 6) | 200 OK [http://test.host/financial/send_shipping/show/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.5ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mConstant Load (0.3ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.1ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.3ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.3ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:55:59', '2011-04-22 17:55:59', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Create (0.3ms)[0m   [0mINSERT INTO `shipping_titles` (`created_at`, `updated_at`, `shipping_id`, `title_id`, `status`) VALUES('2011-04-22 17:55:59', '2011-04-22 17:55:59', 1, 1, 'Selecionado')[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.`id` = 964567538) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Digitado' WHERE `id` = 1[0m
  [4;35;1mShippingTitle Destroy (0.3ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567538[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m


Processing Financial::ShippingsController#create (for 0.0.0.0 at 2011-04-22 14:55:59) [POST]
  Parameters: {"shipping"=>{}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` IS NULL) LIMIT 1[0m
  [4;35;1mShipping Create (0.2ms)[0m   [0mINSERT INTO `shippings` (`created_at`, `code`, `updated_at`, `file_content_type`, `file_data`, `file_name`, `processing_date`, `status`) VALUES('2011-04-22 17:55:59', NULL, '2011-04-22 17:55:59', NULL, NULL, NULL, NULL, 'Aberto')[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/7
Completed in 10ms (DB: 16) | 302 Found [http://test.host/financial/remessas?]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mShipping Load (0.1ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#destroy (for 0.0.0.0 at 2011-04-22 14:55:59) [DELETE]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE (our_number is not null) AND ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mShipping Destroy (0.1ms)[0m   [0mDELETE FROM `shippings` WHERE `id` = 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas
Completed in 15ms (DB: 6) | 302 Found [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `shippings` [0m
  [4;36;1mSQL (11.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#edit (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/edit
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
Rendered titles/_titles (8.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 23ms (View: 16, DB: 17) | 200 OK [http://test.host/financial/remessas/1/edit]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#index (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/index
Rendered financial/shippings/_download (0.3ms)
Rendered financial/shippings/_download (0.1ms)
Rendered financial/shippings/_download (1.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 16, DB: 2) | 200 OK [http://test.host/financial/remessas]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::ShippingsController#new (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering financial/shippings/new
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 11ms (View: 9, DB: 1) | 200 OK [http://test.host/financial/remessas/new]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mShipping Load (0.4ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#show (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mShipping Load (0.2ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering financial/shippings/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
Rendered financial/shippings/_download (0.1ms)
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((titles.status<>'Liquidado'))) [0m
Rendered titles/_title (0.6ms)
Rendered titles/_title (0.4ms)
  [4;35;1mTitle Load (0.5ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1) AND ((`titles`.`status` = 'Liquidado'))) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 15, DB: 4) | 200 OK [http://test.host/financial/remessas/1]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mShipping Load (0.3ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m


Processing Financial::ShippingsController#update (for 0.0.0.0 at 2011-04-22 14:55:59) [PUT]
  Parameters: {"id"=>"1", "shipping"=>{}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mShipping Load (0.2ms)[0m   [0;1mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShipping Load (0.4ms)[0m   [0;1mSELECT `shippings`.id FROM `shippings` WHERE (`shippings`.`code` = BINARY 'MyString' AND `shippings`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/remessas/1
  [4;36;1mShippingTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.shipping_id = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.4ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.4ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:55:59', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.4ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 137ms (DB: 6) | 302 Found [http://test.host/financial/remessas/1?]
  [4;35;1mSQL (1.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:55:59) [POST]
  Parameters: {"title"=>{"your_number"=>"SZ20002", "discount_type"=>"Sem desconto", "value"=>450.0, "due_date"=>"2009-05-05", "emission_date"=>"2009-05-01", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'SZ20002') LIMIT 1[0m
  [4;36;1mTitle Create (0.4ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(NULL, '2011-04-22 17:55:59', 'SZ20002', NULL, NULL, NULL, '2011-04-22 17:55:59', 'Sem desconto', NULL, NULL, NULL, 450.0, NULL, 5, '2009-05-05', NULL, '2009-05-01', NULL, NULL, NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/25
Completed in 18ms (DB: 5) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bvalue%5D=450.0&title%5Byour_number%5D=SZ20002]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mCompany Load (0.1ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.1ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m


Processing Financial::TitlesController#create (for 0.0.0.0 at 2011-04-22 14:55:59) [POST]
  Parameters: {"title"=>{"fine_percent"=>"33,33", "your_number"=>"AZ924330", "abatement_value"=>"", "interest_type"=>"0", "discount_type"=>"Sem desconto", "value"=>"323,33", "interest_percent"=>"0,50", "due_date"=>"2009-05-05", "emission_date"=>"2009-05-01", "discount_value"=>"", "additional_data"=>"cdcscscsscdssd", "contract_id"=>#<Contract id: 1, company_id: 4, initial_date: "2011-03-22", end_date: "2012-04-22", status: "Aberto", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", value: 50.0, parcel: 12>}, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-05-05' AND `titles`.your_number = 'AZ924330') LIMIT 1[0m
  [4;36;1mTitle Create (0.3ms)[0m   [0;1mINSERT INTO `titles` (`fine_percent`, `created_at`, `your_number`, `days_to_charge_fine`, `occurrency_complement`, `abatement_value`, `updated_at`, `discount_type`, `interest_type`, `occurrency`, `error_message`, `value`, `our_number`, `company_id`, `due_date`, `interest_percent`, `emission_date`, `discount_value`, `additional_data`, `discount_limit_date`, `status`, `contract_id`) VALUES(33.33, '2011-04-22 17:55:59', 'AZ924330', NULL, NULL, 0.0, '2011-04-22 17:55:59', 'Sem desconto', '0', NULL, NULL, 323.33, NULL, 5, '2009-05-05', 0.5, '2009-05-01', 0.0, 'cdcscscsscdssd', NULL, 'Digitado', 1)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/26
Completed in 13ms (DB: 4) | 302 Found [http://test.host/financial/companies/5-MyString/titles?title%5Babatement_value%5D=&title%5Badditional_data%5D=cdcscscsscdssd&title%5Bcontract_id%5D=1&title%5Bdiscount_type%5D=Sem+desconto&title%5Bdiscount_value%5D=&title%5Bdue_date%5D=2009-05-05&title%5Bemission_date%5D=2009-05-01&title%5Bfine_percent%5D=33%2C33&title%5Binterest_percent%5D=0%2C50&title%5Binterest_type%5D=0&title%5Bvalue%5D=323%2C33&title%5Byour_number%5D=AZ924330]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 26) [0m
  [4;36;1mSQL (10.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#destroy (for 0.0.0.0 at 2011-04-22 14:55:59) [DELETE]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles
Completed in 9ms (DB: 16) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` [0m
  [4;36;1mSQL (2.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#edit (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/edit
  [4;35;1mContract Load (0.6ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 43ms (View: 37, DB: 7) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#index (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` ORDER BY due_date desc LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/index
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 45ms (View: 41, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing Financial::TitlesController#index_new (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompanyZ Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE ( (`companies`.`type` = 'CompanyZ' ) ) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering financial/titles/index_new
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at ASC LIMIT 1[0m
  [4;36;1mSegment Load (0.2ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mContract Load (0.3ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at ASC LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 14, DB: 5) | 200 OK [http://test.host/financial/titles/index_new]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#new (for 0.0.0.0 at 2011-04-22 14:55:59) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/new
  [4;36;1mContract Load (0.6ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 163ms (View: 158, DB: 3) | 200 OK [http://test.host/financial/companies/5-MyString/titles/new]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesController#show (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
Rendering template within layouts/new_admin
Rendering financial/titles/show
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 17ms (View: 11, DB: 4) | 200 OK [http://test.host/financial/companies/5-MyString/titles/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesController#update (for 0.0.0.0 at 2011-04-22 14:56:00) [PUT]
  Parameters: {"title"=>{}, "id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mContract Load (0.2ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.`id` = 1) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT `titles`.id FROM `titles` WHERE (`titles`.`due_date` = '2009-02-15' AND `titles`.your_number = '21u0005' AND `titles`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/financial/companies/5-MyString/titles/1
Completed in 11ms (DB: 4) | 302 Found [http://test.host/financial/companies/5-MyString/titles/1?]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m


Processing Financial::TitlesNotPayedController#index (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mTitle Load (0.6ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) ORDER BY created_at desc LIMIT 0, 30[0m
Rendering template within layouts/company
Rendering financial/titles_not_payed/index
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
Completed in 23ms (View: 14, DB: 3) | 200 OK [http://test.host/titulos-nao-pagos?company_id=5-MyString]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m


Processing Financial::TitlesNotPayedController#show (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>#<Title id: 1, company_id: 5, contract_id: 1, emission_date: "2009-02-13", due_date: "2009-02-15", value: 1.5, fine_percent: 1.5, days_to_charge_fine: 1, interest_percent: 1.5, abatement_value: 1.5, discount_value: 1.5, discount_type: "Sem desconto", discount_limit_date: "2009-02-13", additional_data: "MyString", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", status: "Digitado", our_number: nil, your_number: "21u0005", occurrency: nil, occurrency_complement: nil, interest_type: nil, error_message: nil>, "company_id"=>#<CompanyZ id: 5, user_id: 8, cnpj: "15.754.056/0001-09", razao_social: "MyString", created_at: "2011-04-22 17:55:52", updated_at: "2011-04-22 17:55:52", person_id: "13", payment_type: "mensal", segment_id: "1", state_id: nil, type: "CompanyZ", informal: nil, drawee_code: "SZ20002", register_number: nil, profile_logo_file_name: nil, profile_logo_content_type: nil, profile_logo_file_size: nil, profile_logo_updated_at: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1 AND (`titles`.company_id = 5)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mConstant Load (0.4ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'agencia_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'conta_cedente') LIMIT 1[0m
  [4;36;1mConstant Load (0.2ms)[0m   [0;1mSELECT * FROM `constants` WHERE (`constants`.`key` = 'cnpj_cedente') LIMIT 1[0m
  [4;35;1mConstant Load (0.2ms)[0m   [0mSELECT * FROM `constants` WHERE (`constants`.`key` = 'nome_cedente') LIMIT 1[0m
Rendering financial/titles_not_payed/show
Completed in 23ms (View: 12, DB: 4) | 200 OK [http://test.host/financial/titles_not_payed/show/1?company_id=5-MyString]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:56:00', `send_to_friend` = 1 WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mSQL (2.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 1 AND (components.id is not null)) [0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tabs`.id) AS count_all FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 3ms (DB: 7) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
Redirected to http://test.host/empresa-inicio
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 1ms (DB: 1) | 302 Found [http://test.host/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing MainController#index (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
Rendering template within layouts/main
Rendering main/index
  [4;36;1mLayout Load IDs For Limited Eager Loading (0.7ms)[0m   [0;1mSELECT DISTINCT `layouts`.id FROM `layouts` LEFT OUTER JOIN `companies` ON `companies`.id = `layouts`.company_id WHERE (companies.type = 'CompanyZ' and companies.id in (176,173,207,213,206,47,178,28,182)) ORDER BY layouts.updated_at LIMIT 8[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (1.4ms)
Completed in 22ms (View: 15, DB: 1) | 200 OK [http://test.host/]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Filter chain halted as [:redirect_if_logged] rendered_or_redirected.
Completed in 2ms (DB: 1) | 302 Found [http://test.host/main/natal]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing MainController#natal (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
Rendering template within layouts/main
Rendering main/natal
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (0.8ms)
Completed in 7ms (View: 6, DB: 1) | 200 OK [http://test.host/main/natal]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.1ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) [0m
  [4;35;1mMessageCopy Load (0.2ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.`id` = 1) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.4ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 2) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mMessage Load (0.2ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m


Processing MessagesController#create (for 0.0.0.0 at 2011-04-22 14:56:00) [POST]
  Parameters: {"message"=>{"sender_email"=>"tester@gmail.com", "body"=>"Corpo da mensagem", "subject"=>"Teste - Mensagem enviada do business card", "to"=>"8"}}
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.4ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES('tester@gmail.com', '2011-04-22 17:56:00', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:56:00', 'Teste - Mensagem enviada do business card', NULL, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.4ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.4ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 14) [0m
  [4;35;1mMessageCopy Create (0.4ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:56:00', NULL, 8, NULL, NULL, 14)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:00', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;13\n', '2011-04-22 17:56:00', 0, '2011-04-22 17:56:00', 0, NULL, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:56:00', 0, '2011-04-22 17:56:00', 0, 0, 14, 'Message')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:56:00', '2011-04-22 17:56:00', 5, 36)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 25ms (View: 0, DB: 12) | 200 OK [http://test.host/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender_email%5D=tester%40gmail.com&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+business+card&message%5Bto%5D=8]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m


Processing PasswordsController#new (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
Rendering template within layouts/e-mail
Rendering passwords/new
Completed in 7ms (View: 2, DB: 2) | 200 OK [http://test.host/esqueci-a-senha]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (19.8ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load Including Associations (0.8ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mState Load (0.5ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (5.9ms)
Rendered companies/_company (12.5ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 65ms (View: 47, DB: 8) | 200 OK [http://test.host/people_confirm/edit/9]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#edit (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>"13"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/edit
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendered people/_form (16.8ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 32ms (View: 27, DB: 4) | 200 OK [http://test.host/people_confirm/edit/13]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>"7"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=7) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:00', `user_create_id` = 6, `user_web_adm_id` = 6 WHERE `id` = 7[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
Sent mail to emp@emp.com

Date: Fri, 22 Apr 2011 14:56:00 -0300
From: bsiqueira@suaempreza.com.br
To: emp@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (5.4ms)
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mAddress Load (0.2ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 3 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (7.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 180ms (View: 152, DB: 13) | 200 OK [http://test.host/people_confirm/create/7]
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 18ms (View: 13, DB: 5) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index_companies (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index_companies
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 16ms (View: 10, DB: 3) | 200 OK [http://test.host/people_confirm/index_companies]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.8ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 16)) [0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 20ms (View: 15, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing PeopleConfirmController#index (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.7ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering people_confirm/index
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 6)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 15)) [0m
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 18ms (View: 11, DB: 5) | 200 OK [http://test.host/people_confirm]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=9) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:00', `user_confirm_id` = 4 WHERE `id` = 9[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
Sent mail to empconf222@emp.com

Date: Fri, 22 Apr 2011 14:56:00 -0300
From: bsiqueira@suaempreza.com.br
To: empconf222@emp.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Sua_conta_foi_confirmada=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Parab√©ns, empresa_first_confirm!</h1><br>
As informa√ß√µes de seu usu√°rio foram confirmadas pela nossa equipe.<br>
Voc√™ j√° pode se logar no C√©lula Z e come√ßar a divulgar os seus neg√≥cios na internet.<br><br>
Visite o endere√ßo abaixo para se logar:<br>
<p>
  <a href="http://localhost:3000">http://localhost:3000</a><br>
</p>
<br>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.4ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.3ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.1ms)
Rendered companies/_company_show (6.0ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
Completed in 52ms (View: 26, DB: 13) | 200 OK [http://test.host/people_confirm/create/9]
  [4;35;1mSQL (5.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#create (for 0.0.0.0 at 2011-04-22 14:56:00) [GET]
  Parameters: {"id"=>"9"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (4.8ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (5.9ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 36ms (View: 25, DB: 15) | 200 OK [http://test.host/people_confirm/create/9]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleConfirmController#destroy (for 0.0.0.0 at 2011-04-22 14:56:00) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.6ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.4ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.3ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people_confirm
Completed in 136ms (DB: 4) | 302 Found [http://test.host/people_confirm/destroy/13]
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m


Processing PeopleConfirmController#show (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  Parameters: {"id"=>"9"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
Rendering template within layouts/new_admin
Rendering people_confirm/show
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Rendered people/_person_show (5.8ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 7) LIMIT 1[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 7) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 7)) [0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 4 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (6.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
Completed in 36ms (View: 26, DB: 10) | 200 OK [http://test.host/people_confirm/show/9]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.1ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 1) [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", enabled: true>, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString", "state"=>#<State id: 1, acronym: "AC", name: "Acre", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53">}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:01', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:56:01', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, 1, 'MyString', 'MyString', NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/52
Completed in 14ms (DB: 3) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate%5D=1&person%5Bsubsidiary_id%5D=1]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m


Processing PeopleController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:01', 6, '356.726.002-20', '2008-09-09', '2011-04-22 17:56:01', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 6)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/53
Completed in 11ms (DB: 4) | 302 Found [http://test.host/people?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m


Processing PeopleController#destroy (for 0.0.0.0 at 2011-04-22 14:56:01) [DELETE]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 13) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.person_id = 13) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;35;1mCompany Update (0.4ms)[0m   [0mUPDATE `companies` SET person_id = NULL WHERE ((person_id = 13)) [0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 13 AND `phones`.owner_type = 'Person') [0m
  [4;35;1mPerson Destroy (0.3ms)[0m   [0mDELETE FROM `people` WHERE `id` = 13[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people
Completed in 8ms (DB: 5) | 302 Found [http://test.host/people/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#edit (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/edit
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (16.2ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Person') [0m
Rendered person_phone/_phones (5.2ms)
Rendered people/_sidebar (0.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 44ms (View: 38, DB: 7) | 200 OK [http://test.host/people/1/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#index (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` as people left join user_people as up on people.id = up.person_id left join users as u on up.user_id = u.id and u.type <>'UserCompany' WHERE (user_confirm_id is not null ) ORDER BY people.name LIMIT 0, 30[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` IN (1,2,4)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
Rendering template within layouts/new_admin
Rendering people/index
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 5)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 8)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 14)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 17)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 11)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 18)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 13)) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 2)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 12)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 216ms (View: 201, DB: 12) | 200 OK [http://test.host/people]
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing PeopleController#new (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering people/new
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.6ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (type in ('UserDirector','UserSupport','UserGeneralManager','UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 10)) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 11)) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 13)) [0m
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 36ms (View: 30, DB: 6) | 200 OK [http://test.host/people/new]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#show (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  Parameters: {"id"=>"1"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering people/show
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
Rendered people/_person_show (6.6ms)
Rendered people/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 19ms (View: 14, DB: 4) | 200 OK [http://test.host/people/1]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m


Processing PeopleController#update (for 0.0.0.0 at 2011-04-22 14:56:01) [PUT]
  Parameters: {"person"=>{}, "id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 1)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/people/1
Completed in 8ms (DB: 3) | 302 Found [http://test.host/people/1?]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>""}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Completed in 11ms (View: 4, DB: 2) | 200 OK [http://test.host/person_phone/create/8?phone%5Bnumber%5D=]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m


Processing PersonPhoneController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [PUT]
  Parameters: {"id"=>"8", "phone"=>{"number"=>12345678, "ddd"=>17}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Create (0.4ms)[0m   [0mINSERT INTO `phones` (`number`, `created_at`, `updated_at`, `ddd`, `owner_id`, `company_id`, `person_id`, `owner_type`) VALUES(12345678, '2011-04-22 17:56:01', '2011-04-22 17:56:01', 17, NULL, NULL, 8, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendered person_phone/_phone (2.5ms)
Completed in 8ms (View: 5, DB: 3) | 200 OK [http://test.host/person_phone/create/8?phone%5Bddd%5D=17&phone%5Bnumber%5D=12345678]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPhone Load (0.2ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 980190962) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `phones` [0m
  [4;35;1mPhone Load (0.2ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m


Processing PersonPhoneController#destroy (for 0.0.0.0 at 2011-04-22 14:56:01) [PUT]
  Parameters: {"id"=>"298486374"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) LIMIT 1[0m
  [4;35;1mPhone Load (0.2ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.`id` = 298486374) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPhone Destroy (0.3ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 298486374[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Completed in 4ms (View: 1, DB: 4) | 200 OK [http://test.host/person_phone/destroy/298486374]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `phones` [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mPicture Load (0.1ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;36;1mPicture Update (0.3ms)[0m   [0;1mUPDATE `pictures` SET `updated_at` = '2011-04-22 17:56:01', `title` = 'ola' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [PUT]
  Parameters: {"email"=>"quentin@example.com"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (email='quentin@example.com' and activated_at is null) LIMIT 1[0m
Redirected to http://test.host/login
Completed in 6ms (DB: 7) | 302 Found [http://test.host/resend_activation_mail/create?email=quentin%40example.com]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing ResendActivationMailController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [PUT]
  Parameters: {"email"=>"gerente_geral@example.com"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (email='gerente_geral@example.com' and activated_at is null) LIMIT 1[0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:56:01 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 5ms (DB: 1) | 302 Found [http://test.host/resend_activation_mail/create?email=gerente_geral%40example.com]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ResendActivationMailController#new (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
Rendering template within layouts/e-mail
Rendering resend_activation_mail/new
Completed in 4ms (View: 3, DB: 0) | 200 OK [http://test.host/resend_activation_mail/new]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSegment Load (0.2ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 9ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:01', `remember_token_expires_at` = '2011-05-06 17:56:01', `remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 2) | 302 Found [http://test.host/logout]
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = 'invalid_auth_token') LIMIT 1[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:01', `remember_token_expires_at` = '2011-05-06 17:56:01', `remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:01', `remember_token_expires_at` = '2011-04-22 17:51:01' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:login_required] rendered_or_redirected.
Completed in 2ms (DB: 3) | 302 Found [http://test.host/logout]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4') LIMIT 1[0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"login"=>"quentin", "password"=>"bad password"}
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
Redirected to http://test.host/
Completed in 2ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin&password=bad+password]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"login"=>"empresa", "password"=>"test"}
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'empresa' or email = 'empresa') LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 5)) [0m
Redirected to http://test.host/
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa&password=test]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"login"=>"quentin", "password"=>"test"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 5ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"login"=>"empresa_valid", "password"=>"test"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'empresa_valid' or email = 'empresa_valid') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
Redirected to http://test.host/empresa-inicio
Completed in 3ms (DB: 1) | 302 Found [http://test.host/sessao?login=empresa_valid&password=test]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:01', `remember_token_expires_at` = '2011-05-06 17:56:01', `remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m


Processing SessionsController#new (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4') LIMIT 1[0m
Redirected to http://test.host/
Filter chain halted as [:not_logged_in_required] rendered_or_redirected.
Completed in 2ms (DB: 2) | 302 Found [http://test.host/sessao/new]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"login"=>"quentin@example.com", "password"=>"test"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin@example.com' or email = 'quentin@example.com') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mUserCompany Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 2) | 302 Found [http://test.host/sessao?login=quentin%40example.com&password=test]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing SessionsController#destroy (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/login
Completed in 4ms (DB: 1) | 302 Found [http://test.host/logout]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"remember_me"=>"0", "login"=>"quentin", "password"=>"test"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 4ms (DB: 1) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=0]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing SessionsController#create (for 0.0.0.0 at 2011-04-22 14:56:01) [POST]
  Parameters: {"remember_me"=>"1", "login"=>"quentin", "password"=>"test"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:01', `remember_token_expires_at` = '2011-05-06 17:56:01', `remember_token` = '41bb0766b6c31abb9a59a060a2fa0550a61d41c4' WHERE `id` = 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:01', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
Redirected to http://test.host/users/show
Completed in 18ms (DB: 4) | 302 Found [http://test.host/sessao?login=quentin&password=test&remember_me=1]
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mShipping Load (0.3ms)[0m   [0mSELECT * FROM `shippings` WHERE (`shippings`.`id` = 1) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT `titles`.* FROM `titles` INNER JOIN `shipping_titles` ON `titles`.id = `shipping_titles`.title_id WHERE ((`shipping_titles`.shipping_id = 1)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.2ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:56:01) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", enabled: true>, "state"=>#<State id: 21, acronym: "RS", name: "Rio Grande do Sul", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53">}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 21) [0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 21) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Create (0.3ms)[0m   [0mINSERT INTO `subsidiary_states` (`created_at`, `updated_at`, `subsidiary_id`, `state_id`) VALUES('2011-04-22 17:56:01', '2011-04-22 17:56:01', 1, 21)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;36;1mState Load (0.5ms)[0m   [0;1mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mState Load (0.2ms)[0m   [0mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 36ms (View: 20, DB: 8) | 200 OK [http://test.host/subsidiaries/change_range/1?state=21]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m


Processing SubsidiariesController#create (for 0.0.0.0 at 2011-04-22 14:56:02) [POST]
  Parameters: {"subsidiary"=>{"title"=>"teste"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'teste') LIMIT 1[0m
  [4;35;1mSubsidiary Create (0.2ms)[0m   [0mINSERT INTO `subsidiaries` (`created_at`, `title`, `updated_at`, `enabled`) VALUES('2011-04-22 17:56:02', 'teste', '2011-04-22 17:56:02', 1)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/8
Completed in 5ms (DB: 2) | 302 Found [http://test.host/filiais?subsidiary%5Btitle%5D=teste]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m


Processing SubsidiariesController#destroy (for 0.0.0.0 at 2011-04-22 14:56:02) [DELETE]
  Parameters: {"id"=>"3"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `people` WHERE (`people`.subsidiary_id = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiaryState Load (0.1ms)[0m   [0mSELECT * FROM `subsidiary_states` WHERE (`subsidiary_states`.subsidiary_id = 3) [0m
  [4;36;1mSubsidiary Destroy (0.1ms)[0m   [0;1mDELETE FROM `subsidiaries` WHERE `id` = 3[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais
Completed in 5ms (DB: 3) | 302 Found [http://test.host/filiais/3]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `subsidiaries` [0m
  [4;35;1mSQL (3.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#edit (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit
Rendered subsidiaries/_form (3.3ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 14ms (View: 12, DB: 5) | 200 OK [http://test.host/filiais/1/editar]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#index (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/index
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 150ms (View: 148, DB: 2) | 200 OK [http://test.host/filiais]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing SubsidiariesController#new (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/new
Rendered subsidiaries/_form (2.0ms)
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 9, DB: 2) | 200 OK [http://test.host/filiais/nova]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m


Processing SubsidiariesController#change_range (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  Parameters: {"id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", enabled: true>, "state"=>#<State id: 19, acronym: "RJ", name: "Rio de Janeiro", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53">}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mState Load (0.2ms)[0m   [0mSELECT * FROM `states` WHERE (`states`.`id` = 19) [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT `states`.id FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE (`states`.`id` = 19) AND ((`subsidiary_states`.subsidiary_id = 1)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mSubsidiaryState Delete all (0.2ms)[0m   [0;1mDELETE FROM `subsidiary_states` WHERE (`subsidiary_states`.`subsidiary_id` = 1 AND `subsidiary_states`.`state_id` = 19) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY 'Filial 1' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering subsidiaries/edit_range
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT `states`.* FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;36;1mState Load (0.2ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 24ms (View: 15, DB: 4) | 200 OK [http://test.host/subsidiaries/change_range/1?state=19]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `states` INNER JOIN `subsidiary_states` ON `states`.id = `subsidiary_states`.state_id WHERE ((`subsidiary_states`.subsidiary_id = 1)) [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#show (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  Parameters: {"id"=>"1"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
Rendering template within layouts/new_admin
Rendering subsidiaries/show
Rendered subsidiaries/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 10, DB: 3) | 200 OK [http://test.host/filiais/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m


Processing SubsidiariesController#update (for 0.0.0.0 at 2011-04-22 14:56:02) [PUT]
  Parameters: {"subsidiary"=>{"title"=>"123"}, "id"=>"1"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT `subsidiaries`.id FROM `subsidiaries` WHERE (`subsidiaries`.`title` = BINARY '123' AND `subsidiaries`.id <> 1) LIMIT 1[0m
  [4;36;1mSubsidiary Update (0.3ms)[0m   [0;1mUPDATE `subsidiaries` SET `updated_at` = '2011-04-22 17:56:02', `title` = '123' WHERE `id` = 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/filiais/1
Completed in 7ms (DB: 3) | 302 Found [http://test.host/filiais/1?subsidiary%5Btitle%5D=123]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m


Processing TemplateTextsController#create (for 0.0.0.0 at 2011-04-22 14:56:02) [POST]
  Parameters: {"template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Create (0.2ms)[0m   [0;1mINSERT INTO `template_texts` (`created_at`, `title`, `updated_at`, `content`) VALUES('2011-04-22 17:56:02', 'dadsas', '2011-04-22 17:56:02', 'fsdcsd')[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190966
Completed in 10ms (DB: 3) | 302 Found [http://test.host/template_texts?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#destroy (for 0.0.0.0 at 2011-04-22 14:56:02) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.3ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTemplateText Destroy (0.1ms)[0m   [0mDELETE FROM `template_texts` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts
Completed in 3ms (DB: 4) | 302 Found [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `template_texts` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#edit (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.2ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/edit
Rendered template_texts/_form (3.3ms)
Rendered template_texts/_sidebar (0.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 15ms (View: 13, DB: 3) | 200 OK [http://test.host/template_texts/980190962/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#index (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` [0m
Rendering template within layouts/new_admin
Rendering template_texts/index
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 16ms (View: 13, DB: 2) | 200 OK [http://test.host/template_texts]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing TemplateTextsController#new (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering template_texts/new
Rendered template_texts/_form (2.0ms)
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 12ms (View: 10, DB: 2) | 200 OK [http://test.host/template_texts/new]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#show (for 0.0.0.0 at 2011-04-22 14:56:02) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mTemplateText Load (0.4ms)[0m   [0mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
Rendering template within layouts/new_admin
Rendering template_texts/show
Rendered template_texts/_sidebar (0.1ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 14ms (View: 11, DB: 3) | 200 OK [http://test.host/template_texts/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m


Processing TemplateTextsController#update (for 0.0.0.0 at 2011-04-22 14:56:02) [PUT]
  Parameters: {"id"=>"980190962", "template_text"=>{"title"=>"dadsas", "content"=>"fsdcsd"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT * FROM `template_texts` WHERE (`template_texts`.`id` = 980190962) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mTemplateText Update (0.4ms)[0m   [0;1mUPDATE `template_texts` SET `content` = 'fsdcsd', `updated_at` = '2011-04-22 17:56:02', `title` = 'dadsas' WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/template_texts/980190962
Completed in 5ms (DB: 2) | 302 Found [http://test.host/template_texts/980190962?template_text%5Bcontent%5D=fsdcsd&template_text%5Btitle%5D=dadsas]
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 6) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:02', `status` = 'Selecionado' WHERE `id` = 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mTitle Load (0.6ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`status` = 'Digitado') [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 11) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 7)) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 9)) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 6) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1 and people.user_web_adm_id = 6) ORDER BY razao_social LIMIT 0, 30[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_confirm_id is null and people.subsidiary_id= 1) ORDER BY razao_social LIMIT 0, 30[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 3) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 4) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.8ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type <> ('UserCompany') where people.user_confirm_id is null and u.id <> 3 order by name LIMIT 0, 30[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mPerson Load (0.9ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is null and people.subsidiary_id= 1 and u.id<>2 order by name LIMIT 0, 30[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 15) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 16) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 9) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 AND people.user_web_adm_id = 6) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUserCompany Load Including Associations (0.8ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserCompany Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;35;1mUserCompany Load Including Associations (0.7ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (users.id<>3) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5, 7, 8, 12) ORDER BY companies.razao_social[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUserCompany Load IDs For Limited Eager Loading (0.6ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) LEFT OUTER JOIN `companies` ON companies.user_id = users.id WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) ORDER BY companies.razao_social LIMIT 0, 30[0m
  [4;36;1mUserCompany Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `companies`.`id` AS t1_r0, `companies`.`user_id` AS t1_r1, `companies`.`cnpj` AS t1_r2, `companies`.`razao_social` AS t1_r3, `companies`.`created_at` AS t1_r4, `companies`.`updated_at` AS t1_r5, `companies`.`person_id` AS t1_r6, `companies`.`payment_type` AS t1_r7, `companies`.`segment_id` AS t1_r8, `companies`.`state_id` AS t1_r9, `companies`.`type` AS t1_r10, `companies`.`informal` AS t1_r11, `companies`.`drawee_code` AS t1_r12, `companies`.`register_number` AS t1_r13, `companies`.`profile_logo_file_name` AS t1_r14, `companies`.`profile_logo_content_type` AS t1_r15, `companies`.`profile_logo_file_size` AS t1_r16, `companies`.`profile_logo_updated_at` AS t1_r17, `people`.`id` AS t2_r0, `people`.`user_id` AS t2_r1, `people`.`name` AS t2_r2, `people`.`cpf` AS t2_r3, `people`.`rg` AS t2_r4, `people`.`rg_exp` AS t2_r5, `people`.`rg_exp_date` AS t2_r6, `people`.`date_birth` AS t2_r7, `people`.`created_at` AS t2_r8, `people`.`updated_at` AS t2_r9, `people`.`subsidiary_id` AS t2_r10, `people`.`user_create_id` AS t2_r11, `people`.`user_confirm_id` AS t2_r12, `people`.`state_id` AS t2_r13, `people`.`user_web_adm_id` AS t2_r14, `people`.`bank_id` AS t2_r15, `people`.`agency` AS t2_r16, `people`.`account_number` AS t2_r17 FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 ) AND ( (`users`.`type` = 'UserCompany' ) ) AND `users`.id IN (5) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
  [4;36;1mUser Load Including Associations (0.7ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee')) AND `users`.id IN (6, 1) ORDER BY login[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 5) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:02', `domain` = 'empresa.com' WHERE `id` = 8[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (45.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` WHERE (`people`.user_web_adm_id = 6 AND (not exists (select up.* from user_people as up where people.id = up.person_id))) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('b5fb3d4f584d612d1ceb04b07182fff89b584e37', '2011-04-22 17:56:02', NULL, NULL, NULL, '883cc05150e2b7c80da019ad9b48206b9a848d56', NULL, '2011-04-22 17:56:02', NULL, '1769e92c0b86837d13a410487f7cd4c780e57b76', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.4ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 62, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:02', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;62\n', '2011-04-22 17:56:02', 0, '2011-04-22 17:56:02', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;35;1mUser Create (13.2ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('b5fb3d4f584d612d1ceb04b07182fff89b584e37', '2011-04-22 17:56:02', NULL, NULL, NULL, '883cc05150e2b7c80da019ad9b48206b9a848d56', NULL, '2011-04-22 17:56:02', NULL, '4e13d558cc97136f5d6f33eed03ce8977328e460', NULL, 1, NULL, NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 63, NULL)[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:02', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;User;63\n', '2011-04-22 17:56:02', 0, '2011-04-22 17:56:02', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 63) [0m
  [4;36;1mSQL (33.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;36;1mUserPerson Destroy (0.3ms)[0m   [0;1mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;35;1mFeedLike Load (0.4ms)[0m   [0mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;35;1mFeed Load (0.2ms)[0m   [0mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;36;1mFeed Destroy (0.1ms)[0m   [0;1mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;35;1mNews Load (0.3ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.1ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;36;1mContract Load (0.2ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:02', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;35;1mShippingTitle Load (0.5ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;35;1mTitle Update (0.4ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:03', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;36;1mTitle Update (0.3ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:03', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;36;1mTitle Destroy (0.4ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;36;1mTitle Destroy (0.1ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:55:49' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;36;1mComponentText Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 5[0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.4ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 6[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 7[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;36;1mPicture Load (0.3ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.3ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;35;1mComponentGallery Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 8[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;35;1mComponentForm Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 9[0m
  [4;36;1mComponentGallery Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;35;1mComponent Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;35;1mTab Load (0.5ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mTab Destroy (0.4ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;36;1mTab Destroy (0.4ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;35;1mColor Load (0.4ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;36;1mBanner Load (0.4ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;35;1mBackgroundTop Load (0.4ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;36;1mBackground Load (0.4ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.4ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mPhone Destroy (0.4ms)[0m   [0;1mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;35;1mAddress Load (0.4ms)[0m   [0mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;36;1mAddress Destroy (0.4ms)[0m   [0;1mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;35;1mCompanyService Load (0.3ms)[0m   [0mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.2ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;36;1mMessageCopy Destroy (0.1ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;35;1mMessage Destroy (0.1ms)[0m   [0mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;36;1mFolder Destroy (0.2ms)[0m   [0;1mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.5ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `login` = 'quentin2' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin2' or email = 'quentin2') LIMIT 1[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.5ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `remember_token_expires_at` = '2011-05-06 17:56:03', `remember_token` = '38c0d4dad0bb0886c49942c1010614d3c165dab1' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `remember_token_expires_at` = '2011-04-29 17:56:03', `remember_token` = '2edb6d1a3e101f4cd60d77ec30d247d6bc569651' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `remember_token_expires_at` = '2011-04-29 17:56:03', `remember_token` = '2edb6d1a3e101f4cd60d77ec30d247d6bc569651' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;35;1mUserWebAdministrator Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `crypted_password` = '4b6dd603c64f03bc2f676658e287094878df9603' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (login = 'quentin' or email = 'quentin') LIMIT 1[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `remember_token_expires_at` = '2011-05-06 17:56:03', `remember_token` = '38c0d4dad0bb0886c49942c1010614d3c165dab1' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserWebAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `remember_token_expires_at` = '2011-05-06 17:56:03', `remember_token` = '38c0d4dad0bb0886c49942c1010614d3c165dab1' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUserWebAdministrator Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `remember_token_expires_at` = NULL, `remember_token` = NULL WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno com espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on User initialized.
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno_sem_espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno-sem-espaco') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'bruno12345434543comnumeros323') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'comcaract√©resespeciais') LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 7) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 6)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mUser Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mUser Load Including Associations (0.6ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load Including Associations (0.8ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserSegmentManager','UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m


Processing UsersController#create_page_2 (for 0.0.0.0 at 2011-04-22 14:56:03) [POST]
  Parameters: {"company"=>{"person_id"=>8}, "person"=>{"user_web_adm_id"=>#<UserWebAdministrator id: 6, login: "admin_web", email: "mg@mg2.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:55:52", updated_at: "2011-04-22 17:55:53", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:55:52", password_reset_code: nil, enabled: true, type: "UserWebAdministrator", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}, "id"=>"8"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 8)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=10) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 10)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:03', `user_web_adm_id` = 6 WHERE `id` = 10[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ20002' AND `companies`.id <> 5) LIMIT 1[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompanyZ Update (0.3ms)[0m   [0;1mUPDATE `companies` SET `updated_at` = '2011-04-22 17:56:03', `person_id` = 8 WHERE `id` = 5[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 28ms (DB: 226) | 302 Found [http://test.host/users/create_page_2/8?company%5Bperson_id%5D=8&person%5Buser_web_adm_id%5D=6]
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 6) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 8) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:03) [POST]
  Parameters: {"person"=>{"name"=>"gerente_geral", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:55:52 UTC 2011, "updated_at"=>Fri Apr 22 17:55:52 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"898.361.554-06", "id"=>4, "user_id"=>nil, "subsidiary_id"=>"1", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '898.361.554-06') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9a6b921986a58f6064ffc994a5ee6a2f070e45fb', '2011-04-22 17:56:03', NULL, NULL, NULL, '4a2ed70a120334ee34d67bf2fd06fd7491e3fe98', NULL, '2011-04-22 17:56:03', NULL, 'b0a930d354493021a5bb67f93c82ba61174c016d', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.1ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 64, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:03', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;64\n', '2011-04-22 17:56:03', 0, '2011-04-22 17:56:03', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 64) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:03', '2011-04-22 17:56:03', 64, 4)[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 64) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 64 AND `user_people`.id <> 956136660) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 64)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 64) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 64) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=4) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 4)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:03', `user_id` = 64 WHERE `id` = 4[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'b0a930d354493021a5bb67f93c82ba61174c016d') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:03', `activated_at` = '2011-04-22 17:56:03' WHERE `id` = 64[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:03', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;64\n', '2011-04-22 17:56:03', 0, '2011-04-22 17:56:03', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (5.0ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.4ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 91ms (View: 38, DB: 16) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=898.361.554-06&person%5Bcreated_at%5D=Fri+Apr+22+17%3A55%3A52+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=4&person%5Bname%5D=gerente_geral&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=1&person%5Bupdated_at%5D=Fri+Apr+22+17%3A55%3A52+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 10) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:03) [POST]
  Parameters: {"person"=>{"name"=>"empresa_valid", "user_create_id"=>"3", "created_at"=>Fri Apr 22 17:55:52 UTC 2011, "updated_at"=>Fri Apr 22 17:55:52 UTC 2011, "date_birth"=>Ter, 09 Set 2008, "cpf"=>"573.683.830-39", "id"=>10, "user_id"=>nil, "subsidiary_id"=>"2", "rg_exp_date"=>Ter, 09 Set 2008, "user_confirm_id"=>"3", "agency"=>nil, "account_number"=>nil, "bank_id"=>nil, "state_id"=>nil, "user_web_adm_id"=>nil, "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 2) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '573.683.830-39') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 2)) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 2) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (18.4ms)
Rendered people/_person (19.3ms)
  [4;35;1mCompany Load (0.9ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.9ms)
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
Completed in 48ms (View: 35, DB: 7) | 200 OK [http://test.host/usuarios?person%5Baccount_number%5D=&person%5Bagency%5D=&person%5Bbank_id%5D=&person%5Bcpf%5D=573.683.830-39&person%5Bcreated_at%5D=Fri+Apr+22+17%3A55%3A52+UTC+2011&person%5Bdate_birth%5D=2008-09-09&person%5Bid%5D=10&person%5Bname%5D=empresa_valid&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bstate_id%5D=&person%5Bsubsidiary_id%5D=2&person%5Bupdated_at%5D=Fri+Apr+22+17%3A55%3A52+UTC+2011&person%5Buser_confirm_id%5D=3&person%5Buser_create_id%5D=3&person%5Buser_id%5D=&person%5Buser_web_adm_id%5D=&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`login` = 'quire') LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:56:03) [GET]
  Parameters: {"id"=>#<UserCompany id: 8, login: "empresa_valid", email: "empconfxx@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:55:52", updated_at: "2011-04-22 17:55:53", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:55:52", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:03', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- empresa_valid\n- administrator\n', '2011-04-22 17:56:03', 0, '2011-04-22 17:56:03', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 148646006[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 8) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mVote Update (0.2ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 5) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.3ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 5) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 5) [0m
  [4;36;1mFeed Load (0.4ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 5) [0m
  [4;35;1mFeed Destroy (0.2ms)[0m   [0mDELETE FROM `feeds` WHERE `id` = 1[0m
  [4;36;1mNews Load (0.3ms)[0m   [0;1mSELECT * FROM `news` WHERE (`news`.company_id = 5) [0m
  [4;35;1mContract Load (0.6ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 5 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.1ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 5[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.5ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5) [0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 1) [0m
  [4;36;1mTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 1[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 2) [0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 2[0m
  [4;35;1mShippingTitle Load (0.2ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 3) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 3) [0m
  [4;35;1mTitle Update (0.4ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:03', `status` = 'Digitado' WHERE `id` = 3[0m
  [4;36;1mShippingTitle Destroy (0.3ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 561336240[0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 3[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 4) [0m
  [4;35;1mTitle Load (0.2ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.`id` = 4) [0m
  [4;36;1mTitle Update (0.2ms)[0m   [0;1mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:03', `status` = 'Digitado' WHERE `id` = 4[0m
  [4;35;1mShippingTitle Destroy (0.2ms)[0m   [0mDELETE FROM `shipping_titles` WHERE `id` = 166165813[0m
  [4;36;1mTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `titles` WHERE `id` = 4[0m
  [4;35;1mShippingTitle Load (0.3ms)[0m   [0mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 5) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.`id` = 5) [0m
  [4;35;1mTitle Update (0.3ms)[0m   [0mUPDATE `titles` SET `updated_at` = '2011-04-22 17:56:03', `status` = 'Digitado' WHERE `id` = 5[0m
  [4;36;1mShippingTitle Destroy (0.2ms)[0m   [0;1mDELETE FROM `shipping_titles` WHERE `id` = 964567530[0m
  [4;35;1mTitle Destroy (0.3ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 5[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 6) [0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 6[0m
  [4;36;1mShippingTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 7) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 7[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 8) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 8[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 9) [0m
  [4;35;1mTitle Destroy (0.1ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 9[0m
  [4;36;1mShippingTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `shipping_titles` WHERE (`shipping_titles`.title_id = 10) [0m
  [4;35;1mTitle Destroy (0.2ms)[0m   [0mDELETE FROM `titles` WHERE `id` = 10[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Digitado' )) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;36;1mTitle Load (0.2ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 5 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:55:49' and our_number is not null)) [0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1) [0m
  [4;35;1mTabComponent Load (0.2ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 5) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.3ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 148646006[0m
  [4;35;1mComponentText Destroy (0.3ms)[0m   [0mDELETE FROM `components` WHERE `id` = 5[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 6) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 6[0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 7) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 7[0m
  [4;36;1mTabComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 8) LIMIT 1[0m
  [4;35;1mPicture Load (0.3ms)[0m   [0mSELECT * FROM `pictures` WHERE (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;36;1mPicture Destroy (0.3ms)[0m   [0;1mDELETE FROM `pictures` WHERE `id` = 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment photo on Picture initialized.
[paperclip] Deleting files for photo
  [4;35;1mPicture Destroy (0.2ms)[0m   [0mDELETE FROM `pictures` WHERE `id` = 2[0m
  [4;36;1mComponentGallery Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 8[0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 9) LIMIT 1[0m
  [4;36;1mComponentForm Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 9[0m
  [4;35;1mComponentGallery Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 1 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.5ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 1) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (1,2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 1[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 2[0m
  [4;36;1mColor Load (0.4ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 1) LIMIT 1[0m
  [4;35;1mBanner Load (0.4ms)[0m   [0mSELECT * FROM `banners` WHERE (`banners`.layout_id = 1) [0m
  [4;36;1mBackgroundTop Load (0.4ms)[0m   [0;1mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 1) [0m
  [4;35;1mBackground Load (0.4ms)[0m   [0mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 1) [0m
  [4;36;1mPhone Load (0.4ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 1 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;35;1mLayout Destroy (0.4ms)[0m   [0mDELETE FROM `layouts` WHERE `id` = 1[0m
  [4;36;1mPhone Load (0.3ms)[0m   [0;1mSELECT * FROM `phones` WHERE (`phones`.owner_id = 5 AND `phones`.owner_type = 'Company') [0m
  [4;35;1mPhone Destroy (0.3ms)[0m   [0mDELETE FROM `phones` WHERE `id` = 980190962[0m
  [4;36;1mAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 5 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.2ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 5[0m
  [4;36;1mCompanyService Load (0.3ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 5) [0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 495905389[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 5) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Load (0.3ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 5 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;36;1mCompanyZ Destroy (0.3ms)[0m   [0;1mDELETE FROM `companies` WHERE `id` = 5[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 8 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = 1) [0m
  [4;35;1mMessageCopy Destroy (0.2ms)[0m   [0mDELETE FROM `message_copies` WHERE `id` = 1[0m
  [4;36;1mMessage Destroy (0.2ms)[0m   [0;1mDELETE FROM `messages` WHERE `id` = 1[0m
  [4;35;1mMessageCopy Load (0.2ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 8 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mMessageCopy Destroy (0.1ms)[0m   [0;1mDELETE FROM `message_copies` WHERE `id` = 3[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 8) [0m
  [4;36;1mFolder Load (0.4ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.parent_id = 980190962) [0m
  [4;35;1mFolder Destroy (0.3ms)[0m   [0mDELETE FROM `folders` WHERE `id` = 980190962[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 8) AND (voter_type = 'UserCompany')) [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 230ms (DB: 32) | 302 Found [http://test.host/usuarios/8]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (47.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:55:52", updated_at: "2011-04-22 17:55:53", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:55:52", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Redirected to http://test.host/usuarios
Completed in 3ms (DB: 49) | 302 Found [http://test.host/usuarios/12]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- administrator\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.1ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.1ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.2ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.2ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.3ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 14ms (DB: 5) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"id"=>#<UserCompany id: 12, login: "empres√£ _&valid_2", email: "empconfxx2@emp.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:55:52", updated_at: "2011-04-22 17:55:53", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:55:52", password_reset_code: nil, enabled: true, type: "UserCompany", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- \"empres\\xC3\\xA3 _&valid_2\"\n- administrator\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) [0m
  [4;35;1mUserPerson Destroy (0.3ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 956136629[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 12) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voteable_id = NULL WHERE ((voteable_id = 7) AND (voteable_type = 'CompanyZ')) [0m
  [4;36;1mFeedLike Load (0.3ms)[0m   [0;1mSELECT * FROM `feed_likes` WHERE (`feed_likes`.company_id = 7) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;36;1mBusiness Destroy (0.3ms)[0m   [0;1mDELETE FROM `businesses` WHERE `id` = 298486374[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.2ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mFeed Load (0.2ms)[0m   [0;1mSELECT * FROM `feeds` WHERE (`feeds`.company_id = 7) [0m
  [4;35;1mNews Load (0.2ms)[0m   [0mSELECT * FROM `news` WHERE (`news`.company_id = 7) [0m
  [4;36;1mContract Load (0.4ms)[0m   [0;1mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7) ORDER BY created_at DESC[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.4ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (titles.status<>'Liquidado')) [0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 2 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;35;1mContract Destroy (0.3ms)[0m   [0mDELETE FROM `contracts` WHERE `id` = 2[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3) ORDER BY emission_date desc[0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (status <> 'Digitado' )) ORDER BY emission_date desc[0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (titles.status<>'Liquidado')) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.contract_id = 3 AND (`titles`.`status` = 'Liquidado')) [0m
  [4;36;1mContract Destroy (0.2ms)[0m   [0;1mDELETE FROM `contracts` WHERE `id` = 3[0m
  [4;35;1mContract Load (0.4ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) ORDER BY created_at DESC[0m
  [4;36;1mTitle Load (0.4ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Digitado' )) [0m
  [4;36;1mTitle Load (0.3ms)[0m   [0;1mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND ((status = 'Liquidado' or status <> 'Baixado') and our_number is not null)) [0m
  [4;35;1mTitle Load (0.3ms)[0m   [0mSELECT * FROM `titles` WHERE (`titles`.company_id = 7 AND (status <> 'Liquidado' and due_date < '2011-04-22 14:55:49' and our_number is not null)) [0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) [0m
  [4;36;1mTabComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 1) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.3ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 956136629[0m
  [4;36;1mComponentText Destroy (0.3ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 1[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 2) LIMIT 1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;36;1mComponentPicture Destroy (0.2ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 2[0m
  [4;35;1mTabComponent Load (0.3ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 3) LIMIT 1[0m
  [4;36;1mTabComponent Destroy (0.2ms)[0m   [0;1mDELETE FROM `tab_components` WHERE `id` = 997002036[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
[paperclip] Deleting files for picture
  [4;35;1mComponentPicture Destroy (0.2ms)[0m   [0mDELETE FROM `components` WHERE `id` = 3[0m
  [4;36;1mTabComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `tab_components` WHERE (`tab_components`.component_id = 4) LIMIT 1[0m
  [4;35;1mTabComponent Destroy (0.5ms)[0m   [0mDELETE FROM `tab_components` WHERE `id` = 208288675[0m
  [4;36;1mComponentForm Destroy (0.3ms)[0m   [0;1mDELETE FROM `components` WHERE `id` = 4[0m
  [4;35;1mComponentGallery Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2) AND ( (`components`.`type` = 'ComponentGallery' ) ) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (exists (select * from tab_components as tab_components where tab_components.component_id = components.id) and type in ('ComponentGallery','ComponentText'))) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
  [4;36;1mTab Load (0.4ms)[0m   [0;1mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mTab Destroy (0.2ms)[0m   [0;1mDELETE FROM `tabs` WHERE `id` = 3[0m
  [4;35;1mTab Destroy (0.2ms)[0m   [0mDELETE FROM `tabs` WHERE `id` = 4[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 2) LIMIT 1[0m
  [4;35;1mColor Destroy (0.2ms)[0m   [0mDELETE FROM `colors` WHERE `id` = 980190962[0m
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
  [4;35;1mBackgroundTop Load (0.2ms)[0m   [0mSELECT * FROM `background_tops` WHERE (`background_tops`.layout_id = 2) [0m
  [4;36;1mBackground Load (0.3ms)[0m   [0;1mSELECT * FROM `backgrounds` WHERE (`backgrounds`.layout_id = 2) [0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Deleting files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Deleting files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Deleting files for card2
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
[paperclip] Deleting attachments.
[paperclip] Deleting files for my_background_top
[paperclip] Deleting files for card1
[paperclip] Deleting files for card2
[paperclip] Deleting files for card3
  [4;36;1mLayout Destroy (0.2ms)[0m   [0;1mDELETE FROM `layouts` WHERE `id` = 2[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 7 AND `phones`.owner_type = 'Company') [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 7 AND `addresses`.owner_type = 'Company') LIMIT 1[0m
  [4;35;1mAddress Destroy (0.4ms)[0m   [0mDELETE FROM `addresses` WHERE `id` = 7[0m
  [4;36;1mCompanyService Load (0.4ms)[0m   [0;1mSELECT * FROM `company_services` WHERE (`company_services`.company_id = 7) [0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 980190962[0m
  [4;36;1mCompanyService Destroy (0.3ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 298486374[0m
  [4;35;1mCompanyService Destroy (0.3ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 113629430[0m
  [4;36;1mCompanyService Destroy (0.4ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 281110143[0m
  [4;35;1mCompanyService Destroy (0.4ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 1018350795[0m
  [4;36;1mCompanyService Destroy (0.2ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 51848956[0m
  [4;35;1mCompanyService Destroy (0.4ms)[0m   [0mDELETE FROM `company_services` WHERE `id` = 374648174[0m
  [4;36;1mCompanyService Destroy (0.1ms)[0m   [0;1mDELETE FROM `company_services` WHERE `id` = 638205575[0m
  [4;35;1mCompanyRelationship Load (0.2ms)[0m   [0mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7) ORDER BY updated_at desc[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_origin_id = 7) ORDER BY updated_at desc[0m
  [4;35;1mCompanyRelationship Destroy (0.2ms)[0m   [0mDELETE FROM `company_relationships` WHERE `id` = 138862559[0m
  [4;36;1mCompanyRelationship Load (0.3ms)[0m   [0;1mSELECT * FROM `company_relationships` WHERE (`company_relationships`.company_destiny_id = 7 AND (confirmed=0)) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
[paperclip] Deleting files for profile_logo
  [4;35;1mCompanyZ Destroy (0.3ms)[0m   [0mDELETE FROM `companies` WHERE `id` = 7[0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.sender_id = 12 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 12 AND (deleted = 0 or deleted is null)) [0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = 12) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Deleting files for avatar
  [4;35;1mVote Update (0.3ms)[0m   [0mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 12) AND (voter_type = 'UserCompany')) [0m
  [4;36;1mUserCompany Destroy (0.3ms)[0m   [0;1mDELETE FROM `users` WHERE `id` = 12[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 209ms (DB: 27) | 302 Found [http://test.host/usuarios/12]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m


Processing UsersController#destroy (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"id"=>"13"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_destroy\nargs: \n- gerente_geral_2\n- gerente_segmento\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 13) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) [0m
  [4;35;1mUserPerson Destroy (0.4ms)[0m   [0mDELETE FROM `user_people` WHERE `id` = 698362566[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.user_id = 13) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 13) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 13) LIMIT 1[0m
  [4;35;1mMessage Load (0.3ms)[0m   [0mSELECT * FROM `messages` WHERE (`messages`.sender_id = 13 AND (deleted_sent_box = 0 or deleted_sent_box is null)) [0m
  [4;36;1mMessageCopy Load (0.3ms)[0m   [0;1mSELECT * FROM `message_copies` WHERE (`message_copies`.recipient_id = 13 AND (deleted = 0 or deleted is null)) [0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = 13) [0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment avatar on UserGeneralManager initialized.
[paperclip] Deleting files for avatar
  [4;36;1mVote Update (0.3ms)[0m   [0;1mUPDATE `votes` SET voter_id = NULL WHERE ((voter_id = 13) AND (voter_type = 'UserGeneralManager')) [0m
  [4;35;1mUserGeneralManager Destroy (0.3ms)[0m   [0mDELETE FROM `users` WHERE `id` = 13[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/usuarios
Completed in 17ms (DB: 8) | 302 Found [http://test.host/usuarios/13]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (16.5ms)
Rendered people/_person (16.9ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.9ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 34ms (View: 30, DB: 5) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (15.4ms)
Rendered people/_person (15.8ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.7ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 32ms (View: 28, DB: 3) | 200 OK [http://test.host/signup]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#new (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"type"=>"UserCompany"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (146.4ms)
Rendered people/_person (146.8ms)
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.3ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (4.7ms)
Rendered companies/_company (12.3ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 178ms (View: 173, DB: 4) | 200 OK [http://test.host/signup?type=UserCompany]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:04) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('5641edad5ae487904efa5a50626a04d45dc54b3e', '2011-04-22 17:56:04', NULL, NULL, NULL, '70745adf67f67700750323fb47559a15ce67b7e5', NULL, '2011-04-22 17:56:04', NULL, 'b38f93d8d75e6e16194f324ccda8286c0f1da26a', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 65, NULL)[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;65\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 65) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 65) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:04', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:56:04', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 65) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.4ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:04', '2011-04-22 17:56:04', 65, 54)[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 65) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 65 AND `user_people`.id <> 956136661) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 65)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 65) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 65) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 54)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=54) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 54)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 54)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 54)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 54)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:04', `user_id` = 65 WHERE `id` = 54[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'b38f93d8d75e6e16194f324ccda8286c0f1da26a') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.4ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:04', `activated_at` = '2011-04-22 17:56:04' WHERE `id` = 65[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;65\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (2.7ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.8ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.6ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.5ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.0ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 86ms (View: 31, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 65) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (2.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:04) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('5641edad5ae487904efa5a50626a04d45dc54b3e', '2011-04-22 17:56:04', NULL, NULL, NULL, '70745adf67f67700750323fb47559a15ce67b7e5', NULL, '2011-04-22 17:56:04', NULL, '314e2b47b499d6aae33918d5cdf00ee055279680', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 66, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;66\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 66) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 66) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:04', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:56:04', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 66) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:04', '2011-04-22 17:56:04', 66, 55)[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=55) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 66) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 66) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (13.4ms)
Rendered people/_person (13.8ms)
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.3ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (10.9ms)
Rendered companies/_company (29.0ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 234ms (View: 52, DB: 13) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (1.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"user"=>{"login"=>""}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY '' AND `users`.id <> 4) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'mg@mg.com' AND `users`.id <> 4) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 4) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
Rendering template within layouts/new_admin
Rendering users/edit
Rendered people/_person_edit (14.6ms)
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (4.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 58ms (View: 43, DB: 7) | 200 OK [http://test.host/users/update?user%5Blogin%5D=]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:56:04) [GET]
  Parameters: {"id"=>#<UserSegmentManager id: 4, login: "gerente_segmento", email: "mg@mg.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-17 17:55:52", updated_at: "2011-04-22 17:55:53", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9b", activated_at: "2011-04-17 17:55:52", password_reset_code: nil, enabled: true, type: "UserSegmentManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
Redirected to http://test.host/usuarios
Completed in 3ms (DB: 2) | 302 Found [http://test.host/users/resend_signup_mail/4]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:04) [POST]
  Parameters: {"company"=>{"parcel"=>12, "segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "value"=>50.0, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('5641edad5ae487904efa5a50626a04d45dc54b3e', '2011-04-22 17:56:04', NULL, NULL, NULL, '70745adf67f67700750323fb47559a15ce67b7e5', NULL, '2011-04-22 17:56:04', NULL, '5e850c616c72c829e15285ca588cd1fdff324f06', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.3ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 67, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.2ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:04', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;67\n', '2011-04-22 17:56:04', 0, '2011-04-22 17:56:04', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ398825') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.3ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:56:05', NULL, '2011-04-22 17:56:05', '61.286.834/0001-08', NULL, NULL, 67, 'CompanyZ', 'SZ398825', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 27) [0m
  [4;35;1mContract Create (0.3ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:56:05', '2011-04-22 17:56:05', '2011-04-22 17:56:05', 50.0, 27, '2012-04-22 17:56:05', 'Aberto')[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 27) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.5ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:56:05', NULL, NULL, '2011-04-22 17:56:05', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 27, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.5ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.5ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 21) LIMIT 1[0m
  [4;36;1mColor Create (0.5ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 21, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:56:05', `name` = 'Empresa', `created_at` = '2011-04-22 17:56:05', `company_id` = 27 WHERE `id` = 21[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:05', 0, '2011-04-22 17:56:05', 21, 'MyString', 'MySring', 1, NULL, 'Layout', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.4ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:56:05', 'Home', '2011-04-22 17:56:05', NULL, 21)[0m
  [4;36;1mColorTemplate Load (0.5ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 21, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.4ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:56:05', `layout_id` = NULL WHERE `id` = 980190995[0m
  [4;35;1mFeedItem Create (0.2ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:56:05', 0, '2011-04-22 17:56:05', 0, 1, 27, 'Company')[0m
  [4;36;1mFeed Create (0.2ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:56:05', '2011-04-22 17:56:05', 27, 37)[0m
  [4;35;1mAddress Create (0.4ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:05', 0, '2011-04-22 17:56:05', 27, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 67) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 67) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 67) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 67) LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 67) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 67) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ398825' AND `companies`.id <> 27) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (14.1ms)
Rendered people/_person (14.5ms)
  [4;36;1mSegment Load (0.5ms)[0m   [0;1mSELECT * FROM `segments` [0m
  [4;35;1mState Load (0.4ms)[0m   [0mSELECT * FROM `states` [0m
Rendered address/_form (4.8ms)
Rendered companies/_company (9.2ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.5ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 246ms (View: 34, DB: 17) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.0&company_type=CompanyZ&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ398825' AND `companies`.id <> 27) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 67) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 67) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 67) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 67) LIMIT 1[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:05) [POST]
  Parameters: {"person"=>{}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9cc17135c4e4c1e3d163a9e5677da3ff57764402', '2011-04-22 17:56:05', NULL, NULL, NULL, '481a346c71f8385a43a86957d1bfe249c10602ce', NULL, '2011-04-22 17:56:05', NULL, 'da5a84ed0006d87d28a39e6a2a335f460be464c8', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 68, NULL)[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;68\n', '2011-04-22 17:56:05', 0, '2011-04-22 17:56:05', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 68) LIMIT 1[0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 68) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 68) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 68) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 68) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 68) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (17.6ms)
Rendered people/_person (152.6ms)
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 194ms (View: 165, DB: 11) | 200 OK [http://test.host/usuarios?&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 68) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 68) LIMIT 1[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:05) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>nil}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`email` IS NULL) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.7ms)
Rendered people/_person (16.1ms)
  [4;35;1mCompany Load (0.7ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 50ms (View: 33, DB: 7) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:05) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>nil, "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (`users`.`login` IS NULL) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.9ms)
Rendered people/_person (16.4ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 56ms (View: 36, DB: 5) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:05) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>nil, "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (15.7ms)
Rendered people/_person (16.1ms)
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 184ms (View: 31, DB: 8) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:05) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>nil, "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = NULL)) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
Rendered people/_form (16.9ms)
Rendered people/_person (17.2ms)
  [4;35;1mCompany Load (0.8ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 57ms (View: 38, DB: 6) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m


Processing UsersController#resend_signup_mail (for 0.0.0.0 at 2011-04-22 14:56:05) [GET]
  Parameters: {"id"=>#<UserGeneralManager id: 2, login: "gerente_geral", email: "gerente_geral@example.com", crypted_password: "00742970dc9e6319f8019fd54864d3ea740f04b1", salt: "7e3041ebc2fc05a40c60028e2c4901a81035d3cd", created_at: "2011-04-21 17:55:52", updated_at: "2011-04-22 17:55:53", remember_token: nil, remember_token_expires_at: nil, activation_code: "8f24789ae988411ccf33ab0c30fe9106fab32e9a", activated_at: nil, password_reset_code: nil, enabled: true, type: "UserGeneralManager", self_created: false, avatar_file_name: nil, avatar_content_type: nil, avatar_file_size: nil, avatar_updated_at: nil, domain: nil>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 2) [0m
Sent mail to gerente_geral@example.com

Date: Fri, 22 Apr 2011 14:56:05 -0300
From: bsiqueira@suaempreza.com.br
To: gerente_geral@example.com
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_Por_favor=2C_ative_sua_conta=2E?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <h1 style="background-image: none;clear: right !important;color: #000;font-size: 21px;font-weight: normal;line-height: 1;margin: 3px 0;padding: 0 !important;text-align: left;">Bem vindo ao C√©lula Z!</h1><br>
gerente_geral, sua conta foi criada.
<br>
Precisamos que voc√™ confirme a validade do seu email. Para isso,  visite o endere√ßo abaixo para ativar a sua conta:<br>
<p>
  <a href="http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a">http://localhost:3000/activate/8f24789ae988411ccf33ab0c30fe9106fab32e9a</a><br>
</p>
<br>
        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/usuarios
Completed in 6ms (DB: 2) | 302 Found [http://test.host/users/resend_signup_mail/2]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:05) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mUserAdministrator Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('9cc17135c4e4c1e3d163a9e5677da3ff57764402', '2011-04-22 17:56:05', NULL, NULL, NULL, '481a346c71f8385a43a86957d1bfe249c10602ce', NULL, '2011-04-22 17:56:05', NULL, '93ab4ea37df36a141e95d83314d5fa39becf2a93', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 69, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;69\n', '2011-04-22 17:56:05', 0, '2011-04-22 17:56:05', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 69) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 69) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:05', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:56:05', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 69) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.4ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:05', '2011-04-22 17:56:05', 69, 56)[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 69) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.2ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 69 AND `user_people`.id <> 956136663) LIMIT 1[0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 69)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 69) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 69) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 56)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=56) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 56)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 56)) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 56)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 56)) LIMIT 1[0m
  [4;36;1mPerson Update (0.4ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:05', `user_id` = 69 WHERE `id` = 56[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '93ab4ea37df36a141e95d83314d5fa39becf2a93') LIMIT 1[0m
  [4;36;1mUserAdministrator Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:05', `activated_at` = '2011-04-22 17:56:05' WHERE `id` = 69[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;69\n', '2011-04-22 17:56:05', 0, '2011-04-22 17:56:05', 0, NULL, NULL)[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (1.8ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 196ms (View: 141, DB: 13) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 69) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (33.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:06) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSubsidiary Load (0.1ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('771794a155d268d206eeb6993c9f02bddfaba8f3', '2011-04-22 17:56:06', NULL, NULL, NULL, '50097e1a42f3cad721b132a9fbaf9a8962b5f275', NULL, '2011-04-22 17:56:06', NULL, '0d2019bb21783d6237d7f4bd242603741efc6013', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 70, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;70\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 70) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 70) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:06', 1, '356.726.002-20', '2008-09-09', '2011-04-22 17:56:06', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', 1)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 70) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 70, 57)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 70) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.2ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 70 AND `user_people`.id <> 956136664) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 70)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 70) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 70) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 57)) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=57) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 57)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 57)) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 57)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 57)) LIMIT 1[0m
  [4;35;1mPerson Update (0.3ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:06', `user_id` = 70 WHERE `id` = 57[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '0d2019bb21783d6237d7f4bd242603741efc6013') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.2ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:06', `activated_at` = '2011-04-22 17:56:06' WHERE `id` = 70[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;70\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `users`.id FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (people.subsidiary_id = 1 and users.type in ('UserWebAdministratorSenior','UserWebAdministratorTrainee')) ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.user_web_adm_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.3ms)
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
Completed in 62ms (View: 8, DB: 45) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mUserAdministrator Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 70) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:06) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"356.726.002-20", "subsidiary_id"=>1, "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserAdministrator", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '356.726.002-20') LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mUserAdministrator Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('771794a155d268d206eeb6993c9f02bddfaba8f3', '2011-04-22 17:56:06', NULL, NULL, NULL, '50097e1a42f3cad721b132a9fbaf9a8962b5f275', NULL, '2011-04-22 17:56:06', NULL, '3e67b54eb2b49f8fcfd46793bcf10cceba17ca6b', NULL, 1, 'UserAdministrator', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 71, NULL)[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserAdministrator;71\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 71) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 71) LIMIT 1[0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:06', 3, '356.726.002-20', '2008-09-09', '2011-04-22 17:56:06', NULL, '2008-09-09', 1, 3, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 71) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 71, 58)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 71) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 71 AND `user_people`.id <> 956136665) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 71)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 71) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 71) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 58)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=58) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 58)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 58)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 58)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 58)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:06', `user_id` = 71 WHERE `id` = 58[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '3e67b54eb2b49f8fcfd46793bcf10cceba17ca6b') LIMIT 1[0m
  [4;35;1mUserAdministrator Update (0.3ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:06', `activated_at` = '2011-04-22 17:56:06' WHERE `id` = 71[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserAdministrator;71\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (id<>3 and type<>'UserCompany') ORDER BY login LIMIT 0, 30[0m
Rendering template within layouts/new_admin
Rendering users/index
Rendered users/_user (3.0ms)
Rendered users/_user (3.0ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.3ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.4ms)
Rendered users/_user (2.5ms)
Rendered users/_user (2.5ms)
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.6ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 81ms (View: 32, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=356.726.002-20&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&person%5Bsubsidiary_id%5D=1&type=UserAdministrator&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mUserAdministrator Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 71) AND ( (`users`.`type` = 'UserAdministrator' OR `users`.`type` = 'UserDirector' OR `users`.`type` = 'UserSupport' OR `users`.`type` = 'UserGeneralManager' OR `users`.`type` = 'UserSegmentManager' OR `users`.`type` = 'UserWebAdministrator' OR `users`.`type` = 'UserWebAdministratorSenior' OR `users`.`type` = 'UserWebAdministratorTrainee' ) ) [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:06) [POST]
  Parameters: {"company"=>{"parcel"=>12, "segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "value"=>50.1, "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"034.185.221-06", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`cpf` = '034.185.221-06') LIMIT 1[0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;36;1mUserCompany Create (0.6ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('771794a155d268d206eeb6993c9f02bddfaba8f3', '2011-04-22 17:56:06', NULL, NULL, NULL, '50097e1a42f3cad721b132a9fbaf9a8962b5f275', NULL, '2011-04-22 17:56:06', NULL, '32be0da290084872b4fe45bbe7a027e7559822c1', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.4ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 72, NULL)[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;72\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ43067') LIMIT 1[0m
  [4;35;1mCompanyZ Create (0.4ms)[0m   [0mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:56:06', NULL, '2011-04-22 17:56:06', '61.286.834/0001-08', NULL, NULL, 72, 'CompanyZ', 'SZ43067', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 28) [0m
  [4;35;1mContract Create (0.4ms)[0m   [0mINSERT INTO `contracts` (`parcel`, `created_at`, `initial_date`, `updated_at`, `value`, `company_id`, `end_date`, `status`) VALUES(12, '2011-04-22 17:56:06', '2011-04-22 17:56:06', '2011-04-22 17:56:06', 50.1, 28, '2012-04-22 17:56:06', 'Aberto')[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 28) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;35;1mLayout Create (0.4ms)[0m   [0mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:56:06', NULL, NULL, '2011-04-22 17:56:06', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 28, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;36;1mColorTemplate Load (0.5ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;35;1mColor Load (0.4ms)[0m   [0mSELECT * FROM `colors` WHERE (`colors`.layout_id = 22) LIMIT 1[0m
  [4;36;1mColor Create (0.4ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 22, NULL, NULL, 'MyStri')[0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:56:06', `name` = 'Empresa', `created_at` = '2011-04-22 17:56:06', `company_id` = 28 WHERE `id` = 22[0m
  [4;36;1mAddress Create (0.4ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 22, 'MyString', 'MySring', 1, NULL, 'Layout', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mTab Create (0.2ms)[0m   [0mINSERT INTO `tabs` (`created_at`, `title`, `updated_at`, `order`, `layout_id`) VALUES('2011-04-22 17:56:06', 'Home', '2011-04-22 17:56:06', NULL, 22)[0m
  [4;36;1mColorTemplate Load (0.3ms)[0m   [0;1mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;35;1mColor Create (0.4ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 22, NULL, NULL, 'MyStri')[0m
  [4;36;1mColor Update (0.4ms)[0m   [0;1mUPDATE `colors` SET `updated_at` = '2011-04-22 17:56:06', `layout_id` = NULL WHERE `id` = 980190997[0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, 1, 28, 'Company')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 28, 38)[0m
  [4;35;1mAddress Create (0.3ms)[0m   [0mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 28, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 72) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 72) LIMIT 1[0m
  [4;36;1mPerson Create (0.3ms)[0m   [0;1mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:06', 4, '034.185.221-06', '2008-09-09', '2011-04-22 17:56:06', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 72) LIMIT 1[0m
  [4;36;1mUserPerson Create (0.3ms)[0m   [0;1mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 72, 59)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ43067' AND `companies`.id <> 28) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;36;1mUserPerson Load (0.5ms)[0m   [0;1mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 72) LIMIT 1[0m
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 72 AND `user_people`.id <> 956136666) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 72)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 72) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 72) LIMIT 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=59) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:06', `user_id` = 72 WHERE `id` = 59[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`activation_code` = '32be0da290084872b4fe45bbe7a027e7559822c1') LIMIT 1[0m
  [4;35;1mUserCompany Update (0.4ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:06', `activated_at` = '2011-04-22 17:56:06' WHERE `id` = 72[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;72\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 59) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=59) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
  [4;35;1mPerson Load (0.6ms)[0m   [0mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;36;1mUser Load Including Associations (1.1ms)[0m   [0;1mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 72) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 72)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (4.4ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 28 AND (status='Aberto')) [0m
Rendered users/_sidebar (3.6ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 273ms (View: 19, DB: 30) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Bparcel%5D=12&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company%5Bvalue%5D=50.1&company_type=CompanyZ&person%5Bcpf%5D=034.185.221-06&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `addresses` [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ43067' AND `companies`.id <> 28) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=59) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 59)) LIMIT 1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 72) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 72) LIMIT 1[0m
  [4;35;1mSQL (1.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:06) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "company_type"=>"CompanyZ", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('771794a155d268d206eeb6993c9f02bddfaba8f3', '2011-04-22 17:56:06', NULL, NULL, NULL, '50097e1a42f3cad721b132a9fbaf9a8962b5f275', NULL, '2011-04-22 17:56:06', NULL, 'a05c70ce74af00787bb30111b2a284aa1de97084', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.4ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 73, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;73\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ182831') LIMIT 1[0m
  [4;36;1mCompanyZ Create (0.3ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:56:06', NULL, '2011-04-22 17:56:06', NULL, NULL, NULL, 73, 'CompanyZ', 'SZ182831', NULL, 'Empresa', NULL, NULL, NULL, 'mensal', NULL)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 29) [0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 29, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 73) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 73) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:06', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:56:06', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 73) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 73, 60)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ182831' AND `companies`.id <> 29) LIMIT 1[0m
  [4;35;1mContract Load (0.5ms)[0m   [0mSELECT * FROM `contracts` WHERE (`contracts`.company_id = 29) ORDER BY created_at DESC[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=60) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 73) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 73) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ182831' AND `companies`.id <> 29) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_company
Rendered people/_form (13.6ms)
Rendered people/_person (13.9ms)
  [4;35;1mSegment Load (0.5ms)[0m   [0mSELECT * FROM `segments` [0m
  [4;36;1mState Load (0.4ms)[0m   [0;1mSELECT * FROM `states` [0m
Rendered address/_form (5.6ms)
Rendered companies/_company (12.4ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.5ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 230ms (View: 36, DB: 21) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&company_type=CompanyZ&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `companies` [0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ182831' AND `companies`.id <> 29) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:06) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "razao_social"=>"Empresa", "informal"=>"1"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"AC"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"099.033.907-69", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`cpf` = '099.033.907-69') LIMIT 1[0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.2ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.4ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('771794a155d268d206eeb6993c9f02bddfaba8f3', '2011-04-22 17:56:06', NULL, NULL, NULL, '50097e1a42f3cad721b132a9fbaf9a8962b5f275', NULL, '2011-04-22 17:56:06', NULL, '6027639190a6c7ae63a09847a26214ad0076f850', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.3ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 74, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:06', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;74\n', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ124993') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.5ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:56:06', NULL, '2011-04-22 17:56:06', NULL, NULL, NULL, 74, 'CompanyS', 'SZ124993', NULL, 'Empresa', NULL, NULL, 1, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 30) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.5ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:56:06', NULL, NULL, '2011-04-22 17:56:06', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 30, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.2ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 23) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 23, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.3ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:56:06', `name` = 'Empresa', `created_at` = '2011-04-22 17:56:06', `company_id` = 30 WHERE `id` = 23[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.5ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.5ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 23, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.4ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:56:06', `layout_id` = NULL WHERE `id` = 980190999[0m
  [4;36;1mFeedItem Create (0.2ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 0, 1, 30, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 30, 39)[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:06', 0, '2011-04-22 17:56:06', 30, 'MyString', 'MySring', 1, NULL, 'Company', 'AC')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 74) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 74) LIMIT 1[0m
  [4;35;1mPerson Create (0.3ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:06', 4, '099.033.907-69', '2008-09-09', '2011-04-22 17:56:06', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.4ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 74) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.2ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:06', '2011-04-22 17:56:06', 74, 61)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ124993' AND `companies`.id <> 30) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.3ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 74) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 74 AND `user_people`.id <> 956136668) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 74)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 74) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 74) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=61) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:07', `user_id` = 74 WHERE `id` = 61[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = '6027639190a6c7ae63a09847a26214ad0076f850') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:07', `activated_at` = '2011-04-22 17:56:07' WHERE `id` = 74[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:07', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;74\n', '2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 61) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=61) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 61)) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.6ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 74) [0m
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 74)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (4.2ms)
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 253ms (View: 16, DB: 25) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=AC&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Binformal%5D=1&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bcpf%5D=099.033.907-69&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ124993' AND `companies`.id <> 30) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:07) [POST]
  Parameters: {"company"=>{"segment_id"=>1, "cnpj"=>"61.286.834/0001-08", "razao_social"=>"Empresa", "informal"=>"0"}, "address"=>{"city"=>"MyString", "number"=>"1111", "zip"=>"MyString", "street"=>"MyString", "neighborhood"=>"MySring", "state"=>"RJ"}, "person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserCompany", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) LIMIT 1[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 4)) [0m
  [4;35;1mSubsidiary Load (0.1ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Create (0.3ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('8b66bb9b31f957bc2d4a131389a9dad981c4dcc1', '2011-04-22 17:56:07', NULL, NULL, NULL, '0292f550404a7a4b0d3433214624267859641fac', NULL, '2011-04-22 17:56:07', NULL, 'c5e099e9c504a3b3c452c2dc56ae06bb27aa1cb0', NULL, 1, 'UserCompany', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.2ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.2ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 75, NULL)[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:07', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserCompany;75\n', '2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 0, NULL, NULL)[0m
  [4;36;1mSegment Load (0.3ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
[paperclip] Paperclip attachment profile_logo on CompanyS initialized.
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`drawee_code` = 'SZ466450') LIMIT 1[0m
  [4;36;1mCompanyS Create (0.4ms)[0m   [0;1mINSERT INTO `companies` (`segment_id`, `created_at`, `profile_logo_updated_at`, `updated_at`, `cnpj`, `register_number`, `profile_logo_file_name`, `user_id`, `type`, `drawee_code`, `person_id`, `razao_social`, `profile_logo_content_type`, `state_id`, `informal`, `payment_type`, `profile_logo_file_size`) VALUES(1, '2011-04-22 17:56:07', NULL, '2011-04-22 17:56:07', '61.286.834/0001-08', NULL, NULL, 75, 'CompanyS', 'SZ466450', NULL, 'Empresa', NULL, NULL, 0, 'mensal', NULL)[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 31) LIMIT 1[0m
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Paperclip attachment my_background_top on Layout initialized.
  [4;36;1mLayout Create (0.4ms)[0m   [0;1mINSERT INTO `layouts` (`name`, `flickr`, `slogan`, `created_at`, `font_colors`, `repeat_background_x`, `updated_at`, `side_image_url`, `repeat_background_y`, `show_name`, `show_slogan`, `show_logo`, `send_to_friend`, `centralize_background`, `card2_file_name`, `meta_description`, `meta_keywords`, `company_id`, `website`, `card1_file_name`, `card2_content_type`, `card2_file_size`, `architecture_type`, `card1_file_size`, `card3_content_type`, `background_top`, `facebook`, `presentation_text`, `background_file_name`, `card3_file_name`, `component_decoration`, `orkut`, `card1_content_type`, `card3_file_size`, `email`, `twitter`, `analytics`) VALUES('Empresa', NULL, NULL, '2011-04-22 17:56:07', NULL, NULL, '2011-04-22 17:56:07', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 31, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)[0m
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
  [4;36;1mColor Load (0.3ms)[0m   [0;1mSELECT * FROM `colors` WHERE (`colors`.layout_id = 24) LIMIT 1[0m
  [4;35;1mColor Create (0.3ms)[0m   [0mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 24, NULL, NULL, 'MyStri')[0m
  [4;36;1mLayout Update (0.4ms)[0m   [0;1mUPDATE `layouts` SET `updated_at` = '2011-04-22 17:56:07', `name` = 'Empresa', `created_at` = '2011-04-22 17:56:07', `company_id` = 31 WHERE `id` = 24[0m
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving attachments.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
  [4;35;1mColorTemplate Load (0.3ms)[0m   [0mSELECT * FROM `color_templates` LIMIT 1[0m
WARNING: Can't mass-assign these protected attributes: id
  [4;36;1mColor Create (0.2ms)[0m   [0;1mINSERT INTO `colors` (`name`, `title_text`, `subtitle_text`, `body_sidebar`, `slogan`, `created_at`, `title_background`, `title`, `tool_body`, `body`, `text_background`, `footer_background`, `background`, `updated_at`, `subtitle_background`, `subtitle`, `text`, `checked_menu`, `unchecked_menu`, `background_menu`, `menu_hover_text`, `border`, `name_company_text`, `slogan_company_text`, `link_background`, `footer_text`, `menu_deselected_text`, `sidebar_text`, `menu_deselected_background`, `menu_selected_text`, `menu_hover_background`, `layout_id`, `menu_selected_background`, `link_text`, `tool_botton`) VALUES('MyStri', NULL, NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', NULL, NULL, 'MyStri', '2011-04-22 17:55:52', NULL, 'MyStri', 'MyStri', 'MyStri', 'MyStri', 'MyStri', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 24, NULL, NULL, 'MyStri')[0m
  [4;35;1mColor Update (0.3ms)[0m   [0mUPDATE `colors` SET `updated_at` = '2011-04-22 17:56:07', `layout_id` = NULL WHERE `id` = 980191001[0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 0, 1, 31, 'Company')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:56:07', '2011-04-22 17:56:07', 31, 40)[0m
  [4;36;1mAddress Create (0.3ms)[0m   [0;1mINSERT INTO `addresses` (`number`, `city`, `zip`, `created_at`, `show_sidebar`, `updated_at`, `owner_id`, `street`, `neighborhood`, `show`, `complement`, `owner_type`, `state`) VALUES(1111, 'MyString', 'MyString', '2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 31, 'MyString', 'MySring', 1, NULL, 'Company', 'RJ')[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 75) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 75) LIMIT 1[0m
  [4;35;1mPerson Create (0.4ms)[0m   [0mINSERT INTO `people` (`name`, `created_at`, `user_create_id`, `cpf`, `date_birth`, `updated_at`, `user_id`, `rg_exp_date`, `subsidiary_id`, `user_confirm_id`, `agency`, `account_number`, `bank_id`, `state_id`, `rg`, `rg_exp`, `user_web_adm_id`) VALUES('Bruno Siqueira', '2011-04-22 17:56:07', 4, NULL, '2008-09-09', '2011-04-22 17:56:07', NULL, '2008-09-09', 1, NULL, NULL, NULL, NULL, NULL, 'MyString', 'MyString', NULL)[0m
  [4;36;1mUserPerson Load (0.5ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 75) LIMIT 1[0m
  [4;35;1mUserPerson Create (0.3ms)[0m   [0mINSERT INTO `user_people` (`created_at`, `updated_at`, `user_id`, `person_id`) VALUES('2011-04-22 17:56:07', '2011-04-22 17:56:07', 75, 62)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ466450' AND `companies`.id <> 31) LIMIT 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for profile_logo
[paperclip] Deleting files for profile_logo
[paperclip] Writing files for profile_logo
  [4;35;1mUserPerson Load (0.4ms)[0m   [0mSELECT * FROM `user_people` WHERE (`user_people`.user_id = 75) LIMIT 1[0m
  [4;36;1mUserPerson Load (0.3ms)[0m   [0;1mSELECT `user_people`.id FROM `user_people` WHERE (`user_people`.`user_id` = 75 AND `user_people`.id <> 956136669) LIMIT 1[0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 75)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 75) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 75) LIMIT 1[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=62) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) LIMIT 1[0m
  [4;36;1mPerson Update (0.3ms)[0m   [0;1mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:07', `user_id` = 75 WHERE `id` = 62[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`activation_code` = 'c5e099e9c504a3b3c452c2dc56ae06bb27aa1cb0') LIMIT 1[0m
  [4;36;1mUserCompany Update (0.3ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:07', `activated_at` = '2011-04-22 17:56:07' WHERE `id` = 75[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment avatar on UserCompany initialized.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:07', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_welcome\nargs: \n- LOAD;UserCompany;75\n', '2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 0, NULL, NULL)[0m
  [4;36;1mPerson Load (0.3ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 62) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=62) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mPerson Load (0.8ms)[0m   [0;1mselect people.* from people as people where people.user_confirm_id is not null and people.subsidiary_id= 1 and not exists (select up.* from user_people as up where people.id = up.person_id) union select people.* from people as people inner join user_people as up on people.id = up.person_id inner join users as u on up.user_id = u.id and u.type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') where people.user_confirm_id is not null and people.subsidiary_id= 1 and u.id<>4 order by name [0m
Rendering template within layouts/new_admin
Rendering users/new_page_2
  [4;35;1mUser Load Including Associations (0.9ms)[0m   [0mSELECT `users`.`id` AS t0_r0, `users`.`login` AS t0_r1, `users`.`email` AS t0_r2, `users`.`crypted_password` AS t0_r3, `users`.`salt` AS t0_r4, `users`.`created_at` AS t0_r5, `users`.`updated_at` AS t0_r6, `users`.`remember_token` AS t0_r7, `users`.`remember_token_expires_at` AS t0_r8, `users`.`activation_code` AS t0_r9, `users`.`activated_at` AS t0_r10, `users`.`password_reset_code` AS t0_r11, `users`.`enabled` AS t0_r12, `users`.`type` AS t0_r13, `users`.`self_created` AS t0_r14, `users`.`avatar_file_name` AS t0_r15, `users`.`avatar_content_type` AS t0_r16, `users`.`avatar_file_size` AS t0_r17, `users`.`avatar_updated_at` AS t0_r18, `users`.`domain` AS t0_r19, `people`.`id` AS t1_r0, `people`.`user_id` AS t1_r1, `people`.`name` AS t1_r2, `people`.`cpf` AS t1_r3, `people`.`rg` AS t1_r4, `people`.`rg_exp` AS t1_r5, `people`.`rg_exp_date` AS t1_r6, `people`.`date_birth` AS t1_r7, `people`.`created_at` AS t1_r8, `people`.`updated_at` AS t1_r9, `people`.`subsidiary_id` AS t1_r10, `people`.`user_create_id` AS t1_r11, `people`.`user_confirm_id` AS t1_r12, `people`.`state_id` AS t1_r13, `people`.`user_web_adm_id` AS t1_r14, `people`.`bank_id` AS t1_r15, `people`.`agency` AS t1_r16, `people`.`account_number` AS t1_r17 FROM `users` LEFT OUTER JOIN `user_people` ON (`users`.`id` = `user_people`.`user_id`) LEFT OUTER JOIN `people` ON (`people`.`id` = `user_people`.`person_id`) WHERE (type in ('UserWebAdministrator','UserWebAdministratorSenior','UserWebAdministratorTrainee') and people.subsidiary_id=1) ORDER BY login[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 75) [0m
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 75)) [0m
Rendered address/_address_show (0.2ms)
Rendered companies/_company_show (4.4ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT `companies`.* FROM `companies` as companies join user_people as up on companies.user_id = up.user_id join people as people on people.id = up.person_id WHERE (people.subsidiary_id = 1) ORDER BY companies.razao_social[0m
Rendered users/_sidebar (2.4ms)
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
Completed in 251ms (View: 16, DB: 26) | 200 OK [http://test.host/usuarios?address%5Bcity%5D=MyString&address%5Bneighborhood%5D=MySring&address%5Bnumber%5D=1111&address%5Bstate%5D=RJ&address%5Bstreet%5D=MyString&address%5Bzip%5D=MyString&company%5Bcnpj%5D=61.286.834%2F0001-08&company%5Binformal%5D=0&company%5Brazao_social%5D=Empresa&company%5Bsegment_id%5D=1&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserCompany&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 4) [0m
  [4;36;1mPerson Load (0.4ms)[0m   [0;1mSELECT * FROM `people` WHERE (`people`.`id` = 6) [0m
  [4;35;1mSubsidiary Load (0.3ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSubsidiary Load (0.2ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT `companies`.id FROM `companies` WHERE (`companies`.`drawee_code` = BINARY 'SZ466450' AND `companies`.id <> 31) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=62) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 62)) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 75) LIMIT 1[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 75) LIMIT 1[0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) AS count_all FROM `people` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:07) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "cpf"=>"", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;36;1mUserSegmentManager Create (0.3ms)[0m   [0;1mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('8b66bb9b31f957bc2d4a131389a9dad981c4dcc1', '2011-04-22 17:56:07', NULL, NULL, NULL, '0292f550404a7a4b0d3433214624267859641fac', NULL, '2011-04-22 17:56:07', NULL, 'd83f4d1953e28e44d5605ce45fdd495ff14735e2', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;36;1mFolder Create (0.2ms)[0m   [0;1mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 76, NULL)[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0;1mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:07', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;76\n', '2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 76) LIMIT 1[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 76) LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 76) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 76) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 76) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 76) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;36;1mSubsidiary Load (0.4ms)[0m   [0;1mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (20.4ms)
Rendered people/_person (20.8ms)
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.4ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 68ms (View: 37, DB: 14) | 200 OK [http://test.host/usuarios?person%5Bcpf%5D=&person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `people` [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 76) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 76) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 76) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 76) LIMIT 1[0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `users` [0m


Processing UsersController#create (for 0.0.0.0 at 2011-04-22 14:56:07) [POST]
  Parameters: {"person"=>{"name"=>"Bruno Siqueira", "date_birth"=>"2008-09-09", "rg_exp_date"=>"2008-09-09", "rg_exp"=>"MyString", "rg"=>"MyString"}, "type"=>"UserSegmentManager", "user"=>{"password_confirmation"=>"quire", "login"=>"quire", "password"=>"quire", "email"=>"quire@example.com"}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire') LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com') LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserSegmentManager initialized.
  [4;35;1mUserSegmentManager Create (0.5ms)[0m   [0mINSERT INTO `users` (`salt`, `created_at`, `activated_at`, `avatar_file_name`, `avatar_file_size`, `crypted_password`, `remember_token_expires_at`, `updated_at`, `password_reset_code`, `activation_code`, `domain`, `enabled`, `type`, `avatar_content_type`, `remember_token`, `login`, `avatar_updated_at`, `email`, `self_created`) VALUES('8b66bb9b31f957bc2d4a131389a9dad981c4dcc1', '2011-04-22 17:56:07', NULL, NULL, NULL, '0292f550404a7a4b0d3433214624267859641fac', NULL, '2011-04-22 17:56:07', NULL, '274799bd2679e02e730f79d59305110f2c964652', NULL, 1, 'UserSegmentManager', NULL, NULL, 'quire', NULL, 'quire@example.com', 0)[0m
  [4;36;1mFolder Load (0.3ms)[0m   [0;1mSELECT * FROM `folders` WHERE (`folders`.user_id = NULL) [0m
  [4;35;1mFolder Create (0.4ms)[0m   [0mINSERT INTO `folders` (`name`, `user_id`, `parent_id`) VALUES('Inbox', 77, NULL)[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (type='UserDirector') LIMIT 1[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.4ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:56:07', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;UserMailer\nmethod: :deliver_notify_director\nargs: \n- LOAD;UserDirector;11\n- LOAD;UserSegmentManager;77\n', '2011-04-22 17:56:07', 0, '2011-04-22 17:56:07', 0, NULL, NULL)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 77) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 77) LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK TO SAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 77) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 77) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 77) LIMIT 1[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 77) LIMIT 1[0m
Rendering template within layouts/new_admin
Rendering users/new_comercial
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` [0m
Rendered people/_form (19.4ms)
Rendered people/_person (157.5ms)
  [4;36;1mCompany Load (0.6ms)[0m   [0;1mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` ORDER BY razao_social[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 5 AND (status='Aberto')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `contracts` WHERE (`contracts`.company_id = 7 AND (status='Aberto')) [0m
Rendered users/_sidebar (4.5ms)
[paperclip] Paperclip attachment avatar on UserAdministrator initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 3)) [0m
Completed in 208ms (View: 173, DB: 12) | 200 OK [http://test.host/usuarios?person%5Bdate_birth%5D=2008-09-09&person%5Bname%5D=Bruno+Siqueira&person%5Brg%5D=MyString&person%5Brg_exp%5D=MyString&person%5Brg_exp_date%5D=2008-09-09&type=UserSegmentManager&user%5Bemail%5D=quire%40example.com&user%5Blogin%5D=quire&user%5Bpassword%5D=quire&user%5Bpassword_confirmation%5D=quire]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 77) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 77) LIMIT 1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quire' AND `users`.id <> 77) LIMIT 1[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quire@example.com' AND `users`.id <> 77) LIMIT 1[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m


Processing UsersController#update (for 0.0.0.0 at 2011-04-22 14:56:07) [GET]
  Parameters: {"user"=>{"login"=>"quentin2"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;35;1mUserCompany Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` IS NULL) AND ( (`users`.`type` = 'UserCompany' ) ) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 1) [0m
  [4;35;1mPerson Load (0.3ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 1)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'quentin2' AND `users`.id <> 1) LIMIT 1[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'quentin@example.com' AND `users`.id <> 1) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 1) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserWebAdministrator initialized.
  [4;36;1mUserWebAdministrator Update (0.5ms)[0m   [0;1mUPDATE `users` SET `updated_at` = '2011-04-22 17:56:07', `login` = 'quentin2' WHERE `id` = 1[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `users`.id) AS count_all FROM `users` LEFT OUTER JOIN `companies` ON companies.user_id = users.id LEFT OUTER JOIN `user_people` ON user_people.user_id = users.id WHERE (companies.type = 'CompanyS' and user_people.person_id=3) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT `users`.* FROM `users` INNER JOIN `user_people` ON `users`.id = `user_people`.user_id WHERE ((`user_people`.person_id = 3)) LIMIT 1[0m
  [4;35;1mPerson Update (0.4ms)[0m   [0mUPDATE `people` SET `updated_at` = '2011-04-22 17:56:07', `user_id` = 1 WHERE `id` = 3[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/
Completed in 24ms (DB: 10) | 302 Found [http://test.host/users/update?user%5Blogin%5D=quentin2]
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSubsidiary Load (0.4ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m


Processing VisitSchedulerController#create (for 0.0.0.0 at 2011-04-22 14:56:07) [PUT]
  Parameters: {"visit_schedule"=>{"city"=>"oidjsa", "segment_id"=>#<Segment id: 1, name: "Alimenta√ß√£o", file: "Mystring.jpg">, "name"=>"siuhsi", "address"=>"diuashdiauhdiusha", "ddd"=>"021", "time_to_visit"=>"Indiferente", "subsidiary_id"=>#<Subsidiary id: 1, title: "Filial 1", created_at: "2011-04-22 17:55:53", updated_at: "2011-04-22 17:55:53", enabled: true>, "phone"=>"212121", "email"=>"bruno@diudh.com"}}
  [4;35;1mSubsidiary Load (0.5ms)[0m   [0mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`id` = 1) [0m
  [4;36;1mSegment Load (0.4ms)[0m   [0;1mSELECT * FROM `segments` WHERE (`segments`.`id` = 1) [0m
Sent mail to bsiqueira@suaempreza.com.br

Date: Fri, 22 Apr 2011 14:56:07 -0300
From: bsiqueira@suaempreza.com.br
To: bsiqueira@suaempreza.com.br
Subject: =?utf-8?Q?=5BC=C3=A9lula_Z=5D_siuhsi=3A_Solicita=C3=A7=C3=A3o_de_visita?=
Mime-Version: 1.0
Content-Type: text/html; charset=utf-8

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>C√©lula Z</title>
  </head>

  <body style=" font-family:Arial, Helvetica, sans-serif;margin:0px auto; padding:0px;">
  
    <div style="position:relative; top:0px; background-color:#FFFFFF;  margin:0px; width:470px; padding:20px; height:auto; top:0px;">
      <div style=" font-family: Arial, Helvetica, sans-serif!important;  text-align:left; font-size:12px; color:#333;  line-height:140%;">
          <html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>C√©lula Z</title>
</head>
<body>
  <h1> Solicita√ß√£o de Agendamento de Visita</h1>

  <p>
    <b>Nome:</b>
    siuhsi
  </p>

  <p>
    <b>Email:</b>
    bruno@diudh.com
  </p>

  <p>
    <b>Telefone:</b>
    021 212121
  </p>

  <p>
    <b>Endere√ßo:</b>
    diuashdiauhdiusha - oidjsa
  </p>

  <p>
    <b>Filial:</b>
    Filial 1
  </p>

  <p>
    <b>Segmento:</b>
    Alimenta√ß√£o
  </p>

  <p>
    <b>Hor√°rio de Prefer√™ncia para Visita:</b>
    Indiferente
  </p>

  <p>
    <b>Observa√ß√µes:</b>
    
  </p>
</body>        
      </div>
        <div style="position:relative;line-height: 40px; background-color:#FFFFFF;   padding:20px;border-top:#eee 1px solid; font-size:10px; color:#F60; font-weight:bold; text-align:center; font-family:Arial, Helvetica, sans-serif;width:430px; text-transform:uppercase; float: left">
          <a style=" text-decoration:none;float: left " href="http://localhost:3000"><img width="106" height="39"style="margin: -15px 10px -10px 0; border:none 0px " src="http://localhost:3000/images/new_version/logo-small.gif"/></a> Seu crescimento pela internet
      </div>
      <div style="overflow:hidden; font-family:Arial; font-size:10px; text-align:center; color:#333; margin: 0px;  font-weight:normal; padding: 10px 0px; width:470px; float: left;">
          Favor n√£o responder este e-mail. Qualquer d√∫vida entre em contato com seu Administrador Web
        </div>
      <p style="font-size:10px; color:#0052A4; text-align:center; font-family:Arial, Helvetica, sans-serif; line-height:0px; margin:0px;">C√©lula Z - Todos direito reservados.</p>  
    </div>
  </body>
</html>
Redirected to http://test.host/login
Completed in 11ms (DB: 3) | 302 Found [http://test.host/visit_scheduler/create?visit_schedule%5Baddress%5D=diuashdiauhdiusha&visit_schedule%5Bcity%5D=oidjsa&visit_schedule%5Bddd%5D=021&visit_schedule%5Bemail%5D=bruno%40diudh.com&visit_schedule%5Bname%5D=siuhsi&visit_schedule%5Bphone%5D=212121&visit_schedule%5Bsegment_id%5D=1&visit_schedule%5Bsubsidiary_id%5D=1&visit_schedule%5Btime_to_visit%5D=Indiferente]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m


Processing VisitSchedulerController#new (for 0.0.0.0 at 2011-04-22 14:56:07) [GET]
Rendering template within layouts/main
Rendering visit_scheduler/new
  [4;35;1mSegment Load (0.4ms)[0m   [0mSELECT * FROM `segments` ORDER BY name[0m
  [4;36;1mSubsidiary Load (0.3ms)[0m   [0;1mSELECT * FROM `subsidiaries` WHERE (`subsidiaries`.`enabled` = 1) ORDER BY title[0m
  [4;35;1mSegment Load (0.3ms)[0m   [0mSELECT * FROM `segments` [0m
Rendered sessions/_new (1.0ms)
Completed in 13ms (View: 12, DB: 1) | 200 OK [http://test.host/agendar-visita]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.0ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:56:07) [GET]
  Parameters: {"domain"=>"www.celudoaudhisauhdiasuhlaz.com.br"}
Completed in 394ms (View: 1, DB: 1) | 200 OK [http://test.host/whois/check?domain=www.celudoaudhisauhdiasuhlaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:56:08) [GET]
  Parameters: {"domain"=>"www.sorvetefeliz.com.br"}
Completed in 561ms (View: 0, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.sorvetefeliz.com.br]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing WhoisController#check (for 0.0.0.0 at 2011-04-22 14:56:08) [GET]
  Parameters: {"domain"=>"www.celulaz.com.br"}
Completed in 107ms (View: 0, DB: 0) | 200 OK [http://test.host/whois/check?domain=www.celulaz.com.br]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:56:08) [GET]
  Parameters: {"id"=>"empres√£ _&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;35;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;36;1mCompanyZ Load Including Associations (0.7ms)[0m   [0;1mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `layouts`.`id` AS t1_r0, `layouts`.`company_id` AS t1_r1, `layouts`.`architecture_type` AS t1_r2, `layouts`.`name` AS t1_r3, `layouts`.`slogan` AS t1_r4, `layouts`.`website` AS t1_r5, `layouts`.`presentation_text` AS t1_r6, `layouts`.`background_file_name` AS t1_r7, `layouts`.`created_at` AS t1_r8, `layouts`.`updated_at` AS t1_r9, `layouts`.`card1_file_name` AS t1_r10, `layouts`.`card1_content_type` AS t1_r11, `layouts`.`card1_file_size` AS t1_r12, `layouts`.`card2_file_name` AS t1_r13, `layouts`.`card2_content_type` AS t1_r14, `layouts`.`card2_file_size` AS t1_r15, `layouts`.`card3_file_name` AS t1_r16, `layouts`.`card3_content_type` AS t1_r17, `layouts`.`card3_file_size` AS t1_r18, `layouts`.`component_decoration` AS t1_r19, `layouts`.`show_name` AS t1_r20, `layouts`.`show_slogan` AS t1_r21, `layouts`.`show_logo` AS t1_r22, `layouts`.`background_top` AS t1_r23, `layouts`.`send_to_friend` AS t1_r24, `layouts`.`side_image_url` AS t1_r25, `layouts`.`font_colors` AS t1_r26, `layouts`.`email` AS t1_r27, `layouts`.`facebook` AS t1_r28, `layouts`.`orkut` AS t1_r29, `layouts`.`twitter` AS t1_r30, `layouts`.`flickr` AS t1_r31, `layouts`.`repeat_background_x` AS t1_r32, `layouts`.`repeat_background_y` AS t1_r33, `layouts`.`centralize_background` AS t1_r34, `layouts`.`meta_description` AS t1_r35, `layouts`.`meta_keywords` AS t1_r36, `layouts`.`analytics` AS t1_r37, `colors`.`id` AS t2_r0, `colors`.`name` AS t2_r1, `colors`.`slogan` AS t2_r2, `colors`.`title` AS t2_r3, `colors`.`subtitle` AS t2_r4, `colors`.`checked_menu` AS t2_r5, `colors`.`unchecked_menu` AS t2_r6, `colors`.`background_menu` AS t2_r7, `colors`.`tool_botton` AS t2_r8, `colors`.`text` AS t2_r9, `colors`.`tool_body` AS t2_r10, `colors`.`background` AS t2_r11, `colors`.`body` AS t2_r12, `colors`.`created_at` AS t2_r13, `colors`.`updated_at` AS t2_r14, `colors`.`layout_id` AS t2_r15, `colors`.`menu_deselected_text` AS t2_r16, `colors`.`menu_deselected_background` AS t2_r17, `colors`.`menu_selected_text` AS t2_r18, `colors`.`menu_selected_background` AS t2_r19, `colors`.`menu_hover_text` AS t2_r20, `colors`.`menu_hover_background` AS t2_r21, `colors`.`title_text` AS t2_r22, `colors`.`title_background` AS t2_r23, `colors`.`subtitle_text` AS t2_r24, `colors`.`subtitle_background` AS t2_r25, `colors`.`text_background` AS t2_r26, `colors`.`link_text` AS t2_r27, `colors`.`link_background` AS t2_r28, `colors`.`body_sidebar` AS t2_r29, `colors`.`border` AS t2_r30, `colors`.`name_company_text` AS t2_r31, `colors`.`slogan_company_text` AS t2_r32, `colors`.`footer_background` AS t2_r33, `colors`.`footer_text` AS t2_r34, `colors`.`sidebar_text` AS t2_r35, `users`.`id` AS t3_r0, `users`.`login` AS t3_r1, `users`.`email` AS t3_r2, `users`.`crypted_password` AS t3_r3, `users`.`salt` AS t3_r4, `users`.`created_at` AS t3_r5, `users`.`updated_at` AS t3_r6, `users`.`remember_token` AS t3_r7, `users`.`remember_token_expires_at` AS t3_r8, `users`.`activation_code` AS t3_r9, `users`.`activated_at` AS t3_r10, `users`.`password_reset_code` AS t3_r11, `users`.`enabled` AS t3_r12, `users`.`type` AS t3_r13, `users`.`self_created` AS t3_r14, `users`.`avatar_file_name` AS t3_r15, `users`.`avatar_content_type` AS t3_r16, `users`.`avatar_file_size` AS t3_r17, `users`.`avatar_updated_at` AS t3_r18, `users`.`domain` AS t3_r19 FROM `companies` LEFT OUTER JOIN `layouts` ON layouts.company_id = companies.id LEFT OUTER JOIN `colors` ON colors.layout_id = layouts.id LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (7) [0m
Cache write: empres√£ _&valid_2_layout
  [4;35;1mTab Load IDs For Limited Eager Loading (0.4ms)[0m   [0mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;36;1mTab Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;35;1mTab Load Including Associations (0.4ms)[0m   [0mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) AND `tabs`.id IN (3) ORDER BY tabs.order[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (2.6ms)
  [4;36;1mTab Load Including Associations (0.6ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order[0m
Rendered z/_social (0.5ms)
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (1.0ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.4ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (4.8ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 2 AND `addresses`.owner_type = 'Layout') LIMIT 1[0m
  [4;35;1mPhone Load (0.3ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
Rendered z/_address (5.2ms)
Rendered z/_sidebar_address (0.9ms)
  [4;36;1mBanner Load (0.4ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
Completed in 205ms (View: 178, DB: 8) | 200 OK [http://test.host/z/empres%C3%A3%20_&valid_2]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:56:08) [GET]
  Parameters: {"id"=>"empres%C3%A3%20_&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.2ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (0.6ms)
Rendered z/_social (0.1ms)
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.4ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.0ms)
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (3.0ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_address (0.8ms)
Rendered z/_sidebar_address (0.1ms)
Completed in 28ms (View: 21, DB: 4) | 200 OK [http://test.host/z/empres%25C3%25A3%2520_&valid_2]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 14:56:09) [GET]
  Parameters: {"id"=>"asiuhiasuhaiuhsiauhsiauhsiuhai"}
Cache read: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.4ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='asiuhiasuhaiuhsiauhsiauhsiuhai') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
Cache write: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
Redirected to http://test.host/not_found
Filter chain halted as [:find_company] rendered_or_redirected.
Completed in 11ms (DB: 1) | 302 Found [http://test.host/z/asiuhiasuhaiuhsiauhsiauhsiuhai]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m


Processing MessagesController#create (for 0.0.0.0 at 2011-04-22 14:58:32) [POST]
  Parameters: {"message"=>{"sender_email"=>"tester@gmail.com", "body"=>"Corpo da mensagem", "subject"=>"Teste - Mensagem enviada do business card", "to"=>"8"}}
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUserCompany Columns (2.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mFolder Load (0.4ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.4ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES('tester@gmail.com', '2011-04-22 17:58:32', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 17:58:32', 'Teste - Mensagem enviada do business card', NULL, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 15) [0m
  [4;35;1mMessageCopy Create (0.3ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 17:58:32', NULL, 8, NULL, NULL, 15)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Columns (10.3ms)[0m   [0;1mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 17:58:32', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;14\n', '2011-04-22 17:58:32', 0, '2011-04-22 17:58:32', 0, NULL, NULL)[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (13.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mFeedItem Create (0.3ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 17:58:32', 0, '2011-04-22 17:58:32', 0, 0, 15, 'Message')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 17:58:32', '2011-04-22 17:58:32', 5, 41)[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 166ms (View: 1, DB: 673) | 200 OK [http://test.host/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender_email%5D=tester%40gmail.com&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+business+card&message%5Bto%5D=8]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m


Processing Company::ConstructionController#content (for 0.0.0.0 at 2011-04-22 15:35:31) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mCompanyZ Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering /company/construction/content.json
  [4;35;1mTab Load (0.5ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;36;1mComponentText Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mComponentPicture Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mComponentForm Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 1)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 3) [0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 3)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 4) [0m
  [4;35;1mComponent Load (0.6ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
Completed in 171ms (View: 0, DB: 0) | 200 OK [http://test.host/company/construction/content]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:38:56) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:38:56', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:38:56', 'titulo do component', NULL, NULL, '2011-04-22 18:38:56', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 310) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:38:56) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:38:56', 'C√≥digo', NULL, NULL, '2011-04-22 18:38:56', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 104ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:38:57) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:38:56", updated_at: "2011-04-22 18:38:56", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:38:57) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:38:56", updated_at: "2011-04-22 18:38:56", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 5, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:38:57) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:38:57) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:38:56", updated_at: "2011-04-22 18:38:56", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:38:57', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:38:57', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:38:57) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:38:56", updated_at: "2011-04-22 18:38:56", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:38:57', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:39:35', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:39:35', 'titulo do component', NULL, NULL, '2011-04-22 18:39:35', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 38ms (View: 0, DB: 263) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:39:35', 'C√≥digo', NULL, NULL, '2011-04-22 18:39:35', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 106ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:39:34", updated_at: "2011-04-22 18:39:34", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:39:34", updated_at: "2011-04-22 18:39:34", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:39:34", updated_at: "2011-04-22 18:39:34", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:39:35', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:39:35', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:39:35) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:39:34", updated_at: "2011-04-22 18:39:34", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:39:35', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 17ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:41:26) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:41:26', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:41:27', 'titulo do component', NULL, NULL, '2011-04-22 18:41:27', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 283ms (View: 0, DB: 296) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:41:27) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:41:27', 'C√≥digo', NULL, NULL, '2011-04-22 18:41:27', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 104ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:41:27) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:41:26", updated_at: "2011-04-22 18:41:26", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:41:27) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:41:26", updated_at: "2011-04-22 18:41:26", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 5, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:41:27) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 2, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:41:27) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:41:26", updated_at: "2011-04-22 18:41:26", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:41:27', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:41:27', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:41:27) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:41:26", updated_at: "2011-04-22 18:41:26", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.5ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:41:27', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:43:58', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:43:58', 'titulo do component', NULL, NULL, '2011-04-22 18:43:58', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 37ms (View: 0, DB: 276) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (57.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:43:58', 'C√≥digo', NULL, NULL, '2011-04-22 18:43:58', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 102ms (View: 0, DB: 61) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.1ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:43:58", updated_at: "2011-04-22 18:43:58", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:43:58", updated_at: "2011-04-22 18:43:58", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:43:58", updated_at: "2011-04-22 18:43:58", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:43:58', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:43:58', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:43:58) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:43:58", updated_at: "2011-04-22 18:43:58", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.5ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:43:58', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (1.0ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:49:57', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:49:57', 'titulo do component', NULL, NULL, '2011-04-22 18:49:57', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 37ms (View: 0, DB: 274) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:49:57', 'C√≥digo', NULL, NULL, '2011-04-22 18:49:57', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 104ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:49:56", updated_at: "2011-04-22 18:49:56", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:49:56", updated_at: "2011-04-22 18:49:56", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 3, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:49:56", updated_at: "2011-04-22 18:49:56", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:49:57', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:49:57', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.3ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:49:57) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:49:56", updated_at: "2011-04-22 18:49:56", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.5ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:49:57', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 8) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.7ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:54:34', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:54:34', 'titulo do component', NULL, NULL, '2011-04-22 18:54:34', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 53ms (View: 0, DB: 361) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:54:34', 'C√≥digo', NULL, NULL, '2011-04-22 18:54:34', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 126ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:54:33", updated_at: "2011-04-22 18:54:33", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.6ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:54:33", updated_at: "2011-04-22 18:54:33", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 13ms (View: 7, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:54:33", updated_at: "2011-04-22 18:54:33", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:54:34', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:54:34', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 21ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:54:34) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:54:33", updated_at: "2011-04-22 18:54:33", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:54:34', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 19ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:56:05', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:56:05', 'titulo do component', NULL, NULL, '2011-04-22 18:56:05', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 300) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:56:05', 'C√≥digo', NULL, NULL, '2011-04-22 18:56:05', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 103ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.1ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:56:04", updated_at: "2011-04-22 18:56:04", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:56:04", updated_at: "2011-04-22 18:56:04", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 3, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.1ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:56:04", updated_at: "2011-04-22 18:56:04", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:56:05', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:56:05', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.3ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:56:05) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:56:04", updated_at: "2011-04-22 18:56:04", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:56:05', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:58:38', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:58:38', 'titulo do component', NULL, NULL, '2011-04-22 18:58:38', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 327) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:58:38', 'C√≥digo', NULL, NULL, '2011-04-22 18:58:38', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 105ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:58:38", updated_at: "2011-04-22 18:58:38", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:58:38", updated_at: "2011-04-22 18:58:38", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:58:38", updated_at: "2011-04-22 18:58:38", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:58:38', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:58:38', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:58:38) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:58:38", updated_at: "2011-04-22 18:58:38", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:58:38', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (2.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:15', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:15', 'titulo do component', NULL, NULL, '2011-04-22 18:59:15', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 42ms (View: 0, DB: 275) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:15', 'C√≥digo', NULL, NULL, '2011-04-22 18:59:15', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 103ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:15", updated_at: "2011-04-22 18:59:15", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:15", updated_at: "2011-04-22 18:59:15", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 10ms (View: 5, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:15", updated_at: "2011-04-22 18:59:15", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:15', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:15', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.5ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:15) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:15", updated_at: "2011-04-22 18:59:15", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:15', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.6ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:21', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:21', 'titulo do component', NULL, NULL, '2011-04-22 18:59:21', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 42ms (View: 0, DB: 273) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (2.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:21', 'C√≥digo', NULL, NULL, '2011-04-22 18:59:21', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 105ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:21", updated_at: "2011-04-22 18:59:21", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:21", updated_at: "2011-04-22 18:59:21", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:21", updated_at: "2011-04-22 18:59:21", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:21', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:21', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:21) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:21", updated_at: "2011-04-22 18:59:21", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:21', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:34) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:34', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:34', 'titulo do component', NULL, NULL, '2011-04-22 18:59:34', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 301) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:35) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:35', 'C√≥digo', NULL, NULL, '2011-04-22 18:59:35', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.7ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 113ms (View: 1, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:59:35) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:34", updated_at: "2011-04-22 18:59:34", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:59:35) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:34", updated_at: "2011-04-22 18:59:34", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 11ms (View: 6, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:59:35) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:35) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:34", updated_at: "2011-04-22 18:59:34", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.6ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:35', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:35', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.6ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 24ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:35) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:34", updated_at: "2011-04-22 18:59:34", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:35', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 20ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:46', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:46', 'titulo do component', NULL, NULL, '2011-04-22 18:59:46', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.4ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 37ms (View: 0, DB: 262) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 18:59:46', 'C√≥digo', NULL, NULL, '2011-04-22 18:59:46', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 112ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:46", updated_at: "2011-04-22 18:59:46", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:46", updated_at: "2011-04-22 18:59:46", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 12ms (View: 5, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:46", updated_at: "2011-04-22 18:59:46", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 18:59:46', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:46', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 15:59:46) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 18:59:46", updated_at: "2011-04-22 18:59:46", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 18:59:46', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 18ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.6ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 19:01:51', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 19:01:51', 'titulo do component', NULL, NULL, '2011-04-22 19:01:51', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 253) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 19:01:51', 'C√≥digo', NULL, NULL, '2011-04-22 19:01:51', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 115ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:01:50", updated_at: "2011-04-22 19:01:50", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:01:50", updated_at: "2011-04-22 19:01:50", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 13ms (View: 7, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 4, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:01:50", updated_at: "2011-04-22 19:01:50", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 19:01:51', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.5ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 19:01:51', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 22ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 16:01:51) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:01:50", updated_at: "2011-04-22 19:01:50", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 19:01:51', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 19ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 19:02:14', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 19:02:14', 'titulo do component', NULL, NULL, '2011-04-22 19:02:14', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.8ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 54ms (View: 1, DB: 286) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 19:02:14', 'C√≥digo', NULL, NULL, '2011-04-22 19:02:14', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 118ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:02:13", updated_at: "2011-04-22 19:02:13", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:02:13", updated_at: "2011-04-22 19:02:13", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 11ms (View: 6, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:02:13", updated_at: "2011-04-22 19:02:13", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 19:02:14', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 19:02:14', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.6ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 20ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 16:02:14) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:02:13", updated_at: "2011-04-22 19:02:13", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 19:02:14', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 19ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 16:03:15) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.6ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 19:03:15', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 19:03:15', 'titulo do component', NULL, NULL, '2011-04-22 19:03:15', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 267) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 16:03:15) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.2ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 19:03:15', 'C√≥digo', NULL, NULL, '2011-04-22 19:03:15', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 104ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.1ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 16:03:15) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:03:15", updated_at: "2011-04-22 19:03:15", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 3ms (View: 0, DB: 2) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.1ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 16:03:15) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:03:15", updated_at: "2011-04-22 19:03:15", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 5, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 16:03:16) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 3, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 16:03:16) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:03:15", updated_at: "2011-04-22 19:03:15", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 19:03:16', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 19:03:16', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.3ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 16:03:16) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 19:03:15", updated_at: "2011-04-22 19:03:15", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 19:03:16', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:29:20) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:29:20', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:29:20', 'titulo do component', NULL, NULL, '2011-04-22 20:29:20', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 50ms (View: 1, DB: 230) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (44.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:29:20) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:29:21', 'C√≥digo', NULL, NULL, '2011-04-22 20:29:21', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.9ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.6ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 136ms (View: 1, DB: 49) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:29:21) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:20", updated_at: "2011-04-22 20:29:20", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (2.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (1.0ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:29:21) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:20", updated_at: "2011-04-22 20:29:20", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 10ms (View: 5, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:29:21) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:29:21) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:20", updated_at: "2011-04-22 20:29:20", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.6ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:29:21', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:29:21', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 21ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:29:21) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:20", updated_at: "2011-04-22 20:29:20", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:29:21', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 20ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:29:27', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:29:27', 'titulo do component', NULL, NULL, '2011-04-22 20:29:27', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 40ms (View: 0, DB: 268) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:29:27', 'C√≥digo', NULL, NULL, '2011-04-22 20:29:27', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 109ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:26", updated_at: "2011-04-22 20:29:26", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:26", updated_at: "2011-04-22 20:29:26", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 10ms (View: 5, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 2, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:26", updated_at: "2011-04-22 20:29:26", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:29:27', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:29:27', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 17ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.8ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:29:27) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:29:26", updated_at: "2011-04-22 20:29:26", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:29:27', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 18ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.4ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:30:33', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:30:33', 'titulo do component', NULL, NULL, '2011-04-22 20:30:33', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 37ms (View: 0, DB: 304) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.5ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:30:33', 'C√≥digo', NULL, NULL, '2011-04-22 20:30:33', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 106ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:30:32", updated_at: "2011-04-22 20:30:32", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:30:32", updated_at: "2011-04-22 20:30:32", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 5, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 2, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:30:32", updated_at: "2011-04-22 20:30:32", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:30:33', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:30:33', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 16ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:30:33) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:30:32", updated_at: "2011-04-22 20:30:32", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:30:33', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mComponent Load (0.7ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 8) [0m
  [4;36;1mPicture Load (0.1ms)[0m   [0;1mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;35;1mComponentGallery Columns (1.4ms)[0m   [0mSHOW FIELDS FROM `components`[0m


Processing Company::PicturesController#update (for 0.0.0.0 at 2011-04-22 17:34:09) [GET]
  Parameters: {"id"=>#<Picture id: 1, component_id: 8, title: "MyString", description: "MyText", created_at: "2011-04-22 20:34:09", updated_at: "2011-04-22 20:34:09", photo_file_size: nil, photo_content_type: nil, photo_file_name: nil, component_type: "Component">, "component_id"=>#<ComponentGallery id: 8, layout_id: 1, type: "ComponentGallery", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:34:09", updated_at: "2011-04-22 20:34:09", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>, "picture"=>{"description"=>"sou a nova descri√ß√£o"}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.9ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 8 AND (`components`.layout_id = 1)) [0m
  [4;35;1mPicture Load (0.4ms)[0m   [0mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1 AND (`pictures`.component_id = 8 AND `pictures`.component_type = 'Component')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment photo on Picture initialized.
  [4;35;1mPicture Update (0.4ms)[0m   [0mUPDATE `pictures` SET `updated_at` = '2011-04-22 20:34:09', `description` = 'sou a nova descri√ß√£o' WHERE `id` = 1[0m
[paperclip] Saving attachments.
[paperclip] Saving files for photo
[paperclip] Deleting files for photo
[paperclip] Writing files for photo
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 25ms (View: 1, DB: 308) | 200 OK [http://test.host/company/componentes/8/images/1?picture%5Bdescription%5D=sou+a+nova+descri%C3%A7%C3%A3o]
  [4;35;1mPicture Load (0.5ms)[0m   [0mSELECT * FROM `pictures` WHERE (`pictures`.`id` = 1) [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:41:10', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:41:10', 'titulo do component', NULL, NULL, '2011-04-22 20:41:10', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 37ms (View: 0, DB: 320) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.6ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:41:10', 'C√≥digo', NULL, NULL, '2011-04-22 20:41:10', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 104ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:41:09", updated_at: "2011-04-22 20:41:09", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:41:09", updated_at: "2011-04-22 20:41:09", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:41:09", updated_at: "2011-04-22 20:41:09", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:41:10', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:41:10', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:41:10) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:41:09", updated_at: "2011-04-22 20:41:09", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.4ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:41:10', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:43:20', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:43:20', 'titulo do component', NULL, NULL, '2011-04-22 20:43:20', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 44ms (View: 1, DB: 319) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:43:20', 'C√≥digo', NULL, NULL, '2011-04-22 20:43:20', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 132ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:19", updated_at: "2011-04-22 20:43:19", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:19", updated_at: "2011-04-22 20:43:19", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.8ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.6ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 18ms (View: 8, DB: 4) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:19", updated_at: "2011-04-22 20:43:19", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:43:20', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:43:20', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 26ms (View: 1, DB: 5) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:43:20) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:19", updated_at: "2011-04-22 20:43:19", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (1.1ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:43:20', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 18ms (View: 0, DB: 8) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:43:27', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:43:27', 'titulo do component', NULL, NULL, '2011-04-22 20:43:27', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 36ms (View: 0, DB: 329) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.3ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:43:27', 'C√≥digo', NULL, NULL, '2011-04-22 20:43:27', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 103ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:27", updated_at: "2011-04-22 20:43:27", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:27", updated_at: "2011-04-22 20:43:27", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 5ms (View: 3, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:27", updated_at: "2011-04-22 20:43:27", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:43:27', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.3ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:43:27', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:43:27) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:43:27", updated_at: "2011-04-22 20:43:27", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.6ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.2ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:43:27', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 15ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.4ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:44:26', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:44:26', 'titulo do component', NULL, NULL, '2011-04-22 20:44:26', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.6ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 39ms (View: 0, DB: 304) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:44:26', 'C√≥digo', NULL, NULL, '2011-04-22 20:44:26', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 109ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:25", updated_at: "2011-04-22 20:44:25", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 4ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:25", updated_at: "2011-04-22 20:44:25", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.2ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 3, DB: 1) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:25", updated_at: "2011-04-22 20:44:25", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.5ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:44:26', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:44:26', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 21ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:44:26) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:25", updated_at: "2011-04-22 20:44:25", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:44:26', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.4ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 14ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.8ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.4ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (2.0ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (1.0ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (5.1ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (1.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.6ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:44:33', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:44:33', 'titulo do component', NULL, NULL, '2011-04-22 20:44:33', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.6ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 68ms (View: 1, DB: 329) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.7ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.5ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:44:33', 'C√≥digo', NULL, NULL, '2011-04-22 20:44:33', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.8ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 138ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:32", updated_at: "2011-04-22 20:44:32", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 6ms (View: 0, DB: 3) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:32", updated_at: "2011-04-22 20:44:32", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 13ms (View: 7, DB: 3) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 8ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:32", updated_at: "2011-04-22 20:44:32", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:44:33', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:44:33', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 21ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (1.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.3ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:44:33) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:44:32", updated_at: "2011-04-22 20:44:32", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:44:33', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.5ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 18ms (View: 0, DB: 7) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (1.7ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "tipo"=>"texto"}
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponentText Columns (3.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (1.0ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.6ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:45:49', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:45:49', 'titulo do component', NULL, NULL, '2011-04-22 20:45:49', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, 'descri√ß√£o do conteudo', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.5ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 55ms (View: 1, DB: 326) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m


Processing Company::ComponentsController#create (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"component"=>{"title"=>"C√≥digo", "description"=>"<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n    $(&#39;#foo&#39;).addClass(className);\n  }\n  else {\n    $(&#39;#foo&#39;).removeClass(className);\n  }\n  </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n  if ($(this).parent().is(&#39;.bar&#39;)) {\n    return &#39;happy&#39;;\n  } else {\n    return &#39;sad&#39;;\n  }\n});</pre>"}, "tipo"=>"texto"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;36;1mComponentText Create (0.4ms)[0m   [0;1mINSERT INTO `components` (`created_at`, `title`, `font_colors`, `picture_content_type`, `updated_at`, `show_phone`, `show_all_content`, `url`, `show_name`, `type`, `picture_file_name`, `show_email`, `picture_file_size`, `show_message`, `description`, `layout_id`, `show_address`) VALUES('2011-04-22 20:45:49', 'C√≥digo', NULL, NULL, '2011-04-22 20:45:49', 1, 0, NULL, 1, 'ComponentText', NULL, 1, NULL, 1, '<p>Applying <code>.toggleClass(&#39;bounce spin&#39;)</code> to the same <code>&lt;div&gt;</code> alternates between <code>&lt;div class=&quot;tumble bounce spin&quot;&gt;</code> and <code>&lt;div class=&quot;tumble&quot;&gt;</code>.</p>\n<p>The second version of <code>.toggleClass()</code> uses the second parameter for determining whether the class should be added or removed. If this parameter&#39;s value is <code>true</code>, then the class is added; if <code>false</code>, the class is removed. In essence, the statement:</p>\n<pre>\n$(&#39;#foo&#39;).toggleClass(className, addOrRemove);</pre>\n<p>is equivalent to:</p>\n<pre>\nif (addOrRemove) {\n $(&#39;#foo&#39;).addClass(className);\n }\n else {\n $(&#39;#foo&#39;).removeClass(className);\n }\n </pre>\n<p>As of jQuery 1.4, the <code>.toggleClass()</code> method allows us to indicate the class name to be toggled by passing in a function.</p>\n<pre>\n$(&#39;div.foo&#39;).toggleClass(function() {\n if ($(this).parent().is(&#39;.bar&#39;)) {\n return &#39;happy&#39;;\n } else {\n return &#39;sad&#39;;\n }\n});</pre>', 2, 1)[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.6ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 137ms (View: 0, DB: 5) | 200 OK [http://test.host/company/componentes?component%5Bdescription%5D=%3Cp%3EApplying+%3Ccode%3E.toggleClass%28%26%2339%3Bbounce+spin%26%2339%3B%29%3C%2Fcode%3E+to+the+same+%3Ccode%3E%26lt%3Bdiv%26gt%3B%3C%2Fcode%3E+alternates+between+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble+bounce+spin%26quot%3B%26gt%3B%3C%2Fcode%3E+and+%3Ccode%3E%26lt%3Bdiv+class%3D%26quot%3Btumble%26quot%3B%26gt%3B%3C%2Fcode%3E.%3C%2Fp%3E%0A%3Cp%3EThe+second+version+of+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+uses+the+second+parameter+for+determining+whether+the+class+should+be+added+or+removed.+If+this+parameter%26%2339%3Bs+value+is+%3Ccode%3Etrue%3C%2Fcode%3E%2C+then+the+class+is+added%3B+if+%3Ccode%3Efalse%3C%2Fcode%3E%2C+the+class+is+removed.+In+essence%2C+the+statement%3A%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3B%23foo%26%2339%3B%29.toggleClass%28className%2C+addOrRemove%29%3B%3C%2Fpre%3E%0A%3Cp%3Eis+equivalent+to%3A%3C%2Fp%3E%0A%3Cpre%3E%0Aif+%28addOrRemove%29+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.addClass%28className%29%3B%0A++%7D%0A++else+%7B%0A++++%24%28%26%2339%3B%23foo%26%2339%3B%29.removeClass%28className%29%3B%0A++%7D%0A++%3C%2Fpre%3E%0A%3Cp%3EAs+of+jQuery+1.4%2C+the+%3Ccode%3E.toggleClass%28%29%3C%2Fcode%3E+method+allows+us+to+indicate+the+class+name+to+be+toggled+by+passing+in+a+function.%3C%2Fp%3E%0A%3Cpre%3E%0A%24%28%26%2339%3Bdiv.foo%26%2339%3B%29.toggleClass%28function%28%29+%7B%0A++if+%28%24%28this%29.parent%28%29.is%28%26%2339%3B.bar%26%2339%3B%29%29+%7B%0A++++return+%26%2339%3Bhappy%26%2339%3B%3B%0A++%7D+else+%7B%0A++++return+%26%2339%3Bsad%26%2339%3B%3B%0A++%7D%0A%7D%29%3B%3C%2Fpre%3E&component%5Btitle%5D=C%C3%B3digo&tipo=texto]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `components` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#destroy (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:45:48", updated_at: "2011-04-22 20:45:48", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 7ms (View: 0, DB: 4) | 200 OK [http://test.host/company/componentes/1]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#edit (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:45:48", updated_at: "2011-04-22 20:45:48", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;36;1mUser Load (1.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (2.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
Rendering /company/components/edit_component_text
  [4;36;1mTemplateText Load (0.4ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 21ms (View: 7, DB: 5) | 200 OK [http://test.host/company/componentes/1/edit]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::ComponentsController#new (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"tipo"=>"texto"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
Rendering /company/components/new_component_text
  [4;36;1mTemplateText Load (0.3ms)[0m   [0;1mSELECT id,title FROM `template_texts` [0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 9ms (View: 4, DB: 2) | 200 OK [http://test.host/company/componentes/new?tipo=texto]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (1.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"component"=>{"title"=>"titulo do component", "description"=>"descri√ß√£o do conteudo"}, "id"=>#<ComponentText id: 1, layout_id: 2, type: "ComponentText", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:45:48", updated_at: "2011-04-22 20:45:48", description: "MyString", url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: true, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (2.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (1.6ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1 AND (`components`.layout_id = 2)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 2) [0m
  [4;35;1mLayout Update (0.3ms)[0m   [0mUPDATE `layouts` SET `updated_at` = '2011-04-22 20:45:49', `font_colors` = '0xdescri' WHERE `id` = 2[0m
[paperclip] Saving attachments.
[paperclip] Paperclip attachment card3 on Layout initialized.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Paperclip attachment my_background_top on Layout initialized.
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Paperclip attachment card1 on Layout initialized.
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Paperclip attachment card2 on Layout initialized.
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
[paperclip] Saving attachments.
[paperclip] Saving files for card3
[paperclip] Deleting files for card3
[paperclip] Writing files for card3
[paperclip] Saving files for my_background_top
[paperclip] Deleting files for my_background_top
[paperclip] Writing files for my_background_top
[paperclip] Saving files for card1
[paperclip] Deleting files for card1
[paperclip] Writing files for card1
[paperclip] Saving files for card2
[paperclip] Deleting files for card2
[paperclip] Writing files for card2
  [4;36;1mComponentText Update (0.4ms)[0m   [0;1mUPDATE `components` SET `updated_at` = '2011-04-22 20:45:49', `title` = 'titulo do component', `description` = 'descri√ß√£o do conteudo' WHERE `id` = 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Load (0.4ms)[0m   [0;1mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 7) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Cache write: empres√£ _&valid_2_content
Cache write: empres√£ _&valid_2_layout
######### clean cache #########
Completed in 27ms (View: 0, DB: 8) | 200 OK [http://test.host/company/componentes/1?component%5Bdescription%5D=descri%C3%A7%C3%A3o+do+conteudo&component%5Btitle%5D=titulo+do+component]
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mComponent Load (0.2ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` = 9) [0m
  [4;36;1mComponentForm Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m


Processing Company::ComponentsController#update (for 0.0.0.0 at 2011-04-22 17:45:49) [GET]
  Parameters: {"component"=>{"title"=>"Entre em contato conosco", "show_phone"=>"true", "url"=>"null", "show_name"=>"true", "show_email"=>"true", "show_message"=>"false", "description"=>"null", "show_address"=>"false"}, "id"=>#<ComponentForm id: 9, layout_id: 1, type: "ComponentForm", title: "MyString", picture_file_name: nil, picture_content_type: nil, picture_file_size: nil, created_at: "2011-04-22 20:45:48", updated_at: "2011-04-22 20:45:48", description: nil, url: nil, font_colors: nil, show_name: true, show_email: true, show_phone: false, show_address: true, show_message: true, show_all_content: false>}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mComponent Load (0.5ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 9 AND (`components`.layout_id = 1)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.`id` = 1) [0m
  [4;35;1mComponentForm Update (0.3ms)[0m   [0mUPDATE `components` SET `updated_at` = '2011-04-22 20:45:49', `show_phone` = 1, `title` = 'Entre em contato conosco', `show_address` = 0, `show_message` = 0, `description` = 'null', `url` = 'null' WHERE `id` = 9[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 5) [0m
  [4;35;1mFeedItem Load (0.6ms)[0m   [0mSELECT `feed_items`.id FROM `feed_items` INNER JOIN `feeds` ON `feed_items`.id = `feeds`.feed_item_id WHERE (item_type='Component' and is_public=true and feed_items.updated_at>'2011-04-22 00:00:00') AND ((`feeds`.company_id = 5) AND ((`feed_items`.`is_public` = 1))) ORDER BY feed_items.updated_at desc LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Cache write: empresa_valid_content
Cache write: empresa_valid_layout
######### clean cache #########
Completed in 20ms (View: 0, DB: 6) | 200 OK [http://test.host/company/componentes/9?component%5Bdescription%5D=null&component%5Bshow_address%5D=false&component%5Bshow_email%5D=true&component%5Bshow_message%5D=false&component%5Bshow_name%5D=true&component%5Bshow_phone%5D=true&component%5Btitle%5D=Entre+em+contato+conosco&component%5Burl%5D=null]
  [4;35;1mSQL (1.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m


Processing Company::ConstructionController#content (for 0.0.0.0 at 2011-04-22 17:47:46) [GET]
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mCompanyZ Columns (2.4ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mLayout Load (0.9ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering /company/construction/content.json
  [4;35;1mTab Load (0.5ms)[0m   [0mSELECT * FROM `tabs` WHERE (`tabs`.layout_id = 2) ORDER BY tabs.order[0m
  [4;36;1mTabComponent Load (0.4ms)[0m   [0;1mSELECT `tab_components`.* FROM `tab_components` WHERE (`tab_components`.tab_id IN (3,4)) ORDER BY tab_components.line, tab_components.column[0m
  [4;35;1mComponent Load (0.5ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;36;1mComponentText Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mComponentPicture Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mComponentForm Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mTabComponent Load (1.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 1)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.7ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 1) [0m
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 2)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 3) [0m
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3 AND (`tab_components`.`line` = 3)) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.4ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` = 4) [0m
  [4;35;1mComponent Load (0.4ms)[0m   [0mSELECT * FROM `components` WHERE (`components`.layout_id = 2 AND (not exists (select * from tab_components as tab_components where tab_components.component_id = components.id))) [0m
Completed in 191ms (View: 0, DB: 0) | 200 OK [http://test.host/company/construction/content]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `messages` [0m


Processing MessagesController#create (for 0.0.0.0 at 2011-04-22 17:50:05) [POST]
  Parameters: {"message"=>{"sender_email"=>"tester@gmail.com", "body"=>"Corpo da mensagem", "subject"=>"Teste - Mensagem enviada do business card", "to"=>"8"}}
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUserCompany Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mFolder Load (0.3ms)[0m   [0mSELECT * FROM `folders` WHERE (`folders`.`name` = 'Inbox') AND (`folders`.user_id = 8) LIMIT 1[0m
  [4;36;1mMessage Create (0.4ms)[0m   [0;1mINSERT INTO `messages` (`sender_email`, `created_at`, `receiver_email`, `deleted_sent_box`, `receiver_id`, `body`, `first_answer`, `updated_at`, `subject`, `sender_id`, `answer_id`, `sender_name`) VALUES('tester@gmail.com', '2011-04-22 20:50:05', NULL, NULL, NULL, 'Corpo da mensagem', NULL, '2011-04-22 20:50:05', 'Teste - Mensagem enviada do business card', NULL, NULL, NULL)[0m
  [4;35;1mMessageCopy Load (0.3ms)[0m   [0mSELECT * FROM `message_copies` WHERE (`message_copies`.message_id = NULL) [0m
  [4;36;1mMessage Load (0.3ms)[0m   [0;1mSELECT * FROM `messages` WHERE (`messages`.`id` = 16) [0m
  [4;35;1mMessageCopy Create (0.2ms)[0m   [0mINSERT INTO `message_copies` (`created_at`, `folder_id`, `updated_at`, `read`, `recipient_id`, `deleted`, `answer_id`, `message_id`) VALUES(NULL, 980190962, '2011-04-22 20:50:05', NULL, 8, NULL, NULL, 16)[0m
  [4;36;1mDelayed::Backend::ActiveRecord::Job Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `delayed_jobs`[0m
  [4;35;1mDelayed::Backend::ActiveRecord::Job Create (0.3ms)[0m   [0mINSERT INTO `delayed_jobs` (`failed_at`, `locked_by`, `created_at`, `handler`, `updated_at`, `priority`, `run_at`, `attempts`, `locked_at`, `last_error`) VALUES(NULL, NULL, '2011-04-22 20:50:05', '--- !ruby/struct:Delayed::PerformableMethod \nobject: LOAD;MessageMailer\nmethod: :deliver_received\nargs: \n- LOAD;MessageCopy;15\n', '2011-04-22 20:50:05', 0, '2011-04-22 20:50:05', 0, NULL, NULL)[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mFeedItem Create (0.5ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-04-22 20:50:05', 0, '2011-04-22 20:50:05', 0, 0, 16, 'Message')[0m
  [4;36;1mFeed Create (0.4ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-04-22 20:50:05', '2011-04-22 20:50:05', 5, 42)[0m
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 131ms (View: 0, DB: 325) | 200 OK [http://test.host/mensagens?message%5Bbody%5D=Corpo+da+mensagem&message%5Bsender_email%5D=tester%40gmail.com&message%5Bsubject%5D=Teste+-+Mensagem+enviada+do+business+card&message%5Bto%5D=8]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `messages` [0m
  [4;35;1mSQL (1.0ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 18:03:42) [GET]
  Parameters: {"id"=>"empres√£ _&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;35;1mCompanyZ Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `companies`[0m
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
  [4;35;1mCompanyZ Load Including Associations (0.8ms)[0m   [0mSELECT `companies`.`id` AS t0_r0, `companies`.`user_id` AS t0_r1, `companies`.`cnpj` AS t0_r2, `companies`.`razao_social` AS t0_r3, `companies`.`created_at` AS t0_r4, `companies`.`updated_at` AS t0_r5, `companies`.`person_id` AS t0_r6, `companies`.`payment_type` AS t0_r7, `companies`.`segment_id` AS t0_r8, `companies`.`state_id` AS t0_r9, `companies`.`type` AS t0_r10, `companies`.`informal` AS t0_r11, `companies`.`drawee_code` AS t0_r12, `companies`.`register_number` AS t0_r13, `companies`.`profile_logo_file_name` AS t0_r14, `companies`.`profile_logo_content_type` AS t0_r15, `companies`.`profile_logo_file_size` AS t0_r16, `companies`.`profile_logo_updated_at` AS t0_r17, `layouts`.`id` AS t1_r0, `layouts`.`company_id` AS t1_r1, `layouts`.`architecture_type` AS t1_r2, `layouts`.`name` AS t1_r3, `layouts`.`slogan` AS t1_r4, `layouts`.`website` AS t1_r5, `layouts`.`presentation_text` AS t1_r6, `layouts`.`background_file_name` AS t1_r7, `layouts`.`created_at` AS t1_r8, `layouts`.`updated_at` AS t1_r9, `layouts`.`card1_file_name` AS t1_r10, `layouts`.`card1_content_type` AS t1_r11, `layouts`.`card1_file_size` AS t1_r12, `layouts`.`card2_file_name` AS t1_r13, `layouts`.`card2_content_type` AS t1_r14, `layouts`.`card2_file_size` AS t1_r15, `layouts`.`card3_file_name` AS t1_r16, `layouts`.`card3_content_type` AS t1_r17, `layouts`.`card3_file_size` AS t1_r18, `layouts`.`component_decoration` AS t1_r19, `layouts`.`show_name` AS t1_r20, `layouts`.`show_slogan` AS t1_r21, `layouts`.`show_logo` AS t1_r22, `layouts`.`background_top` AS t1_r23, `layouts`.`send_to_friend` AS t1_r24, `layouts`.`side_image_url` AS t1_r25, `layouts`.`font_colors` AS t1_r26, `layouts`.`email` AS t1_r27, `layouts`.`facebook` AS t1_r28, `layouts`.`orkut` AS t1_r29, `layouts`.`twitter` AS t1_r30, `layouts`.`flickr` AS t1_r31, `layouts`.`repeat_background_x` AS t1_r32, `layouts`.`repeat_background_y` AS t1_r33, `layouts`.`centralize_background` AS t1_r34, `layouts`.`meta_description` AS t1_r35, `layouts`.`meta_keywords` AS t1_r36, `layouts`.`analytics` AS t1_r37, `colors`.`id` AS t2_r0, `colors`.`name` AS t2_r1, `colors`.`slogan` AS t2_r2, `colors`.`title` AS t2_r3, `colors`.`subtitle` AS t2_r4, `colors`.`checked_menu` AS t2_r5, `colors`.`unchecked_menu` AS t2_r6, `colors`.`background_menu` AS t2_r7, `colors`.`tool_botton` AS t2_r8, `colors`.`text` AS t2_r9, `colors`.`tool_body` AS t2_r10, `colors`.`background` AS t2_r11, `colors`.`body` AS t2_r12, `colors`.`created_at` AS t2_r13, `colors`.`updated_at` AS t2_r14, `colors`.`layout_id` AS t2_r15, `colors`.`menu_deselected_text` AS t2_r16, `colors`.`menu_deselected_background` AS t2_r17, `colors`.`menu_selected_text` AS t2_r18, `colors`.`menu_selected_background` AS t2_r19, `colors`.`menu_hover_text` AS t2_r20, `colors`.`menu_hover_background` AS t2_r21, `colors`.`title_text` AS t2_r22, `colors`.`title_background` AS t2_r23, `colors`.`subtitle_text` AS t2_r24, `colors`.`subtitle_background` AS t2_r25, `colors`.`text_background` AS t2_r26, `colors`.`link_text` AS t2_r27, `colors`.`link_background` AS t2_r28, `colors`.`body_sidebar` AS t2_r29, `colors`.`border` AS t2_r30, `colors`.`name_company_text` AS t2_r31, `colors`.`slogan_company_text` AS t2_r32, `colors`.`footer_background` AS t2_r33, `colors`.`footer_text` AS t2_r34, `colors`.`sidebar_text` AS t2_r35, `users`.`id` AS t3_r0, `users`.`login` AS t3_r1, `users`.`email` AS t3_r2, `users`.`crypted_password` AS t3_r3, `users`.`salt` AS t3_r4, `users`.`created_at` AS t3_r5, `users`.`updated_at` AS t3_r6, `users`.`remember_token` AS t3_r7, `users`.`remember_token_expires_at` AS t3_r8, `users`.`activation_code` AS t3_r9, `users`.`activated_at` AS t3_r10, `users`.`password_reset_code` AS t3_r11, `users`.`enabled` AS t3_r12, `users`.`type` AS t3_r13, `users`.`self_created` AS t3_r14, `users`.`avatar_file_name` AS t3_r15, `users`.`avatar_content_type` AS t3_r16, `users`.`avatar_file_size` AS t3_r17, `users`.`avatar_updated_at` AS t3_r18, `users`.`domain` AS t3_r19 FROM `companies` LEFT OUTER JOIN `layouts` ON layouts.company_id = companies.id LEFT OUTER JOIN `colors` ON colors.layout_id = layouts.id LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='empres√£ _&valid_2') AND ( (`companies`.`type` = 'CompanyZ' ) ) AND `companies`.id IN (7) [0m
Cache write: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;35;1mTab Load IDs For Limited Eager Loading (0.6ms)[0m   [0mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
  [4;36;1mTab Load Including Associations (0.5ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) AND `tabs`.id IN (3) ORDER BY tabs.order[0m
  [4;35;1mComponentText Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `components`[0m
  [4;36;1mComponentPicture Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `components`[0m
  [4;35;1mComponentForm Columns (2.4ms)[0m   [0mSHOW FIELDS FROM `components`[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (5.7ms)
  [4;36;1mTab Load Including Associations (0.8ms)[0m   [0;1mSELECT `tabs`.`id` AS t0_r0, `tabs`.`layout_id` AS t0_r1, `tabs`.`title` AS t0_r2, `tabs`.`created_at` AS t0_r3, `tabs`.`updated_at` AS t0_r4, `tabs`.`order` AS t0_r5, `components`.`id` AS t1_r0, `components`.`layout_id` AS t1_r1, `components`.`type` AS t1_r2, `components`.`title` AS t1_r3, `components`.`picture_file_name` AS t1_r4, `components`.`picture_content_type` AS t1_r5, `components`.`picture_file_size` AS t1_r6, `components`.`created_at` AS t1_r7, `components`.`updated_at` AS t1_r8, `components`.`description` AS t1_r9, `components`.`url` AS t1_r10, `components`.`font_colors` AS t1_r11, `components`.`show_name` AS t1_r12, `components`.`show_email` AS t1_r13, `components`.`show_phone` AS t1_r14, `components`.`show_address` AS t1_r15, `components`.`show_message` AS t1_r16, `components`.`show_all_content` AS t1_r17 FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order[0m
Rendered z/_social (0.6ms)
  [4;35;1mTabComponent Load (0.5ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.3ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (1.0ms)
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.6ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (1.7ms)
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (5.3ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mAddress Load (0.4ms)[0m   [0;1mSELECT * FROM `addresses` WHERE (`addresses`.owner_id = 2 AND `addresses`.owner_type = 'Layout') LIMIT 1[0m
  [4;35;1mPhone Load (0.4ms)[0m   [0mSELECT * FROM `phones` WHERE (`phones`.owner_id = 2 AND `phones`.owner_type = 'Layout') [0m
Rendered z/_address (6.4ms)
Rendered z/_sidebar_address (0.9ms)
  [4;36;1mBanner Load (0.3ms)[0m   [0;1mSELECT * FROM `banners` WHERE (`banners`.layout_id = 2) [0m
Completed in 192ms (View: 146, DB: 323) | 200 OK [http://test.host/z/empres%C3%A3%20_&valid_2]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 18:03:42) [GET]
  Parameters: {"id"=>"empres%C3%A3%20_&valid_2"}
Cache read: empres√£ _&valid_2_layout
  [4;36;1mTab Load IDs For Limited Eager Loading (0.3ms)[0m   [0;1mSELECT DISTINCT `tabs`.id FROM `tabs` LEFT OUTER JOIN `tab_components` ON (`tabs`.`id` = `tab_components`.`tab_id`) LEFT OUTER JOIN `components` ON (`components`.`id` = `tab_components`.`component_id`) WHERE (`tabs`.`id` IS NULL) AND (`tabs`.layout_id = 2 AND (components.id is not null)) ORDER BY tabs.order LIMIT 1[0m
Rendering template within layouts/z/template1
Rendering z/index
Rendered z/_style (0.5ms)
Rendered z/_social (0.1ms)
  [4;35;1mTabComponent Load (0.4ms)[0m   [0mSELECT * FROM `tab_components` WHERE (`tab_components`.tab_id = 3) ORDER BY tab_components.line, tab_components.column[0m
  [4;36;1mComponent Load (0.2ms)[0m   [0;1mSELECT * FROM `components` WHERE (`components`.`id` IN (1,3,4)) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_text (0.4ms)
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 1) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
[paperclip] Paperclip attachment picture on ComponentPicture initialized.
Rendered z/_component_picture (0.9ms)
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 2) AND (`tab_components`.tab_id = 3) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_component_form (2.5ms)
  [4;35;1mSQL (0.5ms)[0m   [0mSELECT count(DISTINCT `tab_components`.id) AS count_all FROM `tab_components` LEFT OUTER JOIN `components` ON `components`.id = `tab_components`.component_id WHERE (`tab_components`.`line` = 3) AND (`tab_components`.tab_id = 3) [0m
Rendered z/_address (0.8ms)
Rendered z/_sidebar_address (0.1ms)
Completed in 26ms (View: 20, DB: 5) | 200 OK [http://test.host/z/empres%25C3%25A3%2520_&valid_2]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m


Processing ZController#index (for 0.0.0.0 at 2011-04-22 18:03:42) [GET]
  Parameters: {"id"=>"asiuhiasuhaiuhsiauhsiauhsiuhai"}
Cache read: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
  [4;36;1mCompanyZ Load IDs For Limited Eager Loading (0.5ms)[0m   [0;1mSELECT DISTINCT `companies`.id FROM `companies` LEFT OUTER JOIN `users` ON `users`.id = `companies`.user_id WHERE (users.login='asiuhiasuhaiuhsiauhsiauhsiuhai') AND ( (`companies`.`type` = 'CompanyZ' ) ) LIMIT 1[0m
Cache write: asiuhiasuhaiuhsiauhsiauhsiuhai_layout
Redirected to http://test.host/not_found
Filter chain halted as [:find_company] rendered_or_redirected.
Completed in 11ms (DB: 1) | 302 Found [http://test.host/z/asiuhiasuhaiuhsiauhsiauhsiuhai]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.7ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUserCompany Columns (1.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m


Processing DomainsController#update (for 0.0.0.0 at 2011-04-22 18:23:39) [GET]
  Parameters: {"id"=>"8", "value"=>"empresa.com.br"}
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.5ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 21:23:39', `domain` = 'empresa.com.br' WHERE `id` = 8[0m
  [4;36;1mCompanyZ Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 262ms (View: 0, DB: 274) | 200 OK [http://test.host/domains/update/8?value=empresa.com.br]
  [4;36;1mUserCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) [0m
  [4;36;1mUserAdministrator Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mUserCompany Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m


Processing DomainsController#update (for 0.0.0.0 at 2011-04-22 18:29:34) [GET]
  Parameters: {"id"=>"8", "value"=>"empresa.com.br"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 3) LIMIT 1[0m
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`login`) = BINARY 'empresa_valid' AND `users`.id <> 8) LIMIT 1[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT `users`.id FROM `users` WHERE (LOWER(`users`.`email`) = BINARY 'empconfxx@emp.com' AND `users`.id <> 8) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
[paperclip] Paperclip attachment avatar on UserCompany initialized.
  [4;35;1mUserCompany Update (0.5ms)[0m   [0mUPDATE `users` SET `updated_at` = '2011-04-22 21:29:34', `domain` = 'empresa.com.br' WHERE `id` = 8[0m
  [4;36;1mCompanyZ Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
[paperclip] Saving attachments.
[paperclip] Saving files for avatar
[paperclip] Deleting files for avatar
[paperclip] Writing files for avatar
  [4;35;1mSQL (0.8ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 294ms (View: 0, DB: 535) | 200 OK [http://test.host/domains/update/8?value=empresa.com.br]
  [4;36;1mUserCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) AND ( (`users`.`type` = 'UserCompany' ) ) [0m
  [4;35;1mSQL (33.3ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.7ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#buy (for 0.0.0.0 at 2011-05-07 16:44:19) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.6ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.6ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-05-07 16:44:19) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.6ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-05-07 19:44:19', 'test', '2011-05-07 19:44:19', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-05-07 19:44:19', 0, '2011-05-07 19:44:19', 0, 1, 980190963, 'Business')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-05-07 19:44:19', '2011-05-07 19:44:19', 7, 2)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190963
Completed in 120ms (DB: 869) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-05-07 16:44:19) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.4ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 7ms (DB: 4) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.4ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-05-07 16:44:19) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 42ms (View: 37, DB: 5) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-05-07 16:44:19) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 18ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-05-07 16:44:19) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 11, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-05-07 16:44:19) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 9, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-05-07 16:44:19) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mBusiness Load (0.1ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#buy (for 0.0.0.0 at 2011-05-07 16:45:05) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-05-07 16:45:05) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.3ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-05-07 19:45:05', 'test', '2011-05-07 19:45:05', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-05-07 19:45:05', 0, '2011-05-07 19:45:05', 0, 1, 980190964, 'Business')[0m
  [4;36;1mFeed Create (0.4ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-05-07 19:45:05', '2011-05-07 19:45:05', 7, 3)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190964
Completed in 120ms (DB: 308) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;36;1mSQL (0.4ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-05-07 16:45:05) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 7ms (DB: 5) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-05-07 16:45:05) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.2ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 28ms (View: 23, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-05-07 16:45:05) [GET]
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 18ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-05-07 16:45:05) [GET]
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 16ms (View: 12, DB: 2) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-05-07 16:45:05) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 9, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-05-07 16:45:05) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#buy (for 0.0.0.0 at 2011-05-07 16:45:33) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-05-07 16:45:33) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.2ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.2ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.3ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-05-07 19:45:33', 'test', '2011-05-07 19:45:33', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.5ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-05-07 19:45:33', 0, '2011-05-07 19:45:33', 0, 1, 980190965, 'Business')[0m
  [4;36;1mFeed Create (0.4ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-05-07 19:45:33', '2011-05-07 19:45:33', 7, 4)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190965
Completed in 115ms (DB: 289) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-05-07 16:45:33) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.5ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 6ms (DB: 5) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-05-07 16:45:33) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.6ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 28ms (View: 22, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.4ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-05-07 16:45:33) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.5ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 18ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-05-07 16:45:33) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.5ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 11, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-05-07 16:45:33) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.5ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.6ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 9, DB: 4) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-05-07 16:45:33) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.9ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#buy (for 0.0.0.0 at 2011-05-07 16:46:22) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.5ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mBusiness Load (0.5ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.5ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-05-07 16:46:22) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.4ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-05-07 19:46:22', 'test', '2011-05-07 19:46:22', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-05-07 19:46:22', 0, '2011-05-07 19:46:22', 0, 1, 980190966, 'Business')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-05-07 19:46:22', '2011-05-07 19:46:22', 7, 5)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.3ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190966
Completed in 116ms (DB: 283) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-05-07 16:46:22) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 6ms (DB: 4) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-05-07 16:46:22) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 28ms (View: 23, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-05-07 16:46:22) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 17ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-05-07 16:46:22) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.5ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 11, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-05-07 16:46:22) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 10, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-05-07 16:46:22) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 6ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
** vote_fu: setting up load paths
** vote_fu: initialized properly.
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.8ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#buy (for 0.0.0.0 at 2011-05-07 16:48:32) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.8ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mBusinessCompany Create (0.4ms)[0m   [0;1mINSERT INTO `business_companies` (`created_at`, `updated_at`, `business_id`, `company_id`) VALUES('2011-05-07 19:48:32', '2011-05-07 19:48:32', 980190962, 5)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
  [4;36;1mSQL (45.6ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-05-07 16:48:32) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.4ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;36;1mBusiness Create (0.3ms)[0m   [0;1mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-05-07 19:48:32', 'test', '2011-05-07 19:48:32', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;36;1mFeedItem Create (0.3ms)[0m   [0;1mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-05-07 19:48:32', 0, '2011-05-07 19:48:32', 0, 1, 980190967, 'Business')[0m
  [4;35;1mFeed Create (0.2ms)[0m   [0mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-05-07 19:48:32', '2011-05-07 19:48:32', 7, 6)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190967
Completed in 16ms (DB: 49) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-05-07 16:48:32) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;36;1mBusiness Destroy (0.2ms)[0m   [0;1mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;35;1mSQL (0.1ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 6ms (DB: 4) | 302 Found [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (0.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-05-07 16:48:32) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 27ms (View: 22, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-05-07 16:48:32) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 17ms (View: 12, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-05-07 16:48:32) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 16ms (View: 11, DB: 2) | 200 OK [http://test.host/company/businesses/new]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-05-07 16:48:32) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 14ms (View: 9, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-05-07 16:48:32) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.4ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 7ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;36;1mSQL (0.3ms)[0m   [0;1mROLLBACK[0m
** vote_fu: setting up load paths
** vote_fu: initialized properly.
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mUserCompany Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (2.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#buy (for 0.0.0.0 at 2011-05-07 16:49:14) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 8) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 8) LIMIT 1[0m
  [4;36;1mCompanyZ Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `companies`[0m
  [4;35;1mLayout Load (0.7ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 5) LIMIT 1[0m
  [4;36;1mBusiness Load (0.4ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
  [4;36;1mBusinessCompany Create (0.3ms)[0m   [0;1mINSERT INTO `business_companies` (`created_at`, `updated_at`, `business_id`, `company_id`) VALUES('2011-05-07 19:49:14', '2011-05-07 19:49:14', 980190962, 5)[0m
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Completed in 19ms (View: 0, DB: 273) | 200 OK [http://test.host/company/businesses/buy/980190962]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `business_companies` [0m
  [4;35;1mSQL (1.9ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m


Processing Company::BusinessesController#create (for 0.0.0.0 at 2011-05-07 16:49:14) [POST]
  Parameters: {"business"=>{"title"=>"test", "total"=>5}}
  [4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.4ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
  [4;35;1mBusiness Create (0.3ms)[0m   [0mINSERT INTO `businesses` (`created_at`, `title`, `updated_at`, `business_image_file_size`, `total`, `business_image_file_name`, `business_image_updated_at`, `company_id`, `business_image_content_type`) VALUES('2011-05-07 19:49:14', 'test', '2011-05-07 19:49:14', NULL, 5, NULL, NULL, 7, NULL)[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.`id` = 7) [0m
  [4;35;1mFeedItem Create (0.4ms)[0m   [0mINSERT INTO `feed_items` (`created_at`, `include_comments`, `updated_at`, `feed_likes_count`, `is_public`, `item_id`, `item_type`) VALUES('2011-05-07 19:49:14', 0, '2011-05-07 19:49:14', 0, 1, 980190968, 'Business')[0m
  [4;36;1mFeed Create (0.3ms)[0m   [0;1mINSERT INTO `feeds` (`created_at`, `updated_at`, `company_id`, `feed_item_id`) VALUES('2011-05-07 19:49:14', '2011-05-07 19:49:14', 7, 7)[0m
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;35;1mSQL (0.2ms)[0m   [0mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190968
Completed in 18ms (DB: 6) | 302 Found [http://test.host/company/businesses?business%5Btitle%5D=test&business%5Btotal%5D=5]
  [4;36;1mSQL (0.3ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mSQL (1.8ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;35;1mBusiness Load (0.3ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#destroy (for 0.0.0.0 at 2011-05-07 16:49:14) [DELETE]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.6ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.2ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSAVEPOINT active_record_1[0m
[paperclip] Deleting attachments.
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Deleting files for business_image
  [4;35;1mBusiness Destroy (0.3ms)[0m   [0mDELETE FROM `businesses` WHERE `id` = 980190962[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses
Completed in 7ms (DB: 5) | 302 Found [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mSELECT count(*) AS count_all FROM `businesses` [0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;35;1mBusiness Load (0.2ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#edit (for 0.0.0.0 at 2011-05-07 16:49:14) [GET]
  Parameters: {"id"=>"980190962"}
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;35;1mBusiness Load (0.4ms)[0m   [0mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/edit
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;36;1mPerson Load (0.5ms)[0m   [0;1mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;35;1mUser Load (0.4ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 29ms (View: 24, DB: 4) | 200 OK [http://test.host/company/businesses/980190962/edit]
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#index (for 0.0.0.0 at 2011-05-07 16:49:14) [GET]
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.4ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/index
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.company_id = 7) [0m
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 17ms (View: 13, DB: 3) | 200 OK [http://test.host/company/businesses]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m


Processing Company::BusinessesController#new (for 0.0.0.0 at 2011-05-07 16:49:14) [GET]
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;35;1mCompany Load (0.3ms)[0m   [0mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;36;1mLayout Load (0.3ms)[0m   [0;1mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
Rendering template within layouts/company
Rendering company/businesses/new
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.4ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.4ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 16ms (View: 12, DB: 3) | 200 OK [http://test.host/company/businesses/new]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.1ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#show (for 0.0.0.0 at 2011-05-07 16:49:14) [GET]
  Parameters: {"id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.3ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
Rendering template within layouts/company
Rendering company/businesses/show
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Paperclip attachment profile_logo on CompanyZ initialized.
  [4;35;1mPerson Load (0.5ms)[0m   [0mSELECT `people`.* FROM `people` INNER JOIN `user_people` ON `people`.id = `user_people`.person_id WHERE ((`user_people`.user_id = 12)) [0m
  [4;36;1mUser Load (0.3ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
Completed in 15ms (View: 10, DB: 3) | 200 OK [http://test.host/company/businesses/980190962]
  [4;35;1mSQL (0.3ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mUser Load (0.2ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) [0m
  [4;36;1mBusiness Load (0.1ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962) [0m


Processing Company::BusinessesController#update (for 0.0.0.0 at 2011-05-07 16:49:14) [PUT]
  Parameters: {"business"=>{}, "id"=>"980190962"}
  [4;35;1mUser Load (0.3ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`id` = 12) LIMIT 1[0m
  [4;36;1mCompany Load (0.3ms)[0m   [0;1mSELECT * FROM `companies` WHERE (`companies`.user_id = 12) LIMIT 1[0m
  [4;35;1mLayout Load (0.3ms)[0m   [0mSELECT * FROM `layouts` WHERE (`layouts`.company_id = 7) LIMIT 1[0m
  [4;36;1mBusiness Load (0.2ms)[0m   [0;1mSELECT * FROM `businesses` WHERE (`businesses`.`id` = 980190962 AND (`businesses`.company_id = 7)) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSAVEPOINT active_record_1[0m
[paperclip] Paperclip attachment business_image on Business initialized.
[paperclip] Saving attachments.
[paperclip] Saving files for business_image
[paperclip] Deleting files for business_image
[paperclip] Writing files for business_image
  [4;36;1mSQL (0.1ms)[0m   [0;1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/company/businesses/980190962
Completed in 7ms (DB: 2) | 302 Found [http://test.host/company/businesses/980190962?]
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
